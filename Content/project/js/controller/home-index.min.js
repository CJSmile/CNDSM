$(document).ready(function(){function v(n,t){var i=this;i.showLoading=ko.observable(!1);i.showLogin=ko.observable(!0);i.showMobile=ko.observable(!1);i.showMenu=ko.observable(!1);i.showLiveOrder=ko.observable(!1);i.showMenuSetUp=ko.observable(!1);i.showConfigSetUp=ko.observable(!1);i.showMySetting=ko.observable(!1);i.showTemplate=ko.observable(!1);i.showReport=ko.observable(!1);i.showBalance=ko.observable(!1);i.showStatement=ko.observable(!1);i.showGiftCard=ko.observable(!1);i.showGiftCardView=ko.observable(!1);i.showMarketing=ko.observable(!1);i.showDeliveryBilling=ko.observable(!1);i.marketing=new MarketingViewModel;i.disableButtonCloseModal=ko.observable(!1);i.disablePointer=ko.observable("pointer");i.tabSyncProduct=ko.observable(!1);i.autoSyncProduct=ko.observable(!1);i.customer=new CustomerViewModel;i.allRestaurant=new AllRestaurantViewModel;i.globalConfig=new GlobalConfigViewModel(n,t);i.allMapZone=new AllMapViewModel;i.allSetTime=new AllTimeViewModel;i.allSetting=new AllSettingViewModel(n);i.allTemplate=new AllTemplateViewModel;i.giftCard=new GiftCardViewModel(n);i.event=new Event;i.menu=new MenuSetupViewModel;i.liveOrder=new LiveOrderViewModel;i.configSetUp=new ConfigSetUpViewModel;i.contextPath=ko.observable();i.report=new ReportViewModel;i.balance=new BalanceViewModel;i.statement=new StatementViewModel;i.deliveryBilling=new DeliveryBillingViewModel;i.mobile=new Mobile}function b(n,t){t.errorList.length>0&&$(document).find("#"+n.target.id+" .panel-messsage-error").show()}function k(t,i){var s,h,y,p,d,b,g,tt,it,r,ot,k,nt,st,ht,w,v,ct;switch(t){case cfrmLogIn:vmViewIndex.mobile.logInSuccessed(!0);ko.mapping.fromJSON(i.objAllTimeZone,{},vmViewIndex.globalConfig.allTimeZone);i.objAllRestaurant?(ko.mapping.fromJSON(i.objAllRestaurant,{},vmViewIndex.allRestaurant.data),h=vmViewIndex.allRestaurant,h.selectBoxDomainId(h.data()[0].domainId()),h.selectBoxAllRestaurant({dataSource:new DevExpress.data.ArrayStore({data:h.data(),key:"domainId"}),displayExpr:"domainName",valueExpr:"domainId",value:h.selectBoxDomainId(),searchEnabled:!0,showPopupTitle:!1,placeholder:"Select Restaurant",onValueChanged:function(n){var t=ko.utils.arrayFilter(h.data(),function(t){return t.domainId()==n.value}),i=_.first(t);h.selectBoxDomainId(i.domainId());h.selectBoxAllRestaurant().value=n.value}})):(t==cfrmLogIn&&vmViewIndex.showLogin(!1),vmViewIndex.showMenu(!0),vmViewIndex.showLiveOrder(!0),i.showSmileDining==!1&&i.showSmileContactlessDining==!0?c(i.showSmileContactlessDining):u(i.showSmileDining),y=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileDining)),DataSettingViewModel(y),(vmViewIndex.allSetting.isSmileDining()==!0||vmViewIndex.allSetting.isMultiProduct()==!0)&&(DataGlobalConfigViewModel(y),f()),(vmViewIndex.allSetting.isSmileDining()==!1||vmViewIndex.allSetting.isMultiProduct()==!0)&&(p=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileContactless)),d=ko.observableArray([{globalConfigKey:"smileContactless",globalConfigValue:!0,globalConfigDesc:null}]),p.push(d()[0]),DataGlobalConfigViewModel(p),e()),l(i.showEgiftCard),a(i.showDeliveryBilling),o());break;case cfrmChangeRestaurant:y=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileDining));DataSettingViewModel(y);(vmViewIndex.allSetting.isSmileDining()==!0||vmViewIndex.allSetting.isMultiProduct()==!0)&&(DataGlobalConfigViewModel(y),f());(vmViewIndex.allSetting.isSmileDining()==!1||vmViewIndex.allSetting.isMultiProduct()==!0)&&(p=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileContactless)),d=ko.observableArray([{globalConfigKey:"smileContactless",globalConfigValue:!0,globalConfigDesc:null}]),p.push(d()[0]),DataGlobalConfigViewModel(p),e());t==cfrmChangeRestaurant&&($("#modalSelectRestaurant").modal("hide"),vmViewIndex.showLogin(!1));vmViewIndex.showMenu(!0);vmViewIndex.showLiveOrder(!0);i.showSmileDining==!1&&i.showSmileContactlessDining==!0?c(i.showSmileContactlessDining):u(i.showSmileDining);l(i.showEgiftCard);a(i.showDeliveryBilling);o();break;case cfrmUpdateMapZoneMile:r=JSON.parse(i.obj);setUpdateMapZoneMile(r);vmViewIndex.allMapZone.listMapZoneMile();break;case cfrmUpdateSetTimeMenu:b=vmViewIndex.allSetting.isSmileDining()?JSON.parse(n(cJsonGetAllTime,products.cSmileDining)):JSON.parse(n(cJsonGetAllTime,products.cSmileContactless));switch(i.obj.toLowerCase()){case"timemenu":ko.mapping.fromJS(b.listTimeMenu,{},vmViewIndex.allSetTime.dataListTimeMenu);DataTimeMenu(vmViewIndex.allSetTime.dataListTimeMenu());hiddenShowTimeMenuEdit();break;case"timepickup":ko.mapping.fromJS(b.listTimePickUp,{},vmViewIndex.allSetTime.dataListTimePickUp);DataTimeMenu(vmViewIndex.allSetTime.dataListTimePickUp());hiddenShowTimeMenuEdit();break;case"timedelivery":ko.mapping.fromJS(b.listTimeDelivery,{},vmViewIndex.allSetTime.dataListTimeDelivery);DataTimeMenu(vmViewIndex.allSetTime.dataListTimeDelivery());hiddenShowTimeMenuEdit();break;case"foodsettimemap":ko.mapping.fromJS(b.listFoodSetTimeMap,{},vmViewIndex.allSetTime.dataListFoodSetTimeMap);DataTimeMenu(vmViewIndex.allSetTime.dataListFoodSetTimeMap());vmViewIndex.allSetTime.selectFoodSet({value:_.first(vmViewIndex.allSetTime.foodsetidkey())});hiddenShowTimeMenuEdit()}break;case cfrmUploadImageSetting:vmViewIndex.globalConfig.shopLogo(i.filename);vmViewIndex.globalConfig.delShopLogo(!0);break;case cfrmDeleteImageBackground:vmViewIndex.globalConfig.shopBackground("");vmViewIndex.globalConfig.delShopBackground(!1);break;case cfrmUploadImageTemplate:g=JSON.parse(i.obj);tt=vmViewIndex.allTemplate.data.templateImage();tt.push(new TemplateImage(g.templateImageId,g.image,vmViewIndex.allTemplate.data.templateImageUrl()));vmViewIndex.allTemplate.data.templateImage.valueHasMutated();break;case cfrmUpdateTemplate:DataTemplateViewModel(JSON.parse(i.obj));break;case cfrmLogOff:location.replace(i.url);break;case cfrmForgotPassword:$("#modalForgotPassword").modal("hide");break;case cfrmResetPassword:$("#modalResetPassword").modal("hide");break;case cfrmChangePassword:vmViewIndex.changePassword.oldPassword("");vmViewIndex.changePassword.newPassword("");vmViewIndex.changePassword.confirmPassword("");break;case cfrmDiscount:r=JSON.parse(i.obj);s=i.txtValue;setDiscount(r,s);break;case cfrmAutoCharge:r=JSON.parse(i.obj);s=i.txtValue;setAutoCharge(r,s);break;case cfrmPaymentFee:r=JSON.parse(i.obj);s=i.txtValue;setPaymentFee(r,s);case cfrmHoliday:r=JSON.parse(i.obj);s=i.txtValue;setHoliday(r,s);break;case cfrmFoodSetSetup:i.obj!=""?(r=JSON.parse(i.obj),s=i.txtValue,setFoodSet(r,s)):($("#modalSetupFoodSet").modal("hide"),enableOrDisableCheckBox(cfrmFoodSetUp_ThirdParty,!1));break;case cfrmFoodCategorySetup:i.obj!=""?(r=JSON.parse(i.obj),it=i.obj2!=undefined&&i.obj2!=""?JSON.parse(i.obj2):null,s=i.txtValue,setFoodCategory(r,it,s)):$("#modalSetupFoodCategory").modal("hide");break;case cfrmFoodSetup:var rt=JSON.parse(i.obj),ut=JSON.parse(i.jsonGroupChoiceOption),ft=JSON.parse(i.jsonFoodChoiceMap),et=JSON.parse(i.jsonFoodIconMap);s=i.txtValue;setFood(rt,ut,ft,et,s);break;case cfrmChangeImage:var rt=JSON.parse(i.obj),ut=JSON.parse(i.jsonGroupChoiceOption),ft=JSON.parse(i.jsonFoodChoiceMap),et=JSON.parse(i.jsonFoodIconMap);s=i.txtValue;setFood(rt,ut,ft,et,s);break;case cfrmFoodImageSetup:r=JSON.parse(i.obj);setFoodCustomImage(r);break;case cfrmFoodThirdPartySetup:ot=JSON.parse(i.obj);setFoodThirdParty(ot);$("#modalSetupFoodThirdParty").modal("hide");break;case cfrmAddCopyFood:k=JSON.parse(i.obj);setCopyFood(k.listFood,k.groupChoiceOptionId,k.listFoodChoiceMap,k.listFoodIconMap);break;case cfrmChoiceOptionSetUp:r=JSON.parse(i.obj);s=i.txtValue;s!=statusAdd&&(nt=JSON.parse(i.choices),nt.length>0&&setChoiceUnlock(nt));setChoiceOption(r,s);break;case cfrmChoiceSetUp:r=JSON.parse(i.obj);s=i.txtValue;w=i.objPrev!=undefined?JSON.parse(i.objPrev):null;i.message==cMenuLinkToFood?(bindDataGridLinkToFood(r),vmViewIndex.configSetUp.choice.dataSetUpModal.clearSetUpChoice(vmViewIndex.configSetUp.choice.dataSetUpModal)):(vmViewIndex.configSetUp.choice.showBtnLinkToFood(!1),setChoice(r,s,w));break;case cfrmChoiceModifySetUp:r=JSON.parse(i.obj);s=i.txtValue;w=i.objPrev!=undefined?JSON.parse(i.objPrev):null;i.message==cMenuLinkToFood?(bindDataGridLinkToFood(r),vmViewIndex.configSetUp.choiceModify.dataSetUpModal.clearSetUpChoice(vmViewIndex.configSetUp.choiceModify.dataSetUpModal)):(vmViewIndex.configSetUp.choiceModify.showBtnLinkToFood(!1),setChoiceModify(r,s,w));break;case cfrmGraguityChargeSetup:r=JSON.parse(i.obj);s=i.txtValue;setGraguityCharge(r,s);break;case cfrmFoodPrefix:r=JSON.parse(i.obj);s=i.txtValue;setFoodPrefix(r,s);break;case cfrmGraguityCharge:setGraguityChargeSetting();$("#modalShowGratuityCharge").modal("hide");break;case cfrmIconSetup:r=JSON.parse(i.obj);s=i.txtValue;setIcon(r,s);break;case cfrmLinkToFood:st=JSON.parse(i.obj);s=i.txtValue;vmViewIndex.configSetUp.linkToFood.listFoodChoiceMap(st);vmViewIndex.configSetUp.choice.showBtnLinkToFood(!1);vmViewIndex.configSetUp.choiceModify.showBtnLinkToFood(!1);ht=$("#gridLinkToFood").dxTreeList("instance");ht.deselectAll();$("#modalSetLinkToFood").modal("hide");break;case cfrmTaxRateSetUp:r=JSON.parse(i.obj);s=i.txtValue;setTaxRate(r,s);break;case cfrmRevenueClassSetUp:r=JSON.parse(i.obj);s=i.txtValue;w=i.objPrev!=undefined?JSON.parse(i.objPrev):null;setRevenueClass(r,s,w);break;case cfrmSearchReport:i.obj!=""&&i.obj!=undefined&&(r=JSON.parse(i.obj),vmViewIndex.report.chart.updateChart(!0),DataReportViewModel(r));break;case cfrmSearchBalance:r=JSON.parse(i.obj);r!=null&&DataBalanceViewModel(r);break;case cfrmUploadAnnounceImage:vmViewIndex.globalConfig.shopAnnounceImage(i.filename);vmViewIndex.globalConfig.delAnnounceImage(!0);break;case cfrmDeleteAnnounceImage:vmViewIndex.globalConfig.shopAnnounceImage("");vmViewIndex.globalConfig.delAnnounceImage(!1);break;case cfrmDeleteImageLogo:vmViewIndex.globalConfig.shopLogo("");vmViewIndex.globalConfig.delShopLogo(!1);break;case cfrmUploadAnnounceCustomImage:vmViewIndex.globalConfig.shopAnnounceCustomImage(i.filename);vmViewIndex.globalConfig.delAnnounceCustomImage(!0);break;case cfrmDeleteAnnounceCustomImage:vmViewIndex.globalConfig.shopAnnounceCustomImage("");vmViewIndex.globalConfig.delAnnounceCustomImage(!1);break;case cfrmUpdateDeliveryFreeTime:r=JSON.parse(i.obj);afterUpdateDeliveryFreeTime(r);break;case cfrmCouponDelivery:r=JSON.parse(i.obj);s=i.txtValue;setCouponDelivery(r,s);break;case cfrmEditAllGiftCardImage:r=JSON.parse(i.obj);SetAllGiftCardImageUpdate(r);break;case cfrmAddNewGiftCardValue:r=JSON.parse(i.obj);s=i.txtValue;SetNewGifCardValueAdd(r,s);break;case cfrmAddNewCustomDiscount:r=JSON.parse(i.obj);s=i.txtValue;SetNewCustomDiscountAdd(r,s);break;case cfrmGetGiftCardView:r=JSON.parse(i.obj);DataGiftCardViewViewModel(r);break;case cfrmSearchStatement:r=JSON.parse(i.obj);DataStatementViewModel(r);break;case cfrmPromotionMainPrice:r=JSON.parse(i.obj);s=i.txtValue;setMainPrice(r,s);break;case cfrmPromotionGroupMainFood:r=JSON.parse(i.obj);s=i.txtValue;setGrpMainFood(r,s);break;case cfrmPromotionGroupFreeFood:r=JSON.parse(i.obj);s=i.txtValue;setGrpFreeFood(r,s);break;case cfrmPromotionCondition:r=JSON.parse(i.obj);s=i.txtValue;setCondition(r,s);break;case cfrmShopClose:r=JSON.parse(i.obj);s=i.txtValue;setShopClose(r,s);break;case cfrmUpdateCustomMapZoneMile:r=JSON.parse(i.obj);setUpdateCustomMapZoneMile(r);break;case cfrmUpdateDisCountOneTimeUse:r=JSON.parse(i.obj);s=i.txtValue;setDiscountOneTimeUse(r,s);break;case cfrmUploadDisCountOneTimeUse:r=JSON.parse(i.obj);s=i.txtValue;setUploadDiscountOneTimeUse(r,s);break;case cfrmDownloadDisCountOneTimeUse:window.location="/Setting/Download?fileGuid="+i.fileGuid+"&filename="+i.fileName;break;case cfrmExportCustomer:if(v=JSON.parse(i.obj),v.length==1)window.location="/Marketing/Download?fileGuid="+v[0].guid+"&filename="+v[0].fileName;else{const n=n=>new Promise(t=>{setTimeout(t,n)}),t=(t,i)=>{const r=document.createElement("a");r.download=i;r.href=t;r.style.display="none";document.body.append(r);r.click();n(1e3);r.remove()};for(let n=0;n<v.length;n++)ct="/Marketing/Download?fileGuid="+v[n].guid+"&filename="+v[n].fileName,t(ct,v[n].fileName)}}$("body").removeAttr("style")}function h(){var n=store.get(cMenuSmileDining),t=store.get(cMenuEgiftCard),i=store.get(cMenuSmileContactlessDining);n||i?$("#LiveOrderSideBar").click():t&&($(".shopOpen").addClass("hidden"),$("#GiftCardSideBar").click())}function u(n){n||($("#LiveOrderSideBar").parent().hide(),$("#MenuSetupSideBar").parent().hide(),$("#ConfigSetupSideBar").parent().hide(),$("#MySettingSideBar").parent().hide(),$("#TemplateSideBar").parent().hide(),$("#ReportsSideBar").parent().hide(),$("#BalanceSideBar").parent().hide(),$("#StatementsSideBar").parent().hide(),$("#LiveOrderMenuMobile").hide(),$("#MenuSetupMenuMobile").hide(),$("#ConfigSetupMenuMobile").hide(),$("#MySettingMenuMobile").hide(),$("#TemplateMenuMobile").hide(),$("#ReportsMenuMobile").hide(),$("#BalanceMenuMobile").hide(),$("#StatementMenuMobile").hide(),$("#MarketingMenuMobile").hide());store.set(cMenuSmileDining,n)}function c(n){u(n);store.set(cMenuSmileContactlessDining,n)}function l(n){var t=$("#GiftCardSideBar"),i=$("#GiftCardMenuMobile"),r=$("#GiftCardViewSideBar"),u=$("#GiftCardViewMenuMobile");n?(t.parent().show(),r.parent().show(),i.show(),u.show()):(t.parent().hide(),r.parent().hide(),i.hide(),u.hide());store.set(cMenuEgiftCard,n)}function a(n){var t=$("#DeliveryBillingSideBar"),i=$("#DeliveryBillingMenuMobile");n?(t.parent().show(),i.show()):(t.parent().hide(),i.hide());store.set(cMenuDeliveryBilling,n)}function f(){vmViewIndex.globalConfig.switchShopOpenUtils({offText:"Close",onText:"Open",value:vmViewIndex.globalConfig.isShopOpen,width:80,onValueChanged:function(t){t.value==!0?(vmViewIndex.globalConfig.txtShopOpen("OPEN"),vmViewIndex.globalConfig.isShopOpen(!0)):(vmViewIndex.globalConfig.txtShopOpen("CLOSE"),vmViewIndex.globalConfig.isShopOpen(!1));var i="shop-status:"+vmViewIndex.globalConfig.txtShopOpen()+",productId:"+products.cSmileDining,r=JSON.parse(n(cJsonUpdateGlobalConfig,i));r?swal("Success...","Save successfully",cSwal_Icon_Success):(swal(cSwal_Alert_Error,"Try again",cSwal_Icon_Error),vmViewIndex.globalConfig.isShopOpen(!0)?(vmViewIndex.globalConfig.txtShopOpen("CLOSE"),vmViewIndex.globalConfig.isShopOpen(!1)):(vmViewIndex.globalConfig.txtShopOpen("OPEN"),vmViewIndex.globalConfig.isShopOpen(!0)))}})}function e(){vmViewIndex.globalConfig.switchShopOpenUtilsContactless({offText:"Close",onText:"Open",value:vmViewIndex.globalConfig.isShopOpenContactless,width:80,onValueChanged:function(t){t.value==!0?(vmViewIndex.globalConfig.txtShopOpenContactless("OPEN"),vmViewIndex.globalConfig.isShopOpenContactless(!0)):(vmViewIndex.globalConfig.txtShopOpenContactless("CLOSE"),vmViewIndex.globalConfig.isShopOpenContactless(!1));var i="shop-status:"+vmViewIndex.globalConfig.txtShopOpenContactless()+",productId:"+products.cSmileContactless,r=JSON.parse(n(cJsonUpdateGlobalConfig,i));r?swal("Success...","Save successfully",cSwal_Icon_Success):(swal(cSwal_Alert_Error,"Try again",cSwal_Icon_Error),vmViewIndex.globalConfig.isShopOpenContactless(!0)?(vmViewIndex.globalConfig.txtShopOpenContactless("CLOSE"),vmViewIndex.globalConfig.isShopOpenContactless(!1)):(vmViewIndex.globalConfig.txtShopOpenContactless("OPEN"),vmViewIndex.globalConfig.isShopOpenContactless(!0)))}})}function o(){var n=$(".shopOpen");$(window).width()<=783?(n.removeClass("d-none").removeClass("d-lg-block"),n.addClass("d-lg-none").addClass("switch-floating-bottom"),$("#smilecontactless").text(products.mapName[products.cSmileContactless].shotName+" : ")):(n.removeClass("d-lg-none").removeClass("switch-floating-bottom"),n.addClass("d-none").addClass("d-lg-block"),$("#smilecontactless").text(products.mapName[products.cSmileContactless].name+" : "))}function n(n,t){var i=new ObjUrl(n),r=i.getUrlFromJson(),u=JSON.parse('{"key" : "'+t+'"}');return getJsonFromAjax(r,!ajax_async,ajax_cache,ajax_type_post,u,ajax_timeout)}function s(t){var k=store.get(cMenuSmileDining),d=store.get(cMenuSmileContactlessDining),ht=store.get(cMenuEgiftCard),ct=store.get(cMenuDeliveryBilling),r,i,g,nt,o,s,h,it,v,y,rt,ut,p,ft,et,b,st;l(ht);a(ct);r=!1;k==!1&&d==!0?c(d):(u(k),i=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileDining)),r=filterGlobalConfig(i,"deliverect-autosync-product")=="1"?!0:!1,vmViewIndex.autoSyncProduct(r));r&&vmViewIndex.tabSyncProduct()&&n(cJsonGetSyncProduct,"");vmViewIndex.tabSyncProduct(!1);switch(t){case"/#LiveOrder":g=JSON.parse(n(cJsonGetLiveOrder,""));DataLiveOrderViewModel(g);vmViewIndex.showLiveOrder(!0);break;case"/#MenuSetup":if(vmViewIndex.menu.chkDrag()==!1&&vmViewIndex.menu.chkSave()==!1){var lt=JSON.parse(n(cJsonGetDataMenu,"")),at=JSON.parse(n(cJsonGetFoodSettimeMap,"")),f=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileDining)),vt=filterGlobalConfig(f,"productID");DataMenuSetupViewModel(lt,at,vt);foodSetClick()}vmViewIndex.showMenuSetUp(!0);vmViewIndex.tabSyncProduct(!0);break;case"/#ConfigSetup":vmViewIndex.configSetUp.chkDrag()==!1&&vmViewIndex.configSetUp.chkSave()==!1&&(nt=JSON.parse(n(cJsonGetConfigSetUp,"")),DataConfigSetUpViewModel(nt),vmViewIndex.configSetUp.choice.listCopyChoice([]),vmViewIndex.configSetUp.choice.visibleListCopyChoice(!1),vmViewIndex.configSetUp.choiceModify.listCopyChoice([]),vmViewIndex.configSetUp.choiceModify.visibleListCopyChoice(!1),$("#tabChoiceGroup").click());vmViewIndex.showConfigSetUp(!0);vmViewIndex.tabSyncProduct(!0);break;case"/#MySetting":if(o=JSON.parse(n(cJsonGetMap,"")),DataAllMapViewModel(o),s=_.head(o.listDeliveryFreeTime),s!=undefined&&s.shopMapCode=="noTable"&&vmViewIndex.allMapZone.hasDeliveryFreeTime(!1),h=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileDining)),DataSettingViewModel(h),vmViewIndex.allSetting.isSmileDining()){var yt=JSON.parse(n(cJsonGetAllTime,products.cSmileDining)),pt=JSON.parse(n(cJsonGetDiscount,products.cSmileDining)),wt=JSON.parse(n(cJsonGetDisCountOneTimeUse,products.cSmileDining)),tt=JSON.parse(n(cJsonGetDiscountType,products.cSmileDining)),bt=JSON.parse(n(cJsonGetAutoCharge,products.cSmileDining)),kt=JSON.parse(n(cJsonGetHoliday,products.cSmileDining)),f=h,dt=JSON.parse(n(cJsonGetDataPromotion,products.cSmileDining)),gt=JSON.parse(n(cJsonGetShopClose,products.cSmileDining)),ni=JSON.parse(n(cJsonGetPaymentFee,products.cSmileDining));$("#tabMapLabel").show()}else{var yt=JSON.parse(n(cJsonGetAllTime,products.cSmileContactless)),pt=JSON.parse(n(cJsonGetDiscount,products.cSmileContactless)),wt=JSON.parse(n(cJsonGetDisCountOneTimeUse,products.cSmileContactless)),tt=JSON.parse(n(cJsonGetDiscountType,products.cSmileContactless)),bt=JSON.parse(n(cJsonGetAutoCharge,products.cSmileContactless)),kt=JSON.parse(n(cJsonGetHoliday,products.cSmileContactless)),f=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileContactless)),dt=JSON.parse(n(cJsonGetDataPromotion,products.cSmileContactless)),gt=JSON.parse(n(cJsonGetShopClose,products.cSmileContactless)),ni=JSON.parse(n(cJsonGetPaymentFee,products.cSmileContactless));$("#tabMapLabel").hide()}it=JSON.parse(n(cJsonGetGraguity,""));AllTimeViewModel(yt);DataDiscountViewModel(pt,tt);DataAutoChargeSetUpViewModel(bt);DataDiscountOneTimeUseViewModel(wt,tt);DataHolidaySetUpViewModel(kt);DataGlobalConfigViewModel(f);DataSettingViewModel(f);DataGraguityViewModel(f,it);DataPromotionSetUpViewModel(dt);DataShopCloseSetUpViewModel(gt);DataPaymentFeeSetUpViewModel(ni);vmViewIndex.allSetting.filterProduct.valueArrProduct(products.cSmileDining);v=JSON.parse(n(cJsonGetCouponDelivery,""));y=_.head(v);y!=undefined&&y.couponDeliveryName=="noTable"&&vmViewIndex.allSetting.hasCouponDelivery(!1);DataCouponDeliveryViewModel(v);setTipsAuto(vmViewIndex.globalConfig.tipsAuto());vmViewIndex.showMySetting(!0);$("#tabRestaurant").click();$("#tabDownload").click();break;case"/#Template":rt=JSON.parse(n(cJsonGetTemplate,""));DataTemplateViewModel(rt);vmViewIndex.showTemplate(!0);$(".panel-collapse").collapse("show");break;case"/#Report":ut=JSON.parse(n(cJsonGetReport,""));DataReportViewModel(ut);vmViewIndex.showReport(!0);break;case"/#Balance":p=JSON.parse(n(cJsonGetBalance,""));p!=null&&DataBalanceViewModel(p);vmViewIndex.showBalance(!0);break;case"/#Statement":ft=JSON.parse(n(cJsonGetStatement,""));DataStatementViewModel(ft);vmViewIndex.showStatement(!0);break;case"/#DeliveryBilling":try{et=JSON.parse(n(cJsonGetDeliveryBilling,""))}catch(ui){swal("Oops...",cError_Fail_TimeOut,cSwal_Icon_Error)}DataDeliveryBillingViewModel(et);vmViewIndex.showDeliveryBilling(!0);break;case"/#E-GiftCard":vmViewIndex.showGiftCard(!0);var ti=n(cJsonGetGiftCard,""),e=JSON.parse(ti),i=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileDining)),ot=filterGlobalConfig(i,"currentDateTime"),w=moment(ot).format("MM/DD/YYYY");vmViewIndex.giftCard.giftCardShopDate(w);b=filterGlobalConfig(i,"smiledining-show-giftcard");vmViewIndex.giftCard.showPurchaseGiftCard(b);vmViewIndex.giftCard.isShowPurchaseGiftCard(b=="1"?!0:!1);e.giftCardImageTable.length>0||e.giftCardValueTable.length>0||e.customDiscountTable.length>0?(DataGiftCardViewModel(e),vmViewIndex.giftCard.guideLine(!1),$("#tabGiftCardImage").click()):(vmViewIndex.giftCard.guideLine(!0),$("#tabGiftCardGuide").click());break;case"/#E-GiftCardView":vmViewIndex.showGiftCardView(!0);var ii=n(cJsonGetGiftCardView,""),ri=JSON.parse(ii),i=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileDining)),ot=filterGlobalConfig(i,"currentDateTime"),w=moment(ot).format("MM/DD/YYYY");vmViewIndex.giftCard.giftCardView.fromDate(w);vmViewIndex.giftCard.giftCardView.endDate(w);DataGiftCardViewViewModel(ri);break;case"/#Marketing":st=JSON.parse(n(cJsonGetMarketing,""));DataMarketingViewModel(st);$("#tabExportCustomer").click();vmViewIndex.showMarketing(!0)}vmViewIndex.showLoading(!1)}function d(){var n=vmViewIndex;n.showLiveOrder(!1);n.showMenuSetUp(!1);n.showConfigSetUp(!1);n.showMySetting(!1);n.showTemplate(!1);n.showReport(!1);n.showBalance(!1);n.showStatement(!1);n.showDeliveryBilling(!1);n.showGiftCard(!1);n.showGiftCardView(!1);n.showMarketing(!1);setScrollTop()}function g(n){var t=0;vmViewIndex.configSetUp.chkDrag()==!0&&vmViewIndex.configSetUp.chkSave()==!1&&n!="/#ConfigSetup"?swal(setupAlert).then(function(){undoDraggingConfigSetup();vmViewIndex.showLoading(!0);setTimeout(function(){s(n)},t)},function(n){n==="cancel"&&vmViewIndex.configSetUp.chkDrag()==!0&&$("#ConfigSetupSideBar").click()}):vmViewIndex.menu.chkDrag()==!0&&vmViewIndex.menu.chkSave()==!1&&n!="/#MenuSetup"?swal(setupAlert).then(function(){undoMenuDragging();vmViewIndex.showLoading(!0);setTimeout(function(){s(n)},t)},function(n){n==="cancel"&&vmViewIndex.menu.chkDrag()==!0&&$("#MenuSetupSideBar").click()}):vmViewIndex.giftCard.addGiftCard.lockEdit()==!0&&n!="/#E-GiftCard"?swal(setupAlert).then(function(){vmViewIndex.showLoading(!0);vmViewIndex.giftCard.addGiftCard.lockEdit(!1);setTimeout(function(){s(n)},t)},function(n){n==="cancel"&&vmViewIndex.giftCard.addGiftCard.lockEdit()&&$("#GiftCardSideBar").click()}):(vmViewIndex.showLoading(!0),setTimeout(function(){s(n)},t))}function nt(n){var t=$("ul"),i=n.substring(1);t.children().removeClass("active");t.find('a[href="'+i+'"]').parent().addClass("active")}function tt(){setInterval(function(){n(cJsonKeepSessionAlive,"")},9e5)}var p=$("#divVarAuthenticated").val(),w=convertStrToBool($("#divVarShowResetPasswordForm").val()),it=$("#divErrorServerMaintenance").data("request-url"),t,r;if(isEmpty(p))vmViewIndex=new v(i,y),vmViewIndex.allSetting.isMultiProduct()==!0&&vmViewIndex.globalConfig.shopOpenContactless(shopStatus(filterGlobalConfig(t,gcShopStatus)));else{var i=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileDining)),y=JSON.parse(n(cJsonGetAllTimeZone,""));vmViewIndex=new v(i,y);vmViewIndex.showLogin(!1);vmViewIndex.showMenu(!0);DataSettingViewModel(i);t=null;(vmViewIndex.allSetting.isSmileDining()==!1||vmViewIndex.allSetting.isMultiProduct()==!0)&&(t=JSON.parse(n(cJsonGetGlobalConfig,products.cSmileContactless)));vmViewIndex.allSetting.isMultiProduct()==!0?(DataGlobalConfigViewModel(i),f(),vmViewIndex.globalConfig.shopOpenContactless(shopStatus(filterGlobalConfig(t,gcShopStatus))),r=ko.observableArray([{globalConfigKey:"smileContactless",globalConfigValue:!0,globalConfigDesc:null}]),t.push(r()[0]),DataGlobalConfigViewModel(t),e()):vmViewIndex.allSetting.isSmileDining()==!0?(DataGlobalConfigViewModel(i),f()):(r=ko.observableArray([{globalConfigKey:"smileContactless",globalConfigValue:!0,globalConfigDesc:null}]),t.push(r()[0]),DataGlobalConfigViewModel(t),e());o();h()}ko.applyBindings(vmViewIndex,document.getElementById("koMenuView"));Sammy(function(){this.get("#:view",function(n){nt(n.path);d();g(n.path)})}).run("");$(document).on("submit","form",function(n){var l,a,v,y,o,i,nt,p,w,s,t,b,e,c;if(!checkInternetConnection())return l=new ObjAlert(r,cError_Fail_NoInternet,!1),l.getAlert(),!1;var d=$(this),r=d.attr("id"),g=$(this).parent(),u=new ObjValidateForm(r,g),f="";if(isSafari()?(a=$(n.target).find("button[value=Link]"),a.length>0?f="Link":(v=$(n.target).find("button[type=submit]"),ko.utils.arrayForEach(v,function(n){$(n).is(":visible")==!0&&(n.value==statusAdd||n.value==statusUpdate||n.value==statusLink)&&(f=n.value)}))):f=$(document.activeElement).val(),vmViewIndex.disableButtonCloseModal(!0),vmViewIndex.disablePointer("default"),u.verifyData(),u.error.length>0)return u.showAlert&&(y=convertArrToString(u.error),swal(cSwal_Alert_Error,replaceNewLineToBr(y),cSwal_Icon_Error)),vmViewIndex.disableButtonCloseModal(!1),vmViewIndex.disablePointer("pointer"),!1;if(addSpinButton(r),i=$(this).serialize(),o=!1,r==cfrmUploadImageSetting||r==cfrmUploadImageTemplate||r==cfrmChangeImage||r==cfrmFoodSetup||r==cfrmLinkToFood||r==cfrmUploadAnnounceImage||r==cfrmDeleteImageLogo||r==cfrmDeleteAnnounceImage||r==cfrmUploadAnnounceCustomImage||r==cfrmDeleteAnnounceCustomImage||r==cfrmUploadDisCountOneTimeUse||r==cfrmFoodThirdPartySetup||r==cfrmIconSetup||r==cfrmFoodImageSetup||r==cfrmDeleteImageBackground){o=!0;i=new FormData;switch(r){case cfrmUploadImageSetting:i.append("uploadImageLogo",jQuery("#uploadImageLogo").get(0).files[0]);t=vmViewIndex.allSetting;i.append("isSmileDining",t.isSmileDining());i.append("isMultiProduct",t.isMultiProduct());break;case cfrmUploadImageTemplate:i.append("uploadImage",jQuery("#uploadImage").get(0).files[0]);break;case cfrmChangeImage:return!1;case cfrmLinkToFood:vmViewIndex.showLoading(!0);getDataTreeListLinkToFood();t=vmViewIndex.configSetUp.linkToFood;i.append("ChoiceId",t.choiceId());i.append("ChoiceOptionId",t.choiceOptionId());i.append("SelectedLinkToFood",t.selectedLinkToFood());break;case cfrmFoodSetup:t=vmViewIndex.menu.dataSetupFoodModal;typeof t.tempId()=="string"?i.append("tempId",t.tempId()):i.append("uploader",t.tempId());i.append("foodId",t.foodId());i.append("foodName",t.foodName());i.append("foodNameAlt",t.foodNameAlt());i.append("foodPrice",t.foodPrice());i.append("foodDesc",t.foodDesc());i.append("active",t.active());i.append("foodSetId",t.foodSetId());i.append("foodCatId",t.foodCatId());i.append("revenueClassId",t.revenueClassId());i.append("taxRateId",t.taxRateId());i.append("image",t.image());i.append("allChoiceOptions",t.dataOptionFood());i.append("qtyLimit",t.qtyLimit());i.append("arrProduct",t.arrProduct());i.append("productId",t.productId());i.append("isOutStock",t.isOutStock());i.append("isFree",t.isFree());i.append("isShow",t.isShow());i.append("productTagMap",t.productTagSelect());nt=null;t.listIconForDrag().length!=0&&(t.listIconForDrag().load().done(function(n){dataItems=ko.mapping.fromJS(_.orderBy(ko.mapping.toJS(n),["sorting"],["asc"]))()}),i.append("icon",ko.toJSON(dataItems)));break;case cfrmFoodImageSetup:t=vmViewIndex.menu.dataSetupFoodModal;typeof t.tempIdDesktopMenu()=="string"?i.append("uploaderDesktopMenu",jQuery("#uploaderEdit"+t.tempIdDesktopMenu()).get(0).files[0]):i.append("uploaderDesktopMenu",t.tempIdDesktopMenu());typeof t.tempIdDesktopFood()=="string"?i.append("uploaderDesktopFood",jQuery("#uploaderEdit"+t.tempIdDesktopFood()).get(0).files[0]):i.append("uploaderDesktopFood",t.tempIdDesktopFood());typeof t.tempIdMobileMenu()=="string"?i.append("uploaderMobileMenu",jQuery("#uploaderEdit"+t.tempIdMobileMenu()).get(0).files[0]):i.append("uploaderMobileMenu",t.tempIdMobileMenu());typeof t.tempIdMobileFood()=="string"?i.append("uploaderMobileFood",jQuery("#uploaderEdit"+t.tempIdMobileFood()).get(0).files[0]):i.append("uploaderMobileFood",t.tempIdMobileFood());i.append("foodId",t.foodId());p=t.tempIdDesktopMenu()==""||t.tempIdDesktopFood()==""||t.tempIdMobileMenu()==""||t.tempIdMobileFood()==""?"":t.image();i.append("image",p);break;case cfrmUploadAnnounceImage:i.append("uploadAnnounceImage",jQuery("#uploadAnnounceImage").get(0).files[0]);t=vmViewIndex.allSetting;i.append("isSmileDining",t.isSmileDining());break;case cfrmUploadAnnounceCustomImage:i.append("uploadAnnounceCustomImage",jQuery("#uploadAnnounceCustomImage").get(0).files[0]);t=vmViewIndex.allSetting;i.append("isSmileDining",t.isSmileDining());break;case cfrmDeleteAnnounceCustomImage:t=vmViewIndex.allSetting;i.append("isSmileDining",t.isSmileDining());break;case cfrmDeleteImageLogo:t=vmViewIndex.allSetting;i.append("isSmileDining",t.isSmileDining());i.append("isMultiProduct",t.isMultiProduct());break;case cfrmDeleteAnnounceImage:t=vmViewIndex.allSetting;i.append("isSmileDining",t.isSmileDining());break;case cfrmUploadDisCountOneTimeUse:i.append("uploadDiscountFile",jQuery("#uploadDiscountFile").get(0).files[0]);t=vmViewIndex.allSetting;i.append("isSmileDining",t.isSmileDining());break;case cfrmFoodThirdPartySetup:w=$("#modalSetupFoodThirdParty .select-group")[0].attributes.id.value.split("_")[1];replaceDataFoodInArray(w);s=ko.utils.arrayFilter(vmViewIndex.menu.foodInThirdPartyGroup(),function(n){return typeof n.tempId()!="string"});s.length>0&&(i.append("uploader",_.first(s).tempId()),ko.utils.arrayForEach(vmViewIndex.menu.foodInThirdPartyGroup(),function(n){typeof n.tempId()!="string"&&n.tempId("")}));vmViewIndex.menu.listThirdPartyGroups(ko.toJSON(vmViewIndex.menu.thirdPartyGroups()));vmViewIndex.menu.listFoodInThirdPartyGroup(ko.toJSON(vmViewIndex.menu.foodInThirdPartyGroup()));t=vmViewIndex.menu;i.append("FoodId",t.baseFoodThirdParty());i.append("GroupThirdParty",t.listThirdPartyGroups());i.append("FoodThirdParty",t.listFoodInThirdPartyGroup());break;case cfrmIconSetup:t=vmViewIndex.configSetUp.iconSetup.dataSetUpModal;typeof jQuery("#iconUploaderEdit").get(0)!="undefined"?i.append("uploaderIconImage",jQuery("#iconUploaderEdit").get(0).files[0]):i.append("uploaderIconImage",t.iconImage());i.append("iconId",t.iconId());i.append("iconName",t.iconName());i.append("iconImage",t.iconImage());i.append("hexColor",t.hexColor());i.append("isFocus",t.isFocus());i.append("isShowText",t.isShowText());i.append("active",t.active());break;case cfrmDeleteImageBackground:t=vmViewIndex.allSetting;i.append("isSmileDining",t.isSmileDining())}}return(b=new ObjUrl(r,f),e=b.getUrlSubmitForm(),isEmpty(e))?(swal(cSwal_Alert_Error,cError_Dev_Url,cSwal_Icon_Error),!1):(c=o?$.ajax({url:e,async:ajax_async,cache:ajax_cache,type:ajax_type_post,data:i,processData:!1,contentType:!1,timeout:ajax_timeout}):$.ajax({url:e,async:ajax_async,cache:ajax_cache,type:ajax_type_post,data:i,timeout:ajax_timeout}),c.done(function(n){var t;n.status&&k(r,n);u.showAlert&&(r==cfrmLogIn?n.status&&n.message.toLowerCase()=="support"?$("#modalSelectRestaurant").modal("show"):n.status?h():(t=new ObjAlert(r,n.message,n.status),t.getAlert()):r==cfrmChangeRestaurant?n.status?h():(t=new ObjAlert(r,n.message,n.status),t.getAlert()):r==cfrmSearchReport||r==cfrmSearchBalance?n.status||(t=new ObjAlert(r,n.message,n.status),t.getAlert()):r==cfrmResetPassword?(vmViewIndex.showLoading(!1),swal({text:n.message,type:"success",confirmButtonText:"OK",preConfirm:function(){window.location="https://webowner.smiledining.com"}})):r==cfrmChoiceSetUp||r==cfrmChoiceModifySetUp?n.message!=cMenuLinkToFood&&(vmViewIndex.showLoading(!1),t=new ObjAlert(r,n.message,n.status),t.getAlert(),vmViewIndex.configSetUp.disableButtonSubmit(!1)):r==cfrmSearchStatement?n.status||(t=new ObjAlert(r,n.message,n.status),t.getAlert()):(vmViewIndex.showLoading(!1),t=new ObjAlert(r,n.message,n.status),t.getAlert(),vmViewIndex.allSetting.disableButtonSubmit(!1),vmViewIndex.configSetUp.disableButtonSubmit(!1)));removeSpinButton(r);vmViewIndex.showLoading(!1);vmViewIndex.disableButtonCloseModal(!1);vmViewIndex.disablePointer("pointer")}),c.fail(function(){removeSpinButton(r);vmViewIndex.showLoading(!1);var n=new ObjAlert(r,cError_Fail_TimeOut,!1);n.getAlert();vmViewIndex.disableButtonCloseModal(!1);vmViewIndex.disablePointer("pointer")}),!1)});$("nav.nav-mobile").slideAndSwipe();$(".backToTop").on("click",function(n){n.preventDefault();$("html, body").animate({scrollTop:0},"300")});$(window).scroll(function(){var n=$(window).scrollTop();n>300?$(".backToTop").addClass("show"):$(".backToTop").removeClass("show")});setMaskPhone();$(".mask-expiry").inputmask({mask:"99/9999"});$(".touch-slide").find("radio:eq(0)").prop("checked",!0);$(".touch-slide").find("label:eq(0)").addClass("theme default-background-color-dark force");$("form").bind("invalid-form.validate",b);setTimeout(function(){$("body").addClass("loaded");$(".viewLoading").removeClass("gb_hidden");w&&($("#modalResetPassword").modal({backdrop:"static",keyboard:!1}),$("#modalResetPassword").modal("hide"),$("#modalResetPassword").modal("show"));var n=checkVersionIE();isEmpty(n)||n<11&&$("#browserVerionModel").modal("show")},1e3);tt();$.fn.rotateY=function(n){return this.css({transform:"rotateY("+n+"deg)"}),this.css({"-ms-transform":"rotateY("+n+"deg)"}),this.css({"-moz-transform":"rotateY("+n+"deg)"}),this.css({"-o-transform":"rotateY("+n+"deg)"}),this.css({"-webkit-transform":"rotateY("+n+"deg)"}),this};$("#accordionTemplateMain").on("click",".link-zoom",function(){$(this).find(".arrowmaximize").hasClass("gb_hidden")?($(this).find(".arrowmaximize").removeClass("gb_hidden"),$(this).find(".arrowMinimize").addClass("gb_hidden")):($(this).find(".arrowmaximize").addClass("gb_hidden"),$(this).find(".arrowMinimize").removeClass("gb_hidden"))});$("#accordionTemplateDetail").on("click",".link-zoom",function(){$(this).find(".arrowmaximize").hasClass("gb_hidden")?($(this).find(".arrowmaximize").removeClass("gb_hidden"),$(this).find(".arrowMinimize").addClass("gb_hidden")):($(this).find(".arrowmaximize").addClass("gb_hidden"),$(this).find(".arrowMinimize").removeClass("gb_hidden"))});$(window).resize(function(){o()});window.onbeforeunload=function(){if(vmViewIndex.autoSyncProduct()&&vmViewIndex.tabSyncProduct()){vmViewIndex.showLoading(!0);var n=new ObjUrl(cJsonGetSyncProduct),t=n.getUrlFromJson();getJsonFromAjax(t,ajax_async,ajax_cache,ajax_type_post,"",3e4);vmViewIndex.showLoading(!1)}if(vmViewIndex.configSetUp.chkDrag()==!0&&vmViewIndex.configSetUp.chkSave()==!1||vmViewIndex.menu.chkDrag()==!0&&vmViewIndex.menu.chkSave()==!1||vmViewIndex.giftCard.addGiftCard.lockEdit()==!0)return cMessage_LeavePage};jQuery.event.props.push("dataTransfer"),function(){var t,n={settings:[],uploaded:[],init:function(i){n.settings=i;t=i;n.bindUIActions()},bindUIActions:function(){for(var r,i=0;i<t.length;i++){t[i].each(function(){$(this).data("width",$(this).data("base-width")).data("height",$(this).data("base-height")).data("zoom-factor",0);$(this).css({width:$(this).data("base-width"),height:$(this).data("base-height")})});t[i].on("dragover",".image-uploader",function(){return clearTimeout(r),n.showDroppableArea($(this)),!1});t[i].on("dragleave",".image-uploader",function(){r=setTimeout(function(){n.hideDroppableArea($(this))},200)});t[i].on("drop",".image-uploader",function(n){n.preventDefault();$(".zoom",$(this)).show("fade")})}$(document).on("click",".zoom .plus",function(){n.zoom($(this).parent().parent(),1)});$(document).on("click",".zoom .minus",function(){n.zoom($(this).parent().parent(),-1)});$(document).on("click",".zoom .close-uploader",function(){n.reset($(this).parent().parent());$(this).parent().prev().val("");n.showDataInImage($(this).parent().parent())});$(document).on("change",".display-uploader",function(t){if($(this).val().length==0)return!0;$(this).parent().parent().attr("id")!="upload-cropImage"&&n.handleDrop($(this).parent(),t.target.files)});$(document).on("click",".image-uploader .image",function(){var n=_.first($(this).parent().find(".display-uploader")).id;$("#"+n,$(this).parent()).trigger("click")});$(document).on("mouseenter",".image-uploader",function(){typeof $(this).find("img").attr("src")!="undefined"&&$(this).find("img").attr("src").length>0&&$(this).find(".zoom").show("fade")});$(document).on("mouseleave",".image-uploader",function(){typeof $(this).find("img").attr("src")!="undefined"&&$(this).find("img").attr("src").length>0&&$(this).find(".zoom").hide()})},showDroppableArea:function(n){n.addClass("droppable")},hideDroppableArea:function(n){n.removeClass("droppable")},handleDrop:function(t,i){n.hideDroppableArea(t);var r=_.first(i);r.type.match("image.*")?n.handleImage(t,r):(n.reset($(t)),n.showDataInImage($(t)),alert("This file is not an image."))},handleImage:function(t,i){n.resizeImage(t,i,t.data("base-width"),t.data("base-height"),function(r,u){n.placeImage(t,r);var f=$(t).position();$("img",t).css({left:t.data("pos-x"),top:t.data("pos-y"),cursor:"pointer",width:u});n.hideDataInImage(t);n.uploaded[t]=i})},hideDataInImage:function(n){$(n).find("small").hide();$(n).find("i").hide();$(n).find("br").hide()},showDataInImage:function(n){$(n).find("small").show();$(n).find("i").show();$(n).find("br").show()},resizeImage:function(n,t,i,r,u){var f=new FileReader;f.onload=function(){imageResize(n,this.result,i,r,u)};f.readAsDataURL(t);f.onabort=function(){alert("The upload was aborted.")};f.onerror=function(){alert("An error occured while reading the file.")}},placeImage:function(n,t){n.addClass("filled");$("img",n).attr("src",t)},reset:function(t){$("img",t).attr("src","").css({position:"",top:"",left:"",width:""});$(t).data("width",$(t).data("base-width")).data("height",$(t).data("base-height")).data("zoom-factor",0).removeClass("filled");n.uploaded[t]=null;$(".zoom",t).hide()},zoom:function(t,i){var r,u,e,o,s,h,f,c,l,v;if(r=t.data("width"),u=t.data("height"),e=t.data("original-width"),o=t.data("original-height"),s=t.data("base-width"),h=t.data("base-height"),f=t.data("zoom-factor"),(!(r>=e)||!(u>=o)||!(i>0))&&!(f+i<0)){c=(-$("img",t).position().left+s/2)/r;l=(-$("img",t).position().top+h/2)/u;f+=i;$(t).data("zoom-factor",f);var a=e/o,r=a<=1?s:Math.round(e*h/o),u=a>1?h:Math.round(o*s/e);r=r*(1+f*.1);u=u*(1+f*.1);c=-(Math.round(c*r)-s/2);l=-(Math.round(l*u)-h/2);$(t).data("pos-x",c);$(t).data("pos-y",l);$(t).data("width",r);$(t).data("height",u);v=n.uploaded[t];n.handleImage(t,v)}}};n.init([$(document)])}();closeModalWhenDupplicate()});