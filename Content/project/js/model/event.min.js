function Event(){var n=this;n.enableIndex=function(){$(".side-nav-memu").css("z-index","1");$(".card ").css("z-index","-1");$(".card-menu").css("z-index","1");$(".panel-cart").css("z-index","2")};n.disableIndex=function(){$(".side-nav-memu").css("z-index","-1");$(".card ").css("z-index","1");$(".card-menu").css("z-index","1");$(".panel-cart").css("z-index","2")};n.clickTabConfig=function(n,t){if(vmViewIndex.configSetUp.chkDrag()==!0&&vmViewIndex.configSetUp.chkSave()==!1)swal(setupAlert).then(function(){var e=vmViewIndex.configSetUp.choiceOption,r,u,f,i;undoDragging(e);$("#gridChoiceOption").dxDataGrid("instance").refresh();r=vmViewIndex.configSetUp.choice;undoDragging(r);$("#gridChoice").dxDataGrid("instance").refresh();u=vmViewIndex.configSetUp.choiceModify;undoDragging(u);$("#gridChoiceModify").dxDataGrid("instance").refresh();f=vmViewIndex.configSetUp.foodPrefix;undoDragging(f);$("#gridFoodPrefix").dxDataGrid("instance").refresh();vmViewIndex.configSetUp.chkDrag(!1);i=$(t.target).data("id");$(".tab-config").find("label").removeClass("theme default-background-color-dark force");setTab(n,t,i);setVisibleCart(i)});else{var i=$(t.target).data("id");$(".tab-config").find("label").removeClass("theme default-background-color-dark force");setTab(n,t,i);setVisibleCart(i)}};n.clickTabMarketing=function(n,t){var i=$(t.target).data("id");$(".tab-Marketing").find("label").removeClass("theme default-background-color-dark force");setTab(n,t,i);setVisibleCart(i)};n.clickTabMySetting=function(n,t){var i=$(t.target).data("id");vmViewIndex.allSetting.tabSettingIndexClick(i);$(".tab-mysetting").find("label").removeClass("theme default-background-color-dark force");setTab(n,t,i)};n.clickTabDiscountFile=function(n,t){var i=$(t.target).data("id");$(".tab-discountfile").find("label").removeClass("theme default-background-color-dark force");$(t.target).next("label").addClass("theme default-background-color-dark force");$(".owner-tabs-wrapper").find(".tab-discount-body").each(function(){$(this).data("id")==i?($(this).css("opacity",1),$(this).css("position","relative"),$(this).show()):($(this).css("opacity",0),$(this).css("position","absolute"),$(this).hide())})};n.clickFoodSet=function(n,t){if(vmViewIndex.menu.chkDrag()==!0&&vmViewIndex.menu.chkSave()==!1)swal(setupAlert).then(function(){vmViewIndex.menu.chkDrag(!1);vmViewIndex.menu.tempDataDragging([]);vmViewIndex.menu.tempItemDragging([]);$(".foodSetDrag").sortable("enable");$(".foodCatDrag").sortable("enable");$(".foodDrag").sortable("enable");var i=$(t.target).data("id");$(".touch-slide").find("label").removeClass("theme default-background-color-dark force");setTab(n,t,i)});else{var i=$(t.target).data("id");$(".touch-slide").find("label").removeClass("theme default-background-color-dark force");setTab(n,t,i)}};n.clickFoodCategory=function(n,t){var r=ko.contextFor(t.target),u=r.$index(),i="#"+n.foodSet.foodSetSorting()+"_"+n.foodCategory.foodCatSorting()+"_"+u,f=$(i).attr("class");f==="collapse"?($(i).collapse("show"),$(document).find(i).addClass("show"),$(t.target).parent().find(".fa-arrow-down").addClass("gb_hidden"),$(t.target).parent().find(".fa-arrow-up").removeClass("gb_hidden")):($(i).collapse("hide"),$(t.target).parent().find(".fa-arrow-up").addClass("gb_hidden"),$(t.target).parent().find(".fa-arrow-down").removeClass("gb_hidden"))};ko.bindingHandlers.foodSetDrag={init:function(n){initMenuDragging(n,"foodSetDrag","span","foodSet","foodSetId","foodSetSorting",vmViewIndex.menu.dataMenu,vmViewIndex.menu.tempDataDragging,vmViewIndex.menu.tempItemDragging)}};ko.bindingHandlers.foodCatDrag={init:function(n){initMenuDragging(n,"foodCatDrag","span","foodCategory","foodCatId","foodCatSorting",vmViewIndex.menu.dataMenu,vmViewIndex.menu.tempDataDragging,vmViewIndex.menu.tempItemDragging)}};ko.bindingHandlers.foodDrag={init:function(n){initMenuDragging(n,"foodDrag","div","food","foodId","foodSorting",vmViewIndex.menu.dataMenu,vmViewIndex.menu.tempDataDragging,vmViewIndex.menu.tempItemDragging)}};ko.bindingHandlers.giftCardSlick={init:function(){},update:function(n,t,r,u){$(n).empty();var e=ko.unwrap(u.giftCard.giftCardImageStorage()),o=ko.unwrap(t()),f=0,s="";o.length>0&&(o.forEach(function(n){if(u.giftCard.giftCardValueSorting().length>0){var t=_.find(u.giftCard.giftCardValueSorting(),function(t){return t.giftCerValueId==n.giftCerValueId()});t!=undefined&&n.sorting(t.sorting)}}),s=_.sortBy(o,function(n){return n.sorting()}));s.length>0&&(s.forEach(function(t){var i,o,s,r,u;$(n).attr("class","center-slick slider");i=$("<div>");o=$("<span>");o.attr("class","card-name text-truncate");o.append(t.giftCerValueName());i.append(o);i.attr("onclick","onClickGiftCardForDetail("+ko.toJSON(t)+" , event)");i.attr("class","card card-giftcard");t.active()||(s=$("<span>"),s.attr("class","txt-inactive-detail"),s.append("Inactive"),i.append(s),i.css("opacity","0.8"));i.attr("id",t.giftCerValueId());r=$("<img>");e.length>0?(r.attr("src",e[f].giftCerImagesName()),i.append(r),f++,f>=e.length&&(f=0)):(r.attr("src",cDummyImage),i.append(r));u=$("<span>");u.attr("class","card-getamount");t.getAsPay()?u.append("custom discount"):u.append("$"+t.getAmount());i.append(u);$(n).append(i)}),$(".center-slick").slick({arrows:!0,infinite:!1,slidesToShow:1,slidesToScroll:1,variableWidth:!0,mobileFirst:!0}),$(function(){var n;$("*[sortable!=true]",".slick-track").unbind("sortstart");$(".slick-track").sortable({cursor:"move",forcePlaceholderSize:!1,opacity:.4,start:function(t,i){i.item.toggleClass("slick-highlight");n=i.item.index()},change:function(n,t){t.placeholder.toggleClass("slick-placeholder")},update:function(){vmViewIndex.giftCard.addGiftCard.slickMove(!0)},stop:function(t,r){var u,f;if(r.item.toggleClass("slick-highlight"),u=r.item.index(),n<u){for(f=vmViewIndex.giftCard.giftCardValueSorting()[n],i=n;i<u;i++)vmViewIndex.giftCard.giftCardValueSorting()[i]=vmViewIndex.giftCard.giftCardValueSorting()[i+1],vmViewIndex.giftCard.giftCardValueSorting()[i].sorting=i+1;vmViewIndex.giftCard.giftCardValueSorting()[u]=f;vmViewIndex.giftCard.giftCardValueSorting()[u].sorting=u+1}else if(n>u){for(f=vmViewIndex.giftCard.giftCardValueSorting()[n],i=n;i>u;i--)vmViewIndex.giftCard.giftCardValueSorting()[i]=vmViewIndex.giftCard.giftCardValueSorting()[i-1],vmViewIndex.giftCard.giftCardValueSorting()[i].sorting=i+1;vmViewIndex.giftCard.giftCardValueSorting()[u]=f;vmViewIndex.giftCard.giftCardValueSorting()[u].sorting=u+1}}})}))}};ko.bindingHandlers.giftCardGuidelineSlick={init:function(){},update:function(n,t,r,u){$(n).empty();var e=ko.unwrap(u.giftCard.showGuideLine.giftCardImageData()),o=ko.unwrap(t()),f=0,s="";o.length>0&&(o.forEach(function(n){if(u.giftCard.showGuideLine.giftCardValueDataSorting().length>0){var t=_.find(u.giftCard.showGuideLine.giftCardValueDataSorting(),function(t){return t.giftCerValueId==n.giftCerValueId()});t!=undefined&&n.sorting(t.sorting)}}),s=_.sortBy(o,function(n){return n.sorting()}));s.length>0&&(s.forEach(function(t){var i,o,s,r,u;$(n).attr("class","center-slick slider");i=$("<div>");o=$("<span>");o.attr("class","card-name text-truncate");o.append(t.giftCerValueName());i.append(o);i.attr("onclick","onClickGiftCardGuideLineForDetail("+ko.toJSON(t)+" , event)");i.attr("class","card card-giftcard");t.active()||(s=$("<span>"),s.attr("class","txt-inactive-detail"),s.append("Inactive"),i.append(s),i.css("opacity","0.8"));i.attr("id",t.giftCerValueId());r=$("<img>");e.length>0?(r.attr("src",e[f].giftCerImagesName()),i.append(r),f++,f>=e.length&&(f=0)):(r.attr("src",cDummyImage),i.append(r));u=$("<span>");u.attr("class","card-getamount");t.getAsPay()?u.append("custom"):u.append("$"+t.getAmount());i.append(u);$(n).append(i)}),$(".center-slick").slick({arrows:!0,infinite:!1,slidesToShow:1,slidesToScroll:1,accessibility:!0,variableWidth:!0,variableHeight:!0,mobileFirst:!0}));$(function(){var n;$("*[sortable!=true]",".slick-track").unbind("sortstart");$(".slick-track").sortable({cursor:"move",forcePlaceholderSize:!1,opacity:.4,start:function(t,i){i.item.toggleClass("slick-highlight");n=i.item.index()},update:function(){},change:function(n,t){t.placeholder.toggleClass("slick-placeholder")},stop:function(t,r){var u,f;if(r.item.toggleClass("slick-highlight"),u=r.item.index(),n<u){for(f=vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[n],i=n;i<u;i++)vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[i]=vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[i+1],vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[i].sorting=i+1;vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[u]=f;vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[u].sorting=u+1}else if(n>u){for(f=vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[n],i=n;i>u;i--)vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[i]=vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[i-1],vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[i].sorting=i+1;vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[u]=f;vmViewIndex.giftCard.showGuideLine.giftCardValueDataSorting()[u].sorting=u+1}}})})}};ko.bindingHandlers.giftCardImageDrag={init:function(n){initGiftCardImageDragging(n)}};ko.bindingHandlers.giftCardImageDragDrop={init:function(n,t){initGiftCardImageDragDrop(n,t)}};n.clickGiftCardValueTab=function(n,t){var i=$(t.target).data("id");$(".tab-GiftCard").find("label").removeClass("theme default-background-color-dark force");setTab(n,t,i)};n.clickGiftCardImageTab=function(n,t){var i=$(t.target).data("id");$(".tab-GiftCard").find("label").removeClass("theme default-background-color-dark force");setTab(n,t,i)};n.clickGiftCardGuideTab=function(n,t){var i=$(t.target).data("id");$(".tab-GiftCard").find("label").removeClass("theme default-background-color-dark force");setTab(n,t,i)};n.clickGiftCardSettingTab=function(n,t){var i=$(t.target).data("id");$(".tab-GiftCard").find("label").removeClass("theme default-background-color-dark force");setTab(n,t,i)};n.isMainPrice=ko.observable(!1);n.isMainFood=ko.observable(!1);n.clickCondition=function(t,i){var r=$(i.target).data("id");n.showGridSettingPromotion(n.showGridSettingPromotion()+1);r==1?(n.isMainPrice(!0),n.isMainFood(!1)):(n.isMainPrice(!1),n.isMainFood(!0))};n.showGridSettingPromotion=ko.observable(cStepFree);n.clickNextSettingPromotion=function(){n.showGridSettingPromotion(n.showGridSettingPromotion()+1)};n.clickBackSettingPromotion=function(){n.showGridSettingPromotion(n.showGridSettingPromotion()-1)};n.clickClosePromotion=function(){$("#modalShowSetUpPromotion").modal("hide");n.showGridSettingPromotion(cStepFree)}}function setVisibleCart(n){n==cTabChoiceOptionId?(vmViewIndex.configSetUp.isClickTabChoiceOption(!0),vmViewIndex.configSetUp.isClickTabChoiceModify(!1),vmViewIndex.configSetUp.isClickTabChoice(!0)):n==cTabChoiceModifyId?(vmViewIndex.configSetUp.isClickTabChoiceOption(!1),vmViewIndex.configSetUp.isClickTabChoiceModify(!0),vmViewIndex.configSetUp.isClickTabChoice(!0)):(vmViewIndex.configSetUp.isClickTabChoiceOption(!1),vmViewIndex.configSetUp.isClickTabChoiceModify(!1),vmViewIndex.configSetUp.isClickTabChoice(!1))}function SetAllGiftCardImageUpdate(n){var t,r,u;for(i=0;i<n.length;i++)t=n[i],t.giftCerImagesName=cPathGiftCardImage+t.giftCerImagesName,r=new DataGiftCardImageViewModel(t),u=ko.utils.arrayFilter(vmViewIndex.giftCard.giftCardImageStorage(),function(n){return n.giftCerImagesId()==r.giftCerImagesId()}),vmViewIndex.giftCard.giftCardImageStorage.replace(_.first(u),r);vmViewIndex.giftCard.addGiftCard.lockEdit(!1)}function SetNewGiftCardImageAdd(n){var t,r;for(i=0;i<n.length;i++)t=n[i],t.giftCerImagesName=cPathGiftCardImage+t.giftCerImagesName,r=new DataGiftCardImageViewModel(t),vmViewIndex.giftCard.giftCardImageStorage.push(r)}function SetDeleteGiftCardImage(n){var t=ko.utils.arrayFilter(vmViewIndex.giftCard.giftCardImageStorage(),function(t){return t.giftCerImagesId()==n});vmViewIndex.giftCard.giftCardImageStorage.removeAll(t)}function SetNewGifCardValueAdd(n,t){var i,u,r,f,e;$(cModalShowAddNewGiftCardValue).modal("hide");i=new DataGiftCardValueViewModel({giftCerValueId:n.giftCerValueId,giftCerValueName:n.giftCerValueName,getAmount:n.getAmount,payAmount:n.payAmount,isDiscountAmount:n.isDiscountAmount,isDiscountPercent:n.isDiscountPercent,discountAmount:n.discountAmount,discountPercent:n.discountPercent,getAsPay:n.getAsPay,activateOnly:n.activateOnly,sorting:n.sorting,active:n.active});t==statusAdd?(vmViewIndex.giftCard.giftCardValueStorage.push(i),vmViewIndex.giftCard.giftCardValueSorting.push({giftCerValueId:i.giftCerValueId(),sorting:i.sorting()})):(u=ko.utils.arrayFilter(vmViewIndex.giftCard.giftCardValueStorage(),function(n){return n.giftCerValueId()==i.giftCerValueId()}),vmViewIndex.giftCard.giftCardValueStorage.replace(_.first(u),i),r=n.giftCerValueId,document.getElementById(r).click(),f=$(document.getElementById(r).dataset),e=_.first(f).slickIndex,$(".center-slick").slick("slickGoTo",e,!0))}function SetNewCustomDiscountAdd(n,t){var i=new DataCustomDiscountViewModel({refGiftCardValueId:n.refGiftCerValueId,giftCerCustomDiscountId:n.giftCerCustomDiscountId,discountValueName:n.discountValueName,discountName:n.discountName,discountDesc:n.discountDesc,min:n.min,max:n.max,allDate:n.allDate,startDate:n.startDate,endDate:n.endDate,allTime:n.allTime,startTime:n.startTime,endTime:n.endTime,isCustomDiscountAmount:n.isCustomDiscountAmount,isCustomDiscountPercent:n.isCustomDiscountPercent,amountOff:n.amountOff,percentOff:n.percentOff,active:n.active,refGiftCerValueActive:n.refGiftCerValueActive}),u=ko.utils.arrayFilter(vmViewIndex.giftCard.giftCardValueStorage(),function(n){return n.giftCerValueId()==i.refGiftCardValueId()}),r=new DataGiftCardValueViewModel({giftCerValueId:i.refGiftCardValueId(),giftCerValueName:"Custom",getAmount:0,payAmount:0,isDiscountAmount:!1,isDiscountPercent:!1,discountAmount:0,discountPercent:0,getAsPay:!0,activateOnly:!0,active:i.refGiftCerValueActive()}),e,f,o,s;t==statusAdd?(vmViewIndex.giftCard.customDiscountStorage.push(i),u.length<=0?(vmViewIndex.giftCard.giftCardValueStorage.push(r),vmViewIndex.giftCard.addGiftCard.haveDiscountData(!0),vmViewIndex.giftCard.addGiftCard.refGiftCardValueId(r.giftCerValueId())):vmViewIndex.giftCard.giftCardValueStorage.replace(_.first(u),r)):(e=ko.utils.arrayFilter(vmViewIndex.giftCard.customDiscountStorage(),function(n){return n.giftCerCustomDiscountId()==i.giftCerCustomDiscountId()}),vmViewIndex.giftCard.customDiscountStorage.replace(_.first(e),i),vmViewIndex.giftCard.giftCardValueStorage.replace(_.first(u),r),f=n.refGiftCerValueId,document.getElementById(f).click(),o=$(document.getElementById(f).dataset),s=_.first(o).slickIndex,$(".center-slick").slick("slickGoTo",s,!0));$(cModalShowAddNewCustomDiscount).modal("hide")}function setTab(n,t,i){$(t.target).next("label").addClass("theme default-background-color-dark force");$(".owner-tabs-wrapper").find(".tab-body").each(function(){$(this).data("id")==i?($(this).css("opacity",1),$(this).css("position","relative"),$(this).show(),typeof n.foodSetId!="undefined"&&(vmViewIndex.menu.selectFoodSetId(n.foodSetId()),vmViewIndex.menu.selectFoodSetName(n.foodSetName()),vmViewIndex.menu.selectFoodSetActive(n.active()),vmViewIndex.menu.selectFoodSetSorting(n.foodSetSorting()),vmViewIndex.menu.selectFoodSetIsThirdParty(n.isThirdParty()),DataShowTimeViewModel(vmViewIndex.menu.tempDataShowTime()))):($(this).css("opacity",0),$(this).css("position","absolute"),$(this).hide())})}function afterUpdateDeliveryFreeTime(n){n.shopMapCode=="0"?n.mapZoneID==vmViewIndex.allMapZone.mapZone1Id()?(vmViewIndex.allMapZone.deliveryFreeTimeIdDrawMapZone1(n.deliveryFreeTimeID),vmViewIndex.allMapZone.mapZoneIdDrawMapZone1(n.mapZoneID),vmViewIndex.allMapZone.valShopMapCodeDrawMapZone1(n.shopMapCode),vmViewIndex.allMapZone.valStartTimeDrawMapZone1(moment(n.startTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.valEndTimeDrawMapZone1(moment(n.endTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.activeDeliveryFreeTimeDrawMapZone1(n.active)):n.mapZoneID==vmViewIndex.allMapZone.mapZone2Id()?(vmViewIndex.allMapZone.deliveryFreeTimeIdDrawMapZone2(n.deliveryFreeTimeID),vmViewIndex.allMapZone.mapZoneIdDrawMapZone2(n.mapZoneID),vmViewIndex.allMapZone.valShopMapCodeDrawMapZone2(n.shopMapCode),vmViewIndex.allMapZone.valStartTimeDrawMapZone2(moment(n.startTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.valEndTimeDrawMapZone2(moment(n.endTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.activeDeliveryFreeTimeDrawMapZone2(n.active)):n.mapZoneID==vmViewIndex.allMapZone.mapZone3Id()&&(vmViewIndex.allMapZone.deliveryFreeTimeIdDrawMapZone3(n.deliveryFreeTimeID),vmViewIndex.allMapZone.mapZoneIdDrawMapZone3(n.mapZoneID),vmViewIndex.allMapZone.valShopMapCodeDrawMapZone3(n.shopMapCode),vmViewIndex.allMapZone.valStartTimeDrawMapZone3(moment(n.startTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.valEndTimeDrawMapZone3(moment(n.endTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.activeDeliveryFreeTimeDrawMapZone3(n.active)):n.shopMapCode=="1"&&(n.mapZoneID==vmViewIndex.allMapZone.mapZone1Id()?(vmViewIndex.allMapZone.deliveryFreeTimeIdSetMileZone1(n.deliveryFreeTimeID),vmViewIndex.allMapZone.mapZoneIdSetMileZone1(n.mapZoneID),vmViewIndex.allMapZone.valShopMapCodeSetMileZone1(n.shopMapCode),vmViewIndex.allMapZone.valStartTimeSetMileZone1(moment(n.startTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.valEndTimeSetMileZone1(moment(n.endTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.activeDeliveryFreeTimeSetMileZone1(n.active)):n.mapZoneID==vmViewIndex.allMapZone.mapZone2Id()?(vmViewIndex.allMapZone.deliveryFreeTimeIdSetMileZone2(n.deliveryFreeTimeID),vmViewIndex.allMapZone.mapZoneIdSetMileZone2(n.mapZoneID),vmViewIndex.allMapZone.valShopMapCodeSetMileZone2(n.shopMapCode),vmViewIndex.allMapZone.valStartTimeSetMileZone2(moment(n.startTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.valEndTimeSetMileZone2(moment(n.endTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.activeDeliveryFreeTimeSetMileZone2(n.active)):n.mapZoneID==vmViewIndex.allMapZone.mapZone3Id()&&(vmViewIndex.allMapZone.deliveryFreeTimeIdSetMileZone3(n.deliveryFreeTimeID),vmViewIndex.allMapZone.mapZoneIdSetMileZone3(n.mapZoneID),vmViewIndex.allMapZone.valShopMapCodeSetMileZone3(n.shopMapCode),vmViewIndex.allMapZone.valStartTimeSetMileZone3(moment(n.startTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.valEndTimeSetMileZone3(moment(n.endTime,moment_time_format_hhmmss)),vmViewIndex.allMapZone.activeDeliveryFreeTimeSetMileZone3(n.active)));vmViewIndex.allMapZone.editDeliveryFreeTimeID(n.deliveryFreeTimeID);vmViewIndex.allMapZone.editMapZoneID(n.mapZoneID);vmViewIndex.allMapZone.editShopMapCode(n.shopMapCode);vmViewIndex.allMapZone.editStartTime(n.startTime);vmViewIndex.allMapZone.editEndTime(n.endTime);vmViewIndex.allMapZone.editActiveDeliveryFreeTime(n.active)}function setUpdateMapZoneMile(n){var i=parseInt(vmViewIndex.allMapZone.tempCustomMileZone()),t=n[i-1];parseFloat(t.startMile)==0&&parseFloat(t.endMile)==0&&(vmViewIndex.allMapZone.tempActiveCustomMile(!0),vmViewIndex.allMapZone.tempCustomMileZone("1"),vmViewIndex.allMapZone.tempListValueCustom([]))}function setCouponDelivery(n,t){var i=new DataCouponDeliveryUpdate(n),r;t==statusAdd?vmViewIndex.allSetting.CouponDeliveryData.push(i):(r=ko.utils.arrayFilter(vmViewIndex.allSetting.CouponDeliveryData(),function(n){return n.couponDeliveryId()==i.couponDeliveryId()}),vmViewIndex.allSetting.CouponDeliveryData.replace(_.first(r),i));$("#modalSetupCouponDelivery").modal("hide");vmViewIndex.allSetting.dataViewModelCouponDelivery.clearSetUp()}function setDiscount(n,t){var i=new DataDiscountSetUpViewModel(n),r;t==statusAdd?vmViewIndex.allSetting.data.push(i):(r=ko.utils.arrayFilter(vmViewIndex.allSetting.data(),function(n){return n.discountId()==i.discountId()}),vmViewIndex.allSetting.data.replace(_.first(r),i));$("#modalSetUpDiscount").modal("hide");vmViewIndex.allSetting.dataSetUpModal.btnCloseSetUpDiscount()}function setDiscountOneTimeUse(n,t){var r=new DataDiscountOneTimeUseSetUpViewModel(n),f,u,e,i,o,s;t==statusAdd?vmViewIndex.allSetting.dataDiscountOneTimeUse.push(r):(f=ko.utils.arrayFilter(vmViewIndex.allSetting.dataDiscountOneTimeUse(),function(n){return n.discountOneTimeUseId()==r.discountOneTimeUseId()}),vmViewIndex.allSetting.dataDiscountOneTimeUse.replace(_.first(f),r));u=_.sortBy(vmViewIndex.allSetting.dataDiscountOneTimeUse(),[function(n){return n.group()}]);vmViewIndex.allSetting.dataDiscountOneTimeUse(u);e=_.groupBy(u,function(n){return n.group()});i=[];i.push({id:0,value:"Create New"});_.forEach(e,function(n,t){i.push({id:parseInt(t),value:t})});vmViewIndex.allSetting.discountGroup(i.slice(0));o=ko.utils.arrayFilter(i,function(n){return n.id!=0});vmViewIndex.allSetting.groupDiscountDownload(i.slice(0));vmViewIndex.allSetting.group(_.first(vmViewIndex.allSetting.groupDiscountDownload()).id);vmViewIndex.allSetting.groupDiscountFilter(o.slice(0));vmViewIndex.allSetting.groupDiscountFilterSelect(r.group());s=ko.utils.arrayFilter(vmViewIndex.allSetting.dataDiscountOneTimeUse(),function(n){return n.group()==vmViewIndex.allSetting.groupDiscountFilterSelect()});vmViewIndex.allSetting.dataSourceDiscountOneTimeUse(s.slice(0));refreshGrid("gridDiscountOneTimeUse");$("#modalSetUpDiscountOneTimeUse").modal("hide");vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.btnCloseSetUpDiscountOneTimeUse()}function setUploadDiscountOneTimeUse(n){var i=_.first(n).group,u=ko.utils.arrayFilter(vmViewIndex.allSetting.dataDiscountOneTimeUse(),function(n){return n.group()!=i}),r,t,f;ko.utils.arrayForEach(n,function(n){u.push(new DataDiscountOneTimeUseSetUpViewModel(n))});r=_.sortBy(u,[function(n){return n.group()}]);vmViewIndex.allSetting.dataDiscountOneTimeUse(r);i=_.groupBy(r,function(n){return n.group()});t=[];t.push({id:0,value:"Create New"});_.forEach(i,function(n,i){t.push({id:parseInt(i),value:i})});vmViewIndex.allSetting.discountGroup(t.slice(0));f=ko.utils.arrayFilter(t,function(n){return n.id!=0});vmViewIndex.allSetting.groupDiscountDownload(t.slice(0));vmViewIndex.allSetting.group(_.first(vmViewIndex.allSetting.groupDiscountDownload()).id);vmViewIndex.allSetting.groupDiscountFilter(f.slice(0));vmViewIndex.allSetting.groupDiscountFilterSelect(_.first(vmViewIndex.allSetting.groupDiscountFilter()).id);$("#modalShowDiscountOneTimeUse").modal("hide");$("#uploadAnnounceImage").val("")}function setAutoCharge(n,t){var i=new DataAutoChargeViewModel(n),r;t==statusAdd?vmViewIndex.allSetting.dataAutoCharge.push(i):(r=ko.utils.arrayFilter(vmViewIndex.allSetting.dataAutoCharge(),function(n){return n.autoChargeId()==i.autoChargeId()}),vmViewIndex.allSetting.dataAutoCharge.replace(_.first(r),i));$("#modalSetUpAutoCharge").modal("hide");vmViewIndex.allSetting.dataSetUpModalAutoCharge.clearSetUpAutoCharge()}function setPaymentFee(n,t){var i=new DataPaymentFeeViewModel(n),r;t==statusAdd?vmViewIndex.allSetting.dataPaymentFee.push(i):(r=ko.utils.arrayFilter(vmViewIndex.allSetting.dataPaymentFee(),function(n){return n.paymentFeeId()==i.paymentFeeId()}),vmViewIndex.allSetting.dataPaymentFee.replace(_.first(r),i));$("#modalSetUpPaymentFee").modal("hide");vmViewIndex.allSetting.dataSetUpModalPaymentFee.clearSetUpPaymentFee()}function setHoliday(n,t){var i=new DataHolidayViewModel(n),r;t==statusAdd?vmViewIndex.allSetting.dataHoliday.push(i):(r=ko.utils.arrayFilter(vmViewIndex.allSetting.dataHoliday(),function(n){return n.holidayId()==i.holidayId()}),vmViewIndex.allSetting.dataHoliday.replace(_.first(r),i));$("#modalSetUpHoliday").modal("hide");vmViewIndex.allSetting.dataSetUpModalHoliday.clearSetUpHoliday()}function setShopClose(n,t){var u=_.first(n),i=new DataShopCloseViewModel(n),r;t==statusAdd?vmViewIndex.allSetting.dataShopClose.push(i):(r=ko.utils.arrayFilter(vmViewIndex.allSetting.dataShopClose(),function(n){return n.time()[0].shopCloseId()==u.shopCloseIdFirst}),vmViewIndex.allSetting.dataShopClose.replace(_.first(r),i));$("#modalSetUpShopClose").modal("hide");vmViewIndex.allSetting.dataSetUpModalShopClose.clearSetUpShopClose()}function setMainPrice(n,t){var i=new DataMainPriceViewModel(n),r;t==statusAdd?vmViewIndex.allSetting.dataMainPrice.push(i):(r=ko.utils.arrayFilter(vmViewIndex.allSetting.dataMainPrice(),function(n){return n.promotionMainPriceId()==i.promotionMainPriceId()}),vmViewIndex.allSetting.dataMainPrice.replace(_.first(r),i));$("#modalMainPriceSetup").modal("hide");vmViewIndex.allSetting.dataSetUpMainPrice.clearSetUpMainPrice()}function setGrpMainFood(n,t){var i=new DataGroupMainFoodViewModel(n),r;t==statusAdd?vmViewIndex.allSetting.dataGroupMainFood.push(i):(r=ko.utils.arrayFilter(vmViewIndex.allSetting.dataGroupMainFood(),function(n){return n.promotionGroupMainFoodId()==i.promotionGroupMainFoodId()}),vmViewIndex.allSetting.dataGroupMainFood.replace(_.first(r),i));$("#modalGroupMainFoodSetup").modal("hide");vmViewIndex.allSetting.dataSetUpGroupMainFood.clearSetUpGroupMainFood()}function setGrpFreeFood(n,t){var i=new DataGroupFreeFoodViewModel(n),r;t==statusAdd?vmViewIndex.allSetting.dataGroupFreeFood.push(i):(r=ko.utils.arrayFilter(vmViewIndex.allSetting.dataGroupFreeFood(),function(n){return n.promotionGroupFreeFoodId()==i.promotionGroupFreeFoodId()}),vmViewIndex.allSetting.dataGroupFreeFood.replace(_.first(r),i));$("#modalGroupFreeFoodSetup").modal("hide");vmViewIndex.allSetting.dataSetUpGroupFreeFood.clearSetUpGroupFreeFood()}function setCondition(n,t){var i,r;n.promotionTypeId==cConditionPrice?(i=new DataConditionViewModel(n,!0),t==statusAdd?vmViewIndex.allSetting.dataConditionMainPrice.push(i):(r=ko.utils.arrayFilter(vmViewIndex.allSetting.dataConditionMainPrice(),function(n){return n.promotionId()==i.promotionId()}),vmViewIndex.allSetting.dataConditionMainPrice.replace(_.first(r),i))):(i=new DataConditionViewModel(n,!1),t==statusAdd?vmViewIndex.allSetting.dataConditionMainFood.push(i):(r=ko.utils.arrayFilter(vmViewIndex.allSetting.dataConditionMainFood(),function(n){return n.promotionId()==i.promotionId()}),vmViewIndex.allSetting.dataConditionMainFood.replace(_.first(r),i)));$("#modalConditionSetup").modal("hide");vmViewIndex.allSetting.dataSetUpCondition.clearSetUpCondition()}function setUpdateCustomMapZoneMile(n){ko.mapping.fromJS(n.active,{},vmViewIndex.allMapZone.tempActiveCustomMile);ko.mapping.fromJS(n.mapZoneId,{},vmViewIndex.allMapZone.tempCustomMileZone);ko.mapping.fromJS(n.listCustomMile,{},vmViewIndex.allMapZone.tempListValueCustom);n.mapZoneId=="1"?(vmViewIndex.allMapZone.listMapZoneMile()[1].startMile(0),vmViewIndex.allMapZone.listMapZoneMile()[1].endMile(0),vmViewIndex.allMapZone.listMapZoneMile()[1].price(0),vmViewIndex.allMapZone.listMapZoneMile()[2].startMile(0),vmViewIndex.allMapZone.listMapZoneMile()[2].endMile(0),vmViewIndex.allMapZone.listMapZoneMile()[2].price(0)):n.mapZoneId=="2"&&(vmViewIndex.allMapZone.listMapZoneMile()[2].startMile(0),vmViewIndex.allMapZone.listMapZoneMile()[2].endMile(0),vmViewIndex.allMapZone.listMapZoneMile()[2].price(0));$("#modalCustomMapZoneMile").modal("hide")}function getDataJs(){ko.mapping.fromJSON(vmViewIndex.menu.foodSetJs(),{},vmViewIndex.menu.foodSet);ko.mapping.fromJSON(vmViewIndex.menu.foodCategoryJs(),{},vmViewIndex.menu.foodCategory);ko.mapping.fromJSON(vmViewIndex.menu.foodJs(),{},vmViewIndex.menu.food)}function setFoodSet(n,t){var i,s,h,c,l,u,o,r;if(t==statusAdd)i=new DataFoodSetViewModel(n),vmViewIndex.menu.foodSetJs.push(n),vmViewIndex.menu.foodSet.push(i),i.isThirdParty()?vmViewIndex.menu.optionSelectPickerFoodSetThirdParty.push(new optionSelectFoodSet(i.foodSetId(),i.foodSetName())):vmViewIndex.menu.optionSelectPickerFoodSet.push(new optionSelectFoodSet(i.foodSetId(),i.foodSetName())),vmViewIndex.menu.dataMenu.push(new DataMenuViewModel(i,"",[])),vmViewIndex.menu.selectFoodSetId(i.foodSetId()),vmViewIndex.menu.selectFoodSetName(i.foodSetName()),vmViewIndex.menu.selectFoodSetSorting(i.foodSetSorting()),vmViewIndex.menu.selectFoodSetActive(i.active()),vmViewIndex.menu.selectFoodSetIsThirdParty(i.isThirdParty());else if(i=new DataFoodSetViewModel(_.first(n.listFoodSet)),s=ko.utils.arrayFilter(vmViewIndex.menu.foodSetJs(),function(t){return t.foodSetId==n.foodSetId}),isEmpty(s)||vmViewIndex.menu.foodSetJs.replace(_.first(s),n),h=ko.utils.arrayFilter(vmViewIndex.menu.foodSet(),function(n){return n.foodSetId()==i.foodSetId()}),isEmpty(h)||vmViewIndex.menu.foodSet.replace(_.first(h),i),c=ko.utils.arrayFilter(vmViewIndex.menu.optionSelectPickerFoodSet(),function(n){return n.foodSetId()==i.foodSetId()}),isEmpty(c)||vmViewIndex.menu.optionSelectPickerFoodSet.replace(_.first(c),new optionSelectFoodSet(i.foodSetId(),i.foodSetName())),l=ko.utils.arrayFilter(vmViewIndex.menu.optionSelectPickerFoodSetThirdParty(),function(n){return n.foodSetId()==i.foodSetId()}),isEmpty(l)||vmViewIndex.menu.optionSelectPickerFoodSetThirdParty.replace(_.first(l),new optionSelectFoodSet(i.foodSetId(),i.foodSetName())),ko.utils.arrayForEach(vmViewIndex.menu.dataMenu(),function(n){n.foodSet.foodSetId()==i.foodSetId()&&(n.foodSet=i)}),vmViewIndex.menu.selectFoodSetId(i.foodSetId()),vmViewIndex.menu.selectFoodSetName(i.foodSetName()),vmViewIndex.menu.selectFoodSetSorting(i.foodSetSorting()),vmViewIndex.menu.selectFoodSetActive(i.active()),vmViewIndex.menu.selectFoodSetIsThirdParty(i.isThirdParty()),n.listFoodSet.length>1){var a=ko.observableArray([]),v=ko.observableArray([]),f=n.listFood,y=n.groupChoiceOptionId,e=n.listFoodChoiceMap;if(ko.utils.arrayForEach(f,function(n){var t=n.productId.split(",");n.arrProduct=[];ko.utils.arrayForEach(t,function(t){n.arrProduct.push(t)})}),ko.mapping.fromJS(f,{},v),ko.utils.arrayForEach(v(),function(n){vmViewIndex.menu.foodJs.push(f);vmViewIndex.menu.food.push(n);vmViewIndex.menu.optionSelectPickerCopyFood.push(new optionSelectFood(n.foodId(),n.foodName()))}),ko.utils.arrayForEach(vmViewIndex.menu.foodSet(),function(n){ko.utils.arrayForEach(vmViewIndex.menu.foodCategory(),function(t){var i=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(i){return i.foodCatId()==t.foodCatId()&&i.foodSetId()==n.foodSetId()});isEmpty(i)||a.push(new DataMenuViewModel(n,t,i))})}),vmViewIndex.menu.dataMenu(a().slice()),e.length>0&&!isEmpty(e)){for(u=0;u<e.length;u++)o=ko.utils.arrayFilter(vmViewIndex.menu.foodChoiceMap(),function(n){return n.foodId()==e[u].foodId}),vmViewIndex.menu.foodChoiceMap.removeAll(o),vmViewIndex.menu.choiceOptions.removeAll();ko.utils.arrayForEach(e,function(n){vmViewIndex.menu.foodChoiceMap.push(new DataFoodChoiceMapViewModel(n))})}else for(u=0;u<f.length;u++)o=ko.utils.arrayFilter(vmViewIndex.menu.foodChoiceMap(),function(n){return n.foodId()==f[u].foodId}),vmViewIndex.menu.foodChoiceMap.removeAll(o);ko.utils.arrayForEach(y,function(n){var t=ko.utils.arrayFilter(vmViewIndex.menu.dataSetupFoodModal.groupChoiceOptionId(),function(t){return n==t});t.length==0&&vmViewIndex.menu.dataSetupFoodModal.groupChoiceOptionId.push(n)});r=new DataFoodSetViewModel(n.listFoodSet[1]);vmViewIndex.menu.foodSetJs.push(n.listFoodSet[1]);vmViewIndex.menu.foodSet.push(r);r.isThirdParty()?vmViewIndex.menu.optionSelectPickerFoodSetThirdParty.push(new optionSelectFoodSet(r.foodSetId(),r.foodSetName())):vmViewIndex.menu.optionSelectPickerFoodSet.push(new optionSelectFoodSet(r.foodSetId(),r.foodSetName()));vmViewIndex.menu.dataMenu.push(new DataMenuViewModel(r,"",[]));vmViewIndex.menu.selectFoodSetId(r.foodSetId());vmViewIndex.menu.selectFoodSetName(r.foodSetName());vmViewIndex.menu.selectFoodSetSorting(r.foodSetSorting());vmViewIndex.menu.selectFoodSetActive(r.active());vmViewIndex.menu.selectFoodSetIsThirdParty(r.isThirdParty());_.forEach(n.listFoodCategory,function(n){var i=ko.observableArray([]),t=new DataFoodCategoryViewModel(n);vmViewIndex.menu.foodCategoryJs.push(n);vmViewIndex.menu.foodCategory.push(t);vmViewIndex.menu.tempDataFoodCategory.push(new optionSelectFoodCategory(t.foodCatId(),t.foodCatName(),r.foodSetId()));ko.utils.arrayForEach(vmViewIndex.menu.foodSet(),function(n){ko.utils.arrayForEach(vmViewIndex.menu.foodCategory(),function(t){var r=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(i){return i.foodCatId()==t.foodCatId()&&i.foodSetId()==n.foodSetId()});isEmpty(r)||i.push(new DataMenuViewModel(n,t,r))})});vmViewIndex.menu.dataMenu(i().slice())})}$("#modalSetupFoodSet").modal("hide");foodSetClick();vmViewIndex.menu.dataSetupFoodSetModal.clearSetupFoodSet()}function setFoodCategory(n,t,i){var f=ko.observableArray([]),r=new DataFoodCategoryViewModel(n),h=document.documentElement.scrollTop,u,o,s,e;i==statusAdd?(u=new DataFoodViewModel(t),u.arrProduct(u.productId().split(",")),vmViewIndex.menu.foodCategoryJs.push(n),vmViewIndex.menu.foodCategory.push(r),vmViewIndex.menu.foodJs.push(t),vmViewIndex.menu.food.push(u),vmViewIndex.menu.tempDataFoodCategory.push(new optionSelectFoodCategory(r.foodCatId(),r.foodCatName(),u.foodSetId())),ko.utils.arrayForEach(vmViewIndex.menu.foodSet(),function(n){ko.utils.arrayForEach(vmViewIndex.menu.foodCategory(),function(t){var i=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(i){return i.foodCatId()==t.foodCatId()&&i.foodSetId()==n.foodSetId()});isEmpty(i)||f.push(new DataMenuViewModel(n,t,i))})}),vmViewIndex.menu.dataMenu(f().slice())):(o=ko.utils.arrayFilter(vmViewIndex.menu.foodCategoryJs(),function(t){return t.foodCatId==n.foodCatId}),isEmpty(o)||vmViewIndex.menu.foodCategoryJs.replace(_.first(o),n),s=ko.utils.arrayFilter(vmViewIndex.menu.foodCategory(),function(n){return n.foodCatId()==r.foodCatId()}),isEmpty(s)||vmViewIndex.menu.foodCategory.replace(_.first(s),r),e=ko.utils.arrayFilter(vmViewIndex.menu.tempDataFoodCategory(),function(n){return n.foodCatId()==r.foodCatId()}),isEmpty(e)||vmViewIndex.menu.tempDataFoodCategory.replace(_.first(e),new optionSelectFoodCategory(r.foodCatId(),r.foodCatName(),_.first(e).foodSetId())),vmViewIndex.menu.optionSelectPickerFoodCategory(vmViewIndex.menu.tempDataFoodCategory()),ko.utils.arrayForEach(vmViewIndex.menu.foodSet(),function(n){ko.utils.arrayForEach(vmViewIndex.menu.foodCategory(),function(t){var i=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(i){return i.foodCatId()==t.foodCatId()&&i.foodSetId()==n.foodSetId()});isEmpty(i)||f.push(new DataMenuViewModel(n,t,i))})}),vmViewIndex.menu.dataMenu(f().slice()));document.documentElement.scrollTop=h;$("#modalSetupFoodCategory").modal("hide");foodSetClick();vmViewIndex.menu.dataSetupFoodCategoryModal.clearSetupFoodCategory()}function setFoodImage(n){var e=ko.observableArray([]),u=new DataFoodViewModel(n),f=document.documentElement.scrollTop,i=ko.utils.arrayFilter(vmViewIndex.menu.foodJs(),function(t){return t.foodId==n.foodId}),r,t;isEmpty(i)||vmViewIndex.menu.foodJs.replace(_.first(i),n);t=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(t){return t.foodId()==n.foodId});isEmpty(t)||vmViewIndex.menu.food.replace(_.first(t),u);r=ko.utils.arrayFilter(vmViewIndex.menu.dataMenu(),function(t){return t.foodSet.foodSetId()==n.foodSetId&&t.foodCategory.foodCatId()==n.foodCatId});t=ko.utils.arrayFilter(_.first(r).food,function(t){return t.foodId()==n.foodId});_.first(t).image(n.image);_.first(t).imageThirdParty("");document.documentElement.scrollTop=f;foodSetClick()}function setFoodCustomImage(n){var r,t;n.imageName!=""&&(n.imageName=cPathFileBase+n.imageName);var f=ko.observableArray([]),u=new DataFoodViewModel(n),i=ko.utils.arrayFilter(vmViewIndex.menu.foodJs(),function(t){return t.foodId==n.foodId});isEmpty(i)||(_.first(i).image=n.imageName);t=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(t){return t.foodId()==n.foodId});isEmpty(t)||_.first(t).image(u.image());r=ko.utils.arrayFilter(vmViewIndex.menu.dataMenu(),function(t){return t.foodSet.foodSetId()==n.foodSetId&&t.foodCategory.foodCatId()==n.foodCatId});t=ko.utils.arrayFilter(_.first(r).food,function(t){return t.foodId()==n.foodId});_.first(t).image(n.imageName);$("#modalSetUpFoodImage").modal("hide")}function setFood(n,t,i,r,u){var o=ko.observableArray([]),e=new DataFoodViewModel(n),y=document.documentElement.scrollTop,p=n.productId.split(","),s,h,c,f,v,l,a;n.arrProduct=[];ko.utils.arrayForEach(p,function(t){n.arrProduct.push(t)});e.arrProduct(n.productId.split(","));u==statusAdd?(vmViewIndex.menu.foodJs.push(n),vmViewIndex.menu.food.push(e),vmViewIndex.menu.optionSelectPickerCopyFood.push(new optionSelectFood(e.foodId(),e.foodName())),ko.utils.arrayForEach(vmViewIndex.menu.foodSet(),function(n){ko.utils.arrayForEach(vmViewIndex.menu.foodCategory(),function(t){var i=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(i){return i.foodCatId()==t.foodCatId()&&i.foodSetId()==n.foodSetId()});isEmpty(i)||o.push(new DataMenuViewModel(n,t,i))})}),vmViewIndex.menu.dataMenu(o().slice()),i.length>0?(f=ko.utils.arrayFilter(vmViewIndex.menu.foodChoiceMap(),function(n){return n.foodId()==_.first(i).foodId}),f.length>0&&vmViewIndex.menu.foodChoiceMap.removeAll(f),vmViewIndex.menu.choiceOptions.removeAll(),ko.utils.arrayForEach(i,function(n){vmViewIndex.menu.foodChoiceMap.push(new DataFoodChoiceMapViewModel(n))})):(f=ko.utils.arrayFilter(vmViewIndex.menu.foodChoiceMap(),function(t){return t.foodId()==n.foodId}),f.length>0&&vmViewIndex.menu.foodChoiceMap.removeAll(f)),ko.utils.arrayForEach(t,function(n){var t=ko.utils.arrayFilter(vmViewIndex.menu.dataSetupFoodModal.groupChoiceOptionId(),function(t){return n==t});t.length==0&&vmViewIndex.menu.dataSetupFoodModal.groupChoiceOptionId.push(n)})):(s=ko.utils.arrayFilter(vmViewIndex.menu.foodJs(),function(t){return t.foodId==n.foodId}),isEmpty(s)||vmViewIndex.menu.foodJs.replace(_.first(s),n),h=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(n){return n.foodId()==e.foodId()}),isEmpty(h)||vmViewIndex.menu.food.replace(_.first(h),e),c=ko.utils.arrayFilter(vmViewIndex.menu.optionSelectPickerCopyFood(),function(n){return n.foodId()==e.foodId()}),isEmpty(c)||vmViewIndex.menu.optionSelectPickerCopyFood.replace(_.first(c),new optionSelectFood(e.foodId(),e.foodName())),ko.utils.arrayForEach(vmViewIndex.menu.foodSet(),function(n){ko.utils.arrayForEach(vmViewIndex.menu.foodCategory(),function(t){var i=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(i){return i.foodCatId()==t.foodCatId()&&i.foodSetId()==n.foodSetId()});isEmpty(i)||o.push(new DataMenuViewModel(n,t,i))})}),vmViewIndex.menu.dataMenu(o().slice()),i.length>0?(f=ko.utils.arrayFilter(vmViewIndex.menu.foodChoiceMap(),function(n){return n.foodId()==_.first(i).foodId}),f.length>0&&vmViewIndex.menu.foodChoiceMap.removeAll(f),vmViewIndex.menu.choiceOptions.removeAll(),ko.utils.arrayForEach(i,function(n){vmViewIndex.menu.foodChoiceMap.push(new DataFoodChoiceMapViewModel(n))})):(f=ko.utils.arrayFilter(vmViewIndex.menu.foodChoiceMap(),function(t){return t.foodId()==n.foodId}),f.length>0&&vmViewIndex.menu.foodChoiceMap.removeAll(f)),ko.utils.arrayForEach(t,function(n){var t=ko.utils.arrayFilter(vmViewIndex.menu.dataSetupFoodModal.groupChoiceOptionId(),function(t){return n==t});t.length==0&&vmViewIndex.menu.dataSetupFoodModal.groupChoiceOptionId.push(n)}),n.isThirdParty&&(v=ko.utils.arrayFilter(vmViewIndex.menu.listFoodThirdPartyStore(),function(n){return n.foodBaseId()==n.foodId}),vmViewIndex.menu.listFoodThirdPartyStore.removeAll(v)),l=ko.utils.arrayFilter(vmViewIndex.menu.listFoodIconMap(),function(t){return t.foodId()==n.foodId}),l.length>0&&vmViewIndex.menu.listFoodIconMap.removeAll(l));r.length>0&&(a=ko.observableArray([]),ko.mapping.fromJS(r,{},a),ko.utils.arrayForEach(a(),function(n){vmViewIndex.menu.listFoodIconMap.push(n)}));document.documentElement.scrollTop=y;$("#modalSetupFood").modal("hide");foodSetClick();vmViewIndex.menu.dataSetupFoodModal.clearSetupFood()}function setCopyFood(n,t,i,r){var o=ko.observableArray([]),s=ko.observableArray([]),h=document.documentElement.scrollTop,u,f,e;if(ko.utils.arrayForEach(n,function(n){var t=n.productId.split(",");n.arrProduct=[];ko.utils.arrayForEach(t,function(t){n.arrProduct.push(t)});vmViewIndex.menu.foodJs.push(n)}),ko.mapping.fromJS(n,{},s),ko.utils.arrayForEach(s(),function(n){vmViewIndex.menu.food.push(n);vmViewIndex.menu.optionSelectPickerCopyFood.push(new optionSelectFood(n.foodId(),n.foodName()))}),ko.utils.arrayForEach(vmViewIndex.menu.foodSet(),function(n){ko.utils.arrayForEach(vmViewIndex.menu.foodCategory(),function(t){var i=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(i){return i.foodCatId()==t.foodCatId()&&i.foodSetId()==n.foodSetId()});isEmpty(i)||o.push(new DataMenuViewModel(n,t,i))})}),vmViewIndex.menu.dataMenu(o().slice()),i.length>0&&!isEmpty(i)){for(u=0;u<i.length;u++)f=ko.utils.arrayFilter(vmViewIndex.menu.foodChoiceMap(),function(n){return n.foodId()==i[u].foodId}),vmViewIndex.menu.foodChoiceMap.removeAll(f),vmViewIndex.menu.choiceOptions.removeAll();ko.utils.arrayForEach(i,function(n){vmViewIndex.menu.foodChoiceMap.push(new DataFoodChoiceMapViewModel(n))})}else for(u=0;u<n.length;u++)f=ko.utils.arrayFilter(vmViewIndex.menu.foodChoiceMap(),function(t){return t.foodId()==n[u].foodId}),vmViewIndex.menu.foodChoiceMap.removeAll(f);ko.utils.arrayForEach(t,function(n){var t=ko.utils.arrayFilter(vmViewIndex.menu.dataSetupFoodModal.groupChoiceOptionId(),function(t){return n==t});t.length==0&&vmViewIndex.menu.dataSetupFoodModal.groupChoiceOptionId.push(n)});r.length>0&&(e=ko.observableArray([]),ko.mapping.fromJS(r,{},e),ko.utils.arrayForEach(e(),function(n){vmViewIndex.menu.listFoodIconMap.push(n)}));clearCopyFood();vmViewIndex.showLoading(!1);document.documentElement.scrollTop=h;foodSetClick()}function setFoodThirdParty(n){var t=n.listFood,o=n.listFoodChoiceMap,b=n.groupChoiceOptionId,k=n.listThirdPartyGroup,h,l,u,w,a,e,v,r,y,f,i,s,p;if(t.length==1){u=_.first(t).foodId;ko.utils.arrayForEach(t,function(n){var t=n.productId.split(",");n.arrProduct=[];ko.utils.arrayForEach(t,function(t){n.arrProduct.push(t)})});f=ko.observableArray([]);h=ko.observableArray([]);ko.mapping.fromJS(t,{},h);var d=_.first(t),c=_.first(h()),g=new optionSelectFood(c.foodId(),c.foodName()),e=ko.utils.arrayFilter(vmViewIndex.menu.foodJs(),function(n){return n.foodId==u});e.length>0&&vmViewIndex.menu.foodJs.replace(_.first(e),d);r=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(n){return n.foodId()==u});r.length>0&&vmViewIndex.menu.food.replace(_.first(r),c);l=ko.utils.arrayFilter(vmViewIndex.menu.optionSelectPickerCopyFood(),function(n){return n.foodId()==u});l.length>0&&vmViewIndex.menu.optionSelectPickerCopyFood.replace(_.first(l),g);ko.utils.arrayForEach(vmViewIndex.menu.foodSet(),function(n){ko.utils.arrayForEach(vmViewIndex.menu.foodCategory(),function(t){var i=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(i){return i.foodCatId()==t.foodCatId()&&i.foodSetId()==n.foodSetId()});isEmpty(i)||f.push(new DataMenuViewModel(n,t,i))})});vmViewIndex.menu.dataMenu(f().slice())}else u=_.first(t).foodBaseId,w=ko.utils.arrayFilter(vmViewIndex.menu.listFoodThirdPartyStore(),function(n){return n.foodBaseId()==u}),vmViewIndex.menu.listFoodThirdPartyStore.removeAll(w),ko.utils.arrayForEach(t,function(n){vmViewIndex.menu.listFoodThirdPartyStore.push(new DataFoodViewModel(n))}),a=_.first(t).foodBaseId,e=ko.utils.arrayFilter(vmViewIndex.menu.foodJs(),function(n){return n.foodId==a}),isEmpty(e)||(v=_.first(e.slice(0)),v.isThirdParty=!1,vmViewIndex.menu.foodJs.replace(_.first(e),v)),r=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(n){return n.foodId()==a}),isEmpty(r)||(y=_.first(r.slice(0)),y.isThirdParty(!1),vmViewIndex.menu.food.replace(_.first(r),y)),f=ko.observableArray([]),ko.utils.arrayForEach(vmViewIndex.menu.foodSet(),function(n){ko.utils.arrayForEach(vmViewIndex.menu.foodCategory(),function(t){var i=ko.utils.arrayFilter(vmViewIndex.menu.food(),function(i){return i.foodCatId()==t.foodCatId()&&i.foodSetId()==n.foodSetId()});isEmpty(i)||f.push(new DataMenuViewModel(n,t,i))})}),vmViewIndex.menu.dataMenu(f().slice());if(o.length>0&&!isEmpty(o)){for(i=0;i<o.length;i++)s=ko.utils.arrayFilter(vmViewIndex.menu.foodChoiceMap(),function(n){return n.foodId()==o[i].foodId}),vmViewIndex.menu.foodChoiceMap.removeAll(s),vmViewIndex.menu.choiceOptions.removeAll();ko.utils.arrayForEach(o,function(n){vmViewIndex.menu.foodChoiceMap.push(new DataFoodChoiceMapViewModel(n))})}else for(i=0;i<t.length;i++)s=ko.utils.arrayFilter(vmViewIndex.menu.foodChoiceMap(),function(n){return n.foodId()==t[i].foodId}),vmViewIndex.menu.foodChoiceMap.removeAll(s);ko.utils.arrayForEach(b,function(n){var t=ko.utils.arrayFilter(vmViewIndex.menu.dataSetupFoodModal.groupChoiceOptionId(),function(t){return n==t});t.length==0&&vmViewIndex.menu.dataSetupFoodModal.groupChoiceOptionId.push(n)});p=ko.observableArray([]);ko.mapping.fromJS(k,{},p);vmViewIndex.menu.thirdPartyGroupStore(p());vmViewIndex.menu.dataSetupFoodModal.clearSetupFood();vmViewIndex.showLoading(!1);foodSetClick()}function setChoiceOption(n,t){var i=new DataChoiceOptionViewModel(n),r,u;t==statusAdd?(vmViewIndex.configSetUp.choiceOption.dataArrayStore()._array.push(i),vmViewIndex.configSetUp.choice.dataChoiceOption.push(n)):(r=ko.utils.arrayFilter(vmViewIndex.configSetUp.choiceOption.dataArrayStore()._array,function(n){return n.choiceOptionId()==i.choiceOptionId()}),vmViewIndex.configSetUp.choiceOption.dataArrayStore().update(_.first(r).choiceOptionId(),{choiceOptionName:i.choiceOptionName(),choiceOptionNameAlt:i.choiceOptionNameAlt(),choiceMulti:i.choiceMulti(),choiceNewLine:i.choiceNewLine(),choiceRequire:i.choiceRequire(),active:i.active(),arrange:i.arrange(),maxChoice:i.maxChoice(),listProductTag:i.listProductTag(),plu:i.plu()}),u=ko.utils.arrayFilter(vmViewIndex.configSetUp.choice.dataChoiceOption(),function(t){return t.choiceOptionId==n.choiceOptionId}),vmViewIndex.configSetUp.choice.dataChoiceOption.replace(_.first(u),n));$("#modalSetUpChoiceOption").modal("hide");vmViewIndex.configSetUp.choiceOption.dataSetUpModal.clearSetUpChoiceOption();refreshGrid("gridChoiceOption")}function setChoice(n,t,i){var r=new DataChoiceViewModel(n),u,f,e;t==statusAdd?(vmViewIndex.configSetUp.choice.dataArrayStore()._array.push(r),vmViewIndex.configSetUp.choice.dataChoice().push(r)):(u=new DataChoiceViewModel(i),u.choiceOptionId()!=r.choiceOptionId()?(f=ko.utils.arrayFilter(vmViewIndex.configSetUp.choice.dataChoice(),function(n){return n.choiceOptionId()==u.choiceOptionId()&&n.choiceId()==u.choiceId()}),vmViewIndex.configSetUp.choice.dataChoice.replace(_.first(f),r),vmViewIndex.configSetUp.choice.dataArrayStore()._array.push(r)):(f=ko.utils.arrayFilter(vmViewIndex.configSetUp.choice.dataArrayStore()._array,function(n){return n.choiceOptionId()==r.choiceOptionId()&&n.choiceId()==r.choiceId()}),vmViewIndex.configSetUp.choice.dataArrayStore().update(_.first(f).choiceId(),{choiceName:r.choiceName(),choiceNameAlt:r.choiceNameAlt(),choiceOptionId:r.choiceOptionId(),choicePrice:r.choicePrice(),choiceWeight:r.choiceWeight(),active:r.active(),listProductTag:r.listProductTag(),plu:r.plu()}),e=ko.utils.arrayFilter(vmViewIndex.configSetUp.choice.dataChoice(),function(n){return n.choiceOptionId()==r.choiceOptionId()&&n.choiceId()==r.choiceId()}),vmViewIndex.configSetUp.choice.dataChoice.replace(_.first(e),r)));vmViewIndex.configSetUp.choice.currentChoiceOptionSelect(r.choiceOptionId());ko.mapping.fromJS(vmViewIndex.configSetUp.choice.dataArrayStore()._array,{},vmViewIndex.configSetUp.choice.cloneDataArrayStore);$("#modalSetUpChoice").modal("hide");vmViewIndex.configSetUp.choice.dataSetUpModal.clearSetUpChoice(vmViewIndex.configSetUp.choice.dataSetUpModal);refreshGrid("gridChoice")}function setChoiceCopy(n){_.forEach(n,function(n){var t=new DataChoiceViewModel(n);vmViewIndex.configSetUp.choice.dataArrayStore()._array.push(t);vmViewIndex.configSetUp.choice.dataChoice().push(t)});ko.mapping.fromJS(vmViewIndex.configSetUp.choice.dataArrayStore()._array,{},vmViewIndex.configSetUp.choice.cloneDataArrayStore);vmViewIndex.configSetUp.choice.listCopyChoice([]);vmViewIndex.configSetUp.choice.visibleListCopyChoice(!1);refreshGrid("gridChoice")}function setChoiceUnlock(n){_.forEach(n,function(n){var t=new DataChoiceViewModel(n),r=ko.utils.arrayFilter(vmViewIndex.configSetUp.choice.dataChoice(),function(n){return n.choiceOptionId()==t.choiceOptionId()&&n.choiceId()==t.choiceId()}),i=_.first(r);i.plu("");vmViewIndex.configSetUp.choice.dataChoice.replace(i,t)});refreshGrid("gridChoice")}function setChoiceModify(n,t,i){var r=new DataChoiceViewModel(n),u,f,e;t==statusAdd?(vmViewIndex.configSetUp.choiceModify.dataArrayStore()._array.push(r),vmViewIndex.configSetUp.choiceModify.dataChoice().push(r)):(u=new DataChoiceViewModel(i),u.choiceOptionId()!=r.choiceOptionId()?(f=ko.utils.arrayFilter(vmViewIndex.configSetUp.choiceModify.dataChoice(),function(n){return n.choiceOptionId()==u.choiceOptionId()&&n.choiceId()==u.choiceId()}),vmViewIndex.configSetUp.choiceModify.dataChoice.replace(_.first(f),r),vmViewIndex.configSetUp.choiceModify.dataArrayStore()._array.push(r)):(f=ko.utils.arrayFilter(vmViewIndex.configSetUp.choiceModify.dataArrayStore()._array,function(n){return n.choiceOptionId()==r.choiceOptionId()&&n.choiceId()==r.choiceId()}),vmViewIndex.configSetUp.choiceModify.dataArrayStore().update(_.first(f).choiceId(),{choiceName:r.choiceName(),choiceNameAlt:r.choiceNameAlt(),choiceOptionId:r.choiceOptionId(),choicePrice:r.choicePrice(),choiceWeight:r.choiceWeight(),active:r.active(),choiceOperator:r.choiceOperator(),listProductTag:r.listProductTag()}),e=ko.utils.arrayFilter(vmViewIndex.configSetUp.choiceModify.dataChoice(),function(n){return n.choiceOptionId()==r.choiceOptionId()&&n.choiceId()==r.choiceId()}),vmViewIndex.configSetUp.choiceModify.dataChoice.replace(_.first(e),r)));vmViewIndex.configSetUp.choiceModify.currentChoiceOptionSelect(r.choiceOptionId());ko.mapping.fromJS(vmViewIndex.configSetUp.choiceModify.dataArrayStore()._array,{},vmViewIndex.configSetUp.choiceModify.cloneDataArrayStore);$("#modalSetUpChoiceModify").modal("hide");vmViewIndex.configSetUp.choiceModify.dataSetUpModal.clearSetUpChoice(vmViewIndex.configSetUp.choiceModify.dataSetUpModal);refreshGrid("gridChoiceModify")}function setChoiceModifyCopy(n){_.forEach(n,function(n){var t=new DataChoiceViewModel(n);vmViewIndex.configSetUp.choiceModify.dataArrayStore()._array.push(t);vmViewIndex.configSetUp.choiceModify.dataChoice().push(t)});ko.mapping.fromJS(vmViewIndex.configSetUp.choiceModify.dataArrayStore()._array,{},vmViewIndex.configSetUp.choiceModify.cloneDataArrayStore);vmViewIndex.configSetUp.choice.listCopyChoice([]);vmViewIndex.configSetUp.choice.visibleListCopyChoice(!1);refreshGrid("gridChoiceModify")}function setGraguityCharge(n,t){var i=new DataGraguityChargeViewModel(n),r;t==statusAdd?vmViewIndex.configSetUp.graguityCharge.data.push(i):(r=ko.utils.arrayFilter(vmViewIndex.configSetUp.graguityCharge.data(),function(n){return n.graguityId()==i.graguityId()}),vmViewIndex.configSetUp.graguityCharge.data.replace(_.first(r),i));$("#modalSetUpGraguityCharge").modal("hide");vmViewIndex.configSetUp.graguityCharge.dataSetUpModal.clearSetUpGraguityCharge();refreshGrid("gridGraguityCharge")}function setFoodPrefix(n,t){var i=new DataFoodPrefixViewModel(n),r;i.active(i.prefixStatus()=="A"?!0:!1);i.isPrefixCal(i.prefixCal()==1?!0:!1);t==statusAdd?vmViewIndex.configSetUp.foodPrefix.dataArrayStore()._array.push(i):(r=ko.utils.arrayFilter(vmViewIndex.configSetUp.foodPrefix.dataArrayStore()._array,function(n){return n.prefixId()==i.prefixId()}),vmViewIndex.configSetUp.foodPrefix.dataArrayStore().update(_.first(r).prefixId(),{prefixName:i.prefixName(),prefixDesc:i.prefixDesc(),prefixCal:i.prefixCal(),prefixColorRed:i.prefixColorRed(),prefixStatus:i.prefixStatus(),prefixSorting:i.prefixSorting(),isPrefixCal:i.isPrefixCal(),active:i.active()}));$("#modalSetUpFoodPrefix").modal("hide");vmViewIndex.configSetUp.foodPrefix.dataSetUpModal.clearSetUpFoodPrefix();refreshGrid("gridFoodPrefix")}function setGraguityChargeSetting(){vmViewIndex.allSetting.dataGratuity.btnCloseGratuityCharge()}function setTaxRate(n,t){var i=new DataTaxRateViewModel(n),r,u;t==statusAdd?(vmViewIndex.configSetUp.taxRate.data.push(i),vmViewIndex.configSetUp.revenueClass.dataTaxRate.push(i)):(r=ko.utils.arrayFilter(vmViewIndex.configSetUp.taxRate.data(),function(n){return n.taxRateId()==i.taxRateId()}),vmViewIndex.configSetUp.taxRate.data.replace(_.first(r),i),u=ko.utils.arrayFilter(vmViewIndex.configSetUp.revenueClass.dataTaxRate(),function(n){return n.taxRateId()==i.taxRateId()}),vmViewIndex.configSetUp.revenueClass.dataTaxRate.replace(_.first(u),i));$("#modalSetUpTaxRate").modal("hide");vmViewIndex.configSetUp.taxRate.dataSetUpModal.clearSetUpTaxRate();refreshGrid("gridTaxRate")}function setRevenueClass(n,t,i){var r=new DataRevenueClassViewModel(n),u,f,e;t==statusAdd?(vmViewIndex.configSetUp.revenueClass.data.push(r),vmViewIndex.configSetUp.revenueClass.dataRevenueClass.push(r)):(u=new DataRevenueClassViewModel(i),u.taxRateId()!=r.taxRateId()?(f=ko.utils.arrayFilter(vmViewIndex.configSetUp.revenueClass.dataRevenueClass(),function(n){return n.taxRateId()==u.taxRateId()&&n.revenueClassId()==u.revenueClassId()}),vmViewIndex.configSetUp.revenueClass.data.push(r),vmViewIndex.configSetUp.revenueClass.dataRevenueClass.replace(_.first(f),r)):(f=ko.utils.arrayFilter(vmViewIndex.configSetUp.revenueClass.data(),function(n){return n.taxRateId()==r.taxRateId()&&n.revenueClassId()==r.revenueClassId()}),vmViewIndex.configSetUp.revenueClass.data.replace(_.first(f),r),e=ko.utils.arrayFilter(vmViewIndex.configSetUp.revenueClass.dataRevenueClass(),function(n){return n.taxRateId()==r.taxRateId()&&n.revenueClassId()==r.revenueClassId()}),vmViewIndex.configSetUp.revenueClass.dataRevenueClass.replace(_.first(e),r)));$("#modalSetUpRevenueClass").modal("hide");vmViewIndex.configSetUp.revenueClass.dataSetUpModal.clearSetUpRevenueClass();refreshGrid("gridRevenueClass")}function setIcon(n,t){var i=new DataIconViewModel(n),r;t==statusAdd?vmViewIndex.configSetUp.iconSetup.dataArrayStore.push(i):(r=ko.utils.arrayFilter(vmViewIndex.configSetUp.iconSetup.dataArrayStore(),function(n){return n.iconId()==i.iconId()}),vmViewIndex.configSetUp.iconSetup.dataArrayStore.replace(_.first(r),i));$("#modalSetUpIcon").modal("hide");vmViewIndex.configSetUp.iconSetup.dataSetUpModal.clearSetUpIcon();refreshGrid("gridIcon")}function clickPrint(n,t){var i=$("#"+t.target.value+""),r=i.html(),u=removeTag(".phone",r),f=removeTag("#collapseBill",u),e=removeTag(".h6",f),o=removeTag(".dx-datagrid-nodata",e),s=removeTag(".dx-page-sizes",o),h=removeTag(".dx-pages",s);printWindow(h)}function clickPrintDeliveryBilling(n,t){$("#gridDeliveryBilling tbody").css("font-size","14px");var i=$("#"+t.target.value+""),r=i.html(),u=removeTag("#collapseBill",r),f=removeTag(".dx-datagrid-nodata",u),e=removeTag(".dx-page-sizes",f),o=removeTag(".dx-pages",e);printWindow(o)}function clickPrintBill(n){var t=n.ticketId(),i=$("div.btnPrintBill#"+t+""),r=removeTag("div.gb_margin-printbill",i.html()),u=removeTag("button",r),f=removeTag("tr.hidden-md-up",u);printWindow(f)}function printWindow(n){var t=window.open("","_blank","resizable=yes, width=800, height=768");t.document.write("<html><head><title><\/title>");t.document.write('<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" type="text/css" />');t.document.write('<style type="text/css">@page {size: 21cm 29.7cm;margin: 10mm 6mm 10mm 10mm;}<\/style>');t.document.write('<\/head><body><div class="row"><div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 center-block">');t.document.write(n);t.document.write("<\/div><\/div><\/body><\/html>");t.document.close();setTimeout(function(){t.print()},1e3)}function foodSetClick(){$("#tabFoodSet"+vmViewIndex.menu.selectFoodSetSorting()).click()}