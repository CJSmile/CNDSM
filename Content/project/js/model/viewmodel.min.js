function AllTemplateViewModel(){var n=this;n.data=new DataTemplateViewModel;n.draggedFoodImage=ko.observable();n.draggedTemplateImage=ko.observable();n.handleDragStart=function(t){return n.draggedFoodImage(t),n.draggedTemplateImage(null),!0};n.handleDragStartDetail=function(t){return n.draggedFoodImage(null),n.draggedTemplateImage(t),!0};n.handleDragOver=function(){console.log("dragOver")};n.handleDrop=function(n,t){var i=vmViewIndex.allTemplate,u,r;console.log("drop");u=ko.contextFor(t.target);r=u.$index();i.draggedFoodImage()!=null&&(i.data.templateMain()[r].templateId(i.data.templateId()),i.data.templateMain()[r].foodName(i.draggedFoodImage().foodName()),i.data.templateMain()[r].foodPrice(i.draggedFoodImage().foodPrice()),i.data.templateMain()[r].image(i.draggedFoodImage().foodImage()),i.data.templateMain()[r].imageName(i.draggedFoodImage().foodImageName()),i.data.templateMain()[r].visibleImage(!0));i.draggedTemplateImage()!=null&&(i.data.templateMain()[r].templateId(i.data.templateId()),i.data.templateMain()[r].foodName("Food Name"),i.data.templateMain()[r].foodPrice(0),i.data.templateMain()[r].image(i.draggedTemplateImage().templateImage()),i.data.templateMain()[r].imageName(i.draggedTemplateImage().templateImageName()),i.data.templateMain()[r].visibleImage(!0))};n.handleDropDetail=function(n,t){var i=vmViewIndex.allTemplate,u=ko.contextFor(t.target),r=u.$index();i.draggedFoodImage()!=null&&(i.data.templateDetail()[r].templateId(i.data.templateId()),i.data.templateDetail()[r].image(i.draggedFoodImage().foodImage()),i.data.templateDetail()[r].imageName(i.draggedFoodImage().foodImageName()),i.data.templateDetail()[r].visibleImage(!0),i.data.templateDetail()[r].topic("Topic"),i.data.templateDetail()[r].content("Content"));i.draggedTemplateImage()!=null&&(i.data.templateDetail()[r].templateId(i.data.templateId()),i.data.templateDetail()[r].image(i.draggedTemplateImage().templateImage()),i.data.templateDetail()[r].imageName(i.draggedTemplateImage().templateImageName()),i.data.templateDetail()[r].visibleImage(!0),i.data.templateDetail()[r].topic("Topic"),i.data.templateDetail()[r].content("Content"))};n.handleDropLogo=function(){var n=vmViewIndex.allTemplate;n.draggedFoodImage()!=null&&(n.data.image(n.draggedFoodImage().foodImage()),n.data.imageName(n.draggedFoodImage().foodImageName()));n.draggedTemplateImage()!=null&&(n.data.image(n.draggedTemplateImage().templateImage()),n.data.imageName(n.draggedTemplateImage().templateImageName()))};n.clickVisibleImage=function(n){n.templateId(0);n.image(null);n.foodName("");n.foodPrice(0);n.visibleImage(!1)};n.clickVisibleImageDetail=function(n){n.templateId(0);n.image(null);n.topic("");n.content("");n.visibleImage(!1)};n.clickVisibleImageLogo=function(){var n=vmViewIndex.allTemplate.data;n.image(null);n.imageName(null)};n.clickActiveTemplate=ko.observable({offText:"NO",onText:"YES",value:n.data.active,width:switchActiveWidth55px,onValueChanged:function(n){var t=vmViewIndex.allTemplate.data;n.value==!0?t.active(!0):t.active(!1)}});n.clickShowPrice=ko.observable({offText:"NO",onText:"YES",value:n.data.showPrice,width:switchActiveWidth55px,onValueChanged:function(n){var t=vmViewIndex.allTemplate.data;n.value==!0?t.showPrice(!0):t.showPrice(!1)}});n.disableUpdateTemplateSubmit=ko.observable(!1);$("#uploadImage").change(function(){$("#showUploadImage").val($(this).val())})}function DataTemplateViewModel(n){var t=this,r,u,f,e,o;if(isEmpty(n))t.foodImage=ko.observableArray([]),t.templateImage=ko.observableArray([]),t.templateConfig=ko.observableArray([]),t.templateMainShow=ko.observableArray([]),t.templateDetailShow=ko.observableArray([]),t.templateId=ko.observable(0),t.templateName=ko.observable(""),t.imageMainQty=ko.observable(0),t.imageDetailQty=ko.observable(0),t.welcomeTopic=ko.observable(""),t.welcomeContent=ko.observable(""),t.active=ko.observable(!1),t.showPrice=ko.observable(!0),t.image=ko.observable(),t.imageName=ko.observable(),t.valTemplateId=ko.observable(),t.templateMain=ko.observableArray([]),t.templateDetail=ko.observableArray([]),t.templateImageUrl=ko.observable(),t.changeTemplate=ko.observable();else{clearTemplateViewModel();var s=n.listFoodImage,h=n.listTemplateImage,c=n.listTemplateConfig,l=n.listTemplateMain,a=n.listTemplateDetail,i=n.templateImageUrl,t=vmViewIndex.allTemplate.data;t.templateImageUrl(i);r=ko.utils.arrayMap(s,function(n){return new FoodImage(n.foodId,n.foodName,n.foodPrice,n.image,i)});t.foodImage.push.apply(t.foodImage,r);u=ko.utils.arrayMap(h,function(n){return new TemplateImage(n.templateImageId,n.image,i)});t.templateImage.push.apply(t.templateImage,u);f=ko.utils.arrayMap(c,function(n){return new TemplateConfig(n.templateId,n.templateName,n.imageMainQty,n.imageDetailQty,n.welcomeTopic,n.welcomeContent,n.active,n.showPrice,n.image,i)});t.templateConfig.push.apply(t.templateConfig,f);t.valTemplateId(_.first(t.templateConfig()).templateId());t.changeTemplate({dataSource:new DevExpress.data.ArrayStore({data:t.templateConfig(),key:"templateId"}),dropDownButtonTemplate:"dropDownButton",displayExpr:"templateName",valueExpr:"templateId",value:t.valTemplateId,onValueChanged:function(n){getTemplateConfig(vmViewIndex.allTemplate.data.templateConfig(),n.value,vmViewIndex.allTemplate.data.templateImageUrl())}});e=ko.utils.arrayMap(l,function(n){return new TemplateMain(n.templateMainId,n.templateId,n.image,n.sorting,n.foodName,n.foodPrice,!0,i)});t.templateMainShow.push.apply(t.templateMainShow,e);o=ko.utils.arrayMap(a,function(n){return new TemplateDetail(n.templateDetailId,n.templateId,n.image,n.sorting,n.topic,n.content,!0,i)});t.templateDetailShow.push.apply(t.templateDetailShow,o);getTemplateConfig(t.templateConfig(),null,i)}}function clearTemplateViewModel(){var n=vmViewIndex.allTemplate.data;n.foodImage([]);n.templateImage([]);n.templateConfig([]);n.templateMainShow([]);n.templateDetailShow([]);n.templateId(0);n.templateName("");n.imageMainQty(0);n.imageDetailQty(0);n.welcomeTopic("");n.welcomeContent("");n.active(!1);n.showPrice(!0);n.image();n.imageName();n.valTemplateId();n.templateMain([]);n.templateDetail([])}function getTemplateConfig(n,t,i){var r=vmViewIndex.allTemplate.data,p=$(".templateConfig"),w=$(".showPrice"),o=!1,s=[],f,e,c,a,u;if(s=t==null||t==""?ko.utils.arrayFilter(n,function(n){return n.active()==!0}):ko.utils.arrayFilter(n,function(n){return n.templateId()==t}),s.length>0&&(o=!0),o||(r.templateId(0),r.templateName(""),r.imageMainQty(0),r.imageDetailQty(0),r.welcomeTopic(""),r.welcomeContent(""),r.image(null),r.imageName(""),r.active(!1),r.showPrice(!0)),ko.utils.arrayForEach(s,function(n){r.templateId(n.templateId());r.templateName(n.templateName());r.imageMainQty(n.imageMainQty());r.imageDetailQty(n.imageDetailQty());r.welcomeTopic(n.welcomeTopic());r.welcomeContent(n.welcomeContent());r.image(n.image());r.imageName(n.imageName());r.active(n.active());r.showPrice(n.showPrice())}),r.templateMain([]),r.templateDetail([]),o){var f=r.templateMain(),h=ko.utils.arrayFilter(r.templateMainShow(),function(n){return n.templateId()==r.templateId()}),v=h.length;for(ko.utils.arrayForEach(h,function(n){f.push(new TemplateMain(n.templateMainId(),n.templateId(),n.imageName(),n.sorting(),n.foodName(),n.foodPrice(),!0,i))}),c=r.imageMainQty(),u=v;u<c;u++)f.push(new TemplateMain(0,0,null,u+1,"",0,!1));r.templateMain.valueHasMutated();var e=r.templateDetail(),l=ko.utils.arrayFilter(r.templateDetailShow(),function(n){return n.templateId()==r.templateId()}),y=l.length;for(ko.utils.arrayForEach(l,function(n){e.push(new TemplateDetail(n.templateDetailId(),n.templateId(),n.imageName(),n.sorting(),n.topic(),n.content(),!0,i))}),a=r.imageDetailQty(),u=y;u<a;u++)e.push(new TemplateDetail(0,0,null,u+1,"","",!1));r.templateDetail.valueHasMutated()}else{if(r.imageMainQty()>0){for(f=r.templateMain(),u=0;u<r.imageMainQty();u++)f.push(new TemplateMain(0,0,null,u+1,"",0,!1));r.templateMain.valueHasMutated()}if(r.imageDetailQty()>0){for(e=r.templateDetail(),u=0;u<r.imageDetailQty();u++)e.push(new TemplateDetail(0,0,null,u+1,"","",!1));r.templateDetail.valueHasMutated()}}}function FoodImage(n,t,i,r,u){var f=this;f.foodId=ko.observable(n);f.foodName=ko.observable(t);f.foodPrice=ko.observable(i);f.foodImage=ko.observable(u+r);f.foodImageName=ko.observable(r)}function TemplateImage(n,t,i){var r=this;r.templateImageId=ko.observable(n);r.templateImage=ko.observable(i+t);r.templateImageName=ko.observable(t)}function TemplateConfig(n,t,i,r,u,f,e,o,s,h){var c=this;c.templateId=ko.observable(n);c.templateName=ko.observable(t);c.imageMainQty=ko.observable(i);c.imageDetailQty=ko.observable(r);c.welcomeTopic=ko.observable(u);c.welcomeContent=ko.observable(f);c.active=ko.observable(e);c.showPrice=ko.observable(o);s!=null?(c.image=ko.observable(h+s),c.imageName=ko.observable(s)):(c.image=ko.observable(null),c.imageName=ko.observable(null))}function TemplateMain(n,t,i,r,u,f,e,o){var s=this;s.templateMainId=ko.observable(n);s.templateId=ko.observable(t);s.image=i!=null?ko.observable(o+i):ko.observable(null);s.imageName=ko.observable(i);s.sorting=ko.observable(r);s.foodName=ko.observable(u);s.foodPrice=ko.observable(f).extend({numeric:2});s.visibleImage=ko.observable(e)}function TemplateDetail(n,t,i,r,u,f,e,o){var s=this;s.templateDetailId=ko.observable(n);s.templateId=ko.observable(t);s.image=i!=null?ko.observable(o+i):ko.observable(null);s.imageName=ko.observable(i);s.sorting=ko.observable(r);s.topic=ko.observable(u);s.content=ko.observable(f);s.visibleImage=ko.observable(e)}function AllSettingViewModel(n){function v(n){const i=new Promise((i,r)=>{fetch(n).then(n=>n.blob()).then(n=>{var u,f=t.fileNameBackground(),o=f.split(".").slice(0,-1).join(".")+"_mobile."+f.split(".").pop();u=e.length==0?new File([n],f,{type:t.fileTypeBackground()}):new File([n],o,{type:t.fileTypeBackground()});typeof u!="undefined"?i(u):r(new Error(u))})});i.then(n=>{e.push(n),t.mobileCropMode()&&e.length==1&&!isEmpty(f)?(canvas=f.getCroppedCanvas({width:828,height:496}),canvas.toBlob(function(n){url=URL.createObjectURL(n);var t=new FileReader;t.readAsDataURL(n);t.onloadend=function(){const n=t.result;v(n)}})):t.submitUploadImageBackground(e)});i.catch(()=>{$("#modalUploadImageBackground").modal("hide"),swal("Error",cSwal_Alert_Error,cSwal_Icon_Error),vmViewIndex.disablePointer("pointer")})}var t=this,i,o,s,r;t.tabSettingIndexClick=ko.observable(2);t.disableButtonSubmit=ko.observable(!1);t.setDisableButtonSubmit=function(){t.disableButtonSubmit(!0)};o=ko.observableArray([{value:"5"},{value:"10"},{value:"15"},{value:"20"},{value:"30"},{value:"40"},{value:"50"},{value:"60"},]);t.defaultPeriodTime=ko.pureComputed(function(){return vmViewIndex.globalConfig.shopPeriodTime()});t.defaultPeriodTimePickup=ko.pureComputed(function(){return vmViewIndex.globalConfig.shopPeriodTimePickup()});t.defaultPeriodTimeDelivery=ko.pureComputed(function(){return vmViewIndex.globalConfig.shopPeriodTimeDelivery()});t.selectPeriodTime=ko.observable({dataSource:new DevExpress.data.ArrayStore({data:o(),key:"value"}),displayExpr:"value",valueExpr:"value",value:t.defaultPeriodTime,placeholder:"Select Time",onValueChanged:function(n){vmViewIndex.globalConfig.shopPeriodTime(n.value)}});t.selectPeriodTimePickup=ko.observable({dataSource:new DevExpress.data.ArrayStore({data:o(),key:"value"}),displayExpr:"value",valueExpr:"value",value:t.defaultPeriodTimePickup,placeholder:"Select Time",onValueChanged:function(n){vmViewIndex.globalConfig.shopPeriodTimePickup(n.value)}});t.selectPeriodTimeDelivery=ko.observable({dataSource:new DevExpress.data.ArrayStore({data:o(),key:"value"}),displayExpr:"value",valueExpr:"value",value:t.defaultPeriodTimeDelivery,placeholder:"Select Time",onValueChanged:function(n){vmViewIndex.globalConfig.shopPeriodTimeDelivery(n.value)}});t.showOrderLimit=ko.observable(!1);t.switchOrderLimit=ko.observable({offText:"No",onText:"Yes",value:t.showOrderLimit,width:80,onValueChanged:function(n){n.value==!0?(t.showOrderLimit(!0),vmViewIndex.globalConfig.orderLimit("1")):(t.showOrderLimit(!1),vmViewIndex.globalConfig.orderLimit("0"))}});t.addPrice=ko.observable(0);t.blurPrice=function(n,i){var r=$(i.target).val();r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);t.addPrice(r.toFixed(2))};t.showUtensils=ko.observable(!1);t.switchShowUtensils=ko.observable({offText:"No",onText:"Yes",value:t.showUtensils,width:80,onValueChanged:function(n){n.value==!0?t.showUtensils(!0):t.showUtensils(!1)}});t.autoSelectUtensils=ko.observable(!1);t.switchAutoSelect=ko.observable({offText:"No",onText:"Yes",value:t.autoSelectUtensils,width:80,onValueChanged:function(n){n.value==!0?t.autoSelectUtensils(!0):t.autoSelectUtensils(!1)}});t.defaultThemeColor=ko.pureComputed(function(){return isEmpty(vmViewIndex.globalConfig.themeColor())&&vmViewIndex.globalConfig.themeColor("1"),vmViewIndex.globalConfig.themeColor()});s=ko.observableArray([{name:"Orange",id:"1"},{name:"Green",id:"2"},{name:"Blue",id:"3"},{name:"Red",id:"4"},{name:"Yellow",id:"5"},{name:"Navy",id:"6"},{name:"Gold",id:"7"},{name:"Pink",id:"8"},{name:"Black",id:"9"}]);t.selectTheme=ko.observable({dataSource:new DevExpress.data.ArrayStore({data:s(),key:"id"}),displayExpr:"name",valueExpr:"id",value:t.defaultThemeColor,placeholder:"Select Theme",onValueChanged:function(n){vmViewIndex.globalConfig.themeColor(n.value)}});t.allowJoinTicketContactless=ko.observable(!1);t.switchAllowJoinTicket=ko.observable({offText:"No",onText:"Yes",value:t.allowJoinTicketContactless,width:80,onValueChanged:function(n){n.value==!0?(t.allowJoinTicketContactless(!0),vmViewIndex.globalConfig.allowJoinTicket("1")):(t.allowJoinTicketContactless(!1),vmViewIndex.globalConfig.allowJoinTicket("0"))}});t.showPartySizeContactless=ko.observable(!1);t.switchShowPartySize=ko.observable({switchedOffText:"OFF",switchedOnText:"ON",value:t.showPartySizeContactless,width:80,onValueChanged:function(n){n.value==!0?(t.showPartySizeContactless(!0),vmViewIndex.globalConfig.showPartySize("1")):(t.showPartySizeContactless(!1),vmViewIndex.globalConfig.showPartySize("0"))}});t.data=ko.observableArray([]);t.dataSetUpModal=new SetUpDiscountViewModel;t.dataDiscountOneTimeUse=ko.observableArray([]);t.discountGroup=ko.observableArray([]);t.dataSetUpModalDiscountOneTimeUse=new SetUpDiscountOneTimeUseViewModel;t.dataSourceDiscountOneTimeUse=ko.observableArray();t.chkBtnAdd=ko.observable(!1);t.chkBtnUpdate=ko.observable(!1);t.chkSearch=ko.observable(!1);t.dataShopClose=ko.observableArray([]);t.dataSetUpModalShopClose=new SetUpShopCloseViewModel;t.dataAutoCharge=ko.observableArray([]);t.dataHoliday=ko.observableArray([]);t.dataSetUpModalAutoCharge=new SetUpAutoChargeViewModel;t.dataSetUpModalHoliday=new SetUpHolidayViewModel;t.dataGratuity=new GraguitySettingViewModel;t.dataListMainFood=ko.observableArray([]);t.dataListFreeFood=ko.observableArray([]);t.dataArrMainFood=ko.observableArray([]);t.dataArrFreeFood=ko.observableArray([]);t.dataListFoodCat=ko.observableArray([]);t.dataMainPrice=ko.observableArray([]);t.dataGroupMainFood=ko.observableArray([]);t.dataGroupFreeFood=ko.observableArray([]);t.dataConditionMainFood=ko.observableArray([]);t.dataConditionMainPrice=ko.observableArray([]);t.dataSetUpMainPrice=new SetUpMainPriceViewModel;t.dataSetUpGroupMainFood=new SetUpGroupMainFoodViewModel;t.dataSetUpGroupFreeFood=new SetUpGroupFreeFoodViewModel;t.dataSetUpCondition=new SetUpConditionViewModel;t.show=ko.observable(!0);t.groupDiscountDownload=ko.observableArray([]);t.group=ko.observable();t.selectDiscountGroup=ko.observable({acceptCustomValue:!1,dataSource:t.groupDiscountDownload,displayExpr:"value",value:t.group,valueExpr:"id",dropDownButtonTemplate:"dropDownButton",onItemClick:function(n){n.itemData!=null&&t.group()},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()}});t.groupDiscountFilter=ko.observableArray([]);t.groupDiscountFilterSelect=ko.observable();t.filterDiscount=ko.observable({dataSource:t.groupDiscountFilter,displayExpr:"value",value:t.groupDiscountFilterSelect,valueExpr:"id",dropDownButtonTemplate:"dropDownButton",searchEnabled:!0,onItemClick:function(n){var i=ko.utils.arrayFilter(t.dataDiscountOneTimeUse(),function(t){return t.group()==n.itemData.id});t.dataSourceDiscountOneTimeUse(i.slice(0));refreshGrid("gridDiscountOneTimeUse")},onOpened:function(n){n.component._popup.option("closeOnTargetScroll",!1)}});t.switchSpecialInstructions=ko.observable({offText:"Hide",onText:"Show",value:t.show,width:80,onValueChanged:function(n){n.value==!0?(t.show(!0),vmViewIndex.globalConfig.specialInstructions("1")):(t.show(!1),vmViewIndex.globalConfig.specialInstructions("0"))}});t.instructionLinkToFood=ko.observable("");t.treeListFood=ko.observable();t.clickLinkToFood=function(){vmViewIndex.showLoading(!0);setTimeout(function(){var r=JSON.parse(getObjFormAjax(cJsonGetDataMenu,"")),u=ko.observableArray([]),f=ko.observableArray([]),e=ko.observableArray([]),i=ko.observableArray([]),o=ko.observableArray([]),n;ko.mapping.fromJS(r.listFoodSet,{},u);ko.mapping.fromJS(r.listFoodCategory,{},f);ko.mapping.fromJS(r.listFood,{},e);n=1;ko.utils.arrayForEach(u(),function(t){var r=0,u=0,s=new DataInstructionLinkToFoodViewModel(n,r,t.foodSetName(),cFoodSet,t.foodSetId(),t.active());u=n;i.push(s);ko.utils.arrayForEach(f(),function(r){var f=0,s=ko.utils.arrayFilter(e(),function(n){return n.foodCatId()==r.foodCatId()&&n.foodSetId()==t.foodSetId()});isEmpty(s)||(n+=1,i.push(new DataInstructionLinkToFoodViewModel(n,u,r.foodCatName(),cFoodCat,r.foodCatId(),r.active())),f=n,ko.utils.arrayForEach(s,function(t){n+=1;isEmpty(t.plu())&&i.push(new DataInstructionLinkToFoodViewModel(n,f,t.foodName(),cFood,t.foodId(),t.active()));t.isShowInstruction()&&o.push(n)}))});r+=1;n+=1});t.treeListFood({dataSource:i,keyExpr:"id",parentIdExpr:"headId",allowColumnReordering:!0,allowColumnResizing:!0,showBorders:!0,showColumnLines:!0,showRowLines:!0,columnAutoWidth:!0,paging:{enabled:!1},pager:{enabled:!1},scrolling:{mode:"standard"},selection:{mode:"multiple",recursive:!0},filterRow:{visible:!0},loadPanel:{enabled:!0,height:90,indicatorSrc:"",showIndicator:!0,showPane:!0,text:"Loading...",width:200},stateStoring:{enabled:!0,type:"localStorage",storageKey:"treeListStorage"},columns:[{dataField:"name",caption:"Name"},{dataField:"active",caption:"Active",alignment:"center"}],expandedRowKeys:[0],selectedRowKeys:o,onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))}});$("#modalShowInstructions").modal("show");vmViewIndex.showLoading(!1)},0)};t.clickSubmitLinkToFood=function(){var n=$("#treeListFood").dxTreeList("instance"),t=n.getSelectedRowsData("all"),i=new ObjUrl(cfrmInstructionLinkToFoodUpdate),r=i.getUrlSubmitForm(),u=ko.toJSON(t),f={jsonListFood:u};$.ajax({url:r,async:ajax_async,cache:ajax_cache,type:ajax_type_post,data:f,timeout:ajax_timeout}).done(function(n){var t=new ObjAlert("",n.message,n.status);t.getAlert();$("#modalShowInstructions").modal("hide")}).fail(function(n){vmViewIndex.showLoading(!1);var t=new ObjAlert("",n.message,n.status);t.getAlert()})};t.showActive=ko.observable(!0);t.switchShopActive=ko.observable({offText:"No",onText:"Yes",value:t.showActive,width:80,onValueChanged:function(n){n.value==!0?(t.showActive(!0),vmViewIndex.globalConfig.shopActive("1")):(t.showActive(!1),vmViewIndex.globalConfig.shopActive("0"))}});t.showAnnounceCustomActive=ko.observable(!0);t.switchShopAnnounceCustomActive=ko.observable({offText:"No",onText:"Yes",value:t.showAnnounceCustomActive,width:80,onValueChanged:function(n){n.value==!0?(t.showAnnounceCustomActive(!0),vmViewIndex.globalConfig.shopAnnounceCustomActive("1")):(t.showAnnounceCustomActive(!1),vmViewIndex.globalConfig.shopAnnounceCustomActive("0"))}});t.valueShopInfo=ko.observable(!0);t.switchShopInfo=ko.observable({offText:"Hide",onText:"Show",value:t.valueShopInfo,width:80,onValueChanged:function(n){n.value==!0?(t.valueShopInfo(!0),vmViewIndex.globalConfig.isShopInfo("1")):(t.valueShopInfo(!1),vmViewIndex.globalConfig.isShopInfo("0"))}});t.checkHaveScript=ko.observable(!0);t.showTipsDescForStore=ko.observable(!1);t.showTipsDescForCredit=ko.observable(!1);t.switchTipsDescForStore=ko.observable({offText:"Hide",onText:"Show",value:t.showTipsDescForStore,width:80,onValueChanged:function(n){n.value==!0?(t.showTipsDescForStore(!0),vmViewIndex.globalConfig.tipsDescForStore("1")):(t.showTipsDescForStore(!1),vmViewIndex.globalConfig.tipsDescForStore("0"))}});t.switchTipsDescForCredit=ko.observable({offText:"Hide",onText:"Show",value:t.showTipsDescForCredit,width:80,onValueChanged:function(n){n.value==!0?(t.showTipsDescForCredit(!0),vmViewIndex.globalConfig.tipsDescForCredit("1")):(t.showTipsDescForCredit(!1),vmViewIndex.globalConfig.tipsDescForCredit("0"))}});t.showCurbside=ko.observable(!1);t.switchCurbsidePickup=ko.observable({offText:"Hide",onText:"Show",value:t.showCurbside,width:80,onValueChanged:function(n){n.value==!0?(t.showCurbside(!0),vmViewIndex.globalConfig.showCurbsidePickup("1")):(t.showCurbside(!1),vmViewIndex.globalConfig.showCurbsidePickup("0"))}});t.hasCouponDelivery=ko.observable(!0);t.CouponDeliveryData=ko.observableArray([]);r=filterGlobalConfig(n,"currentDateTime");t.dataViewModelCouponDelivery=new SetupCouponDeliveryViewModel(r);t.dataGridCouponDelivery=ko.observable({dataSource:t.CouponDeliveryData,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){i=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"couponDeliveryName",caption:"Name",width:"100"},{dataField:"usedCoupon",caption:"Used",width:"100",dataType:"number",alignment:"center"},{dataField:"totalCoupon",caption:"Total",width:"100",dataType:"number",alignment:"center"},{dataField:"minimumOrder",caption:"Minimum Order",dataType:"number",alignment:"center",format:"currency",precision:2},{dataField:"couponDeliveryCode",caption:"Code"},{dataField:"active",caption:"Active"}],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(n){var e=n.data,i=ko.mapping.toJSON(e);_.isEmpty(r)&&(r=vmViewIndex.globalConfig.currentDateTime());var u=moment(r).format("MM/DD/YYYY"),o=JSON.parse(i),f=moment(o.startDate).format("MM/DD/YYYY");moment(u).isAfter(f)?t.dataViewModelCouponDelivery.currentDate(f):t.dataViewModelCouponDelivery.currentDate(u);ko.mapping.fromJSON(i,{},t.dataViewModelCouponDelivery);vmViewIndex.allSetting.disableButtonSubmit(!1);$(cModalSetupCouponDelivery).modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnUpdate(!0);t.chkBtnAdd(!1)},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){_.isEmpty(r)&&(r=vmViewIndex.globalConfig.currentDateTime());var n=moment(r).format("MM/DD/YYYY");t.dataViewModelCouponDelivery.currentDate(n);vmViewIndex.allSetting.disableButtonSubmit(!1);vmViewIndex.allSetting.dataViewModelCouponDelivery.clearSetUp();$(cModalSetupCouponDelivery).modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnAdd(!0);t.chkBtnUpdate(!1)}}})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$(cDataGridCouponDelivery+" .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.dataGridDiscount=ko.observable({dataSource:t.data,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){i=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"discountName",caption:"Name",width:"200"},{dataField:"discountDesc",caption:"Des",width:"150"},{dataField:"couponAmountOff",caption:"AmountOff",dataType:"number",alignment:"center",format:"currency",precision:2},{dataField:"couponPercentOff",caption:"PercentOff",dataType:"number",alignment:"center",format:"fixedPoint",precision:2},{dataField:"termsAmountMin",caption:"Terms Amount Min",dataType:"number",alignment:"center",format:"fixedPoint",precision:2},{dataField:"termsAmountMax",caption:"Terms Amount Max",dataType:"number",alignment:"center",format:"fixedPoint",precision:2},{dataField:"couponCode",caption:"Code"},{dataField:"active",caption:"Active"}],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(n){var i=n.data,r=ko.mapping.toJSON(i);t.dataSetUpModal.isCloseDiscount(!0);ko.mapping.fromJSON(r,{},t.dataSetUpModal);t.dataSetUpModal.isCloseDiscount(!1);t.dataSetUpModal.couponCode()==""||t.dataSetUpModal.couponCode()==null?(t.dataSetUpModal.isAutoDiscount(!0),t.dataSetUpModal.isCouponDiscount(!1)):(t.dataSetUpModal.isAutoDiscount(!1),t.dataSetUpModal.isCouponDiscount(!0));t.dataSetUpModal.termsAmountMin()==0&&t.dataSetUpModal.isUnlimitMin(!0);t.dataSetUpModal.termsAmountMax()==0&&t.dataSetUpModal.isUnlimitMax(!0);t.dataSetUpModal.shippingTypeId(shippingType.cAll);t.dataSetUpModal.isPickup()&&!t.dataSetUpModal.isDelivery()?t.dataSetUpModal.shippingTypeId(shippingType.cPickUp):!t.dataSetUpModal.isPickup()&&t.dataSetUpModal.isDelivery()&&t.dataSetUpModal.shippingTypeId(shippingType.cDelivery);t.dataSetUpModal.startDate(moment(new Date(t.dataSetUpModal.startDate())).format());t.dataSetUpModal.endDate(moment(new Date(t.dataSetUpModal.endDate())).format());vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalSetUpDiscount").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnUpdate(!0);t.chkBtnAdd(!1)},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalSetUpDiscount").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnAdd(!0);t.chkBtnUpdate(!1)}}})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$("#gridDiscount .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.dataGridAutoCharge=ko.observable({dataSource:t.dataAutoCharge,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){i=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"autoChargeName",caption:"Name",width:"140"},{dataField:"autoChargeDesc",caption:"Description",width:"100"},{dataField:"amountCharge",caption:"AmountCharge",dataType:"number",alignment:"center",format:"currency",precision:2},{dataField:"percentCharge",caption:"PercentCharge",dataType:"number",alignment:"center",format:"fixedPoint",precision:2},{dataField:"taxCharge",caption:"TaxCharge",dataType:"number",alignment:"center",format:"fixedPoint",precision:2},{dataField:"active",caption:"Active",alignment:"center"},],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(n){var i=n.data,r=ko.mapping.toJSON(i);ko.mapping.fromJSON(r,{},t.dataSetUpModalAutoCharge);vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalSetUpAutoCharge").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnUpdate(!0);t.chkBtnAdd(!1)},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalSetUpAutoCharge").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnAdd(!0);t.chkBtnUpdate(!1)}}})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$("#gridAutoCharge .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.btnCloseShowAutoCharge=function(){$("html").css({"overflow-x":"auto","overflow-y":"auto"})};t.dataGridHoliday=ko.observable({dataSource:t.dataHoliday,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!1,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){i=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"description",caption:"Description",width:"250"},{dataField:"startDate",caption:"StartDate",alignment:"center",dataType:"date"},{dataField:"endDate",caption:"EndDate",alignment:"center",dataType:"date"},{dataField:"active",caption:"Active",alignment:"center"},],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(n){var i=n.data,r=ko.mapping.toJSON(i);ko.mapping.fromJSON(r,{},t.dataSetUpModalHoliday);vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalSetUpHoliday").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnUpdate(!0);t.chkBtnAdd(!1)},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalSetUpHoliday").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnAdd(!0);t.chkBtnUpdate(!1)}}})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$("#gridHoliday .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.dataGridDiscountOneTimeUse=ko.observable({dataSource:t.dataSourceDiscountOneTimeUse,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!1,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){i=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"discountOneTimeUseName",caption:"Name",width:"150"},{dataField:"group",caption:"Group",width:"80"},{dataField:"couponAmountOff",caption:"AmountOff",dataType:"number",alignment:"center",format:"currency",precision:2},{dataField:"couponPercentOff",caption:"PercentOff",dataType:"number",alignment:"center",format:"fixedPoint",precision:2},{dataField:"couponCode",caption:"Code"},{dataField:"usedOn",caption:"UsedOn",alignment:"center",dataType:"date"},],onRowClick:function(n){var i=n.data,r=ko.mapping.toJSON(i);ko.mapping.fromJSON(r,{},t.dataSetUpModalDiscountOneTimeUse);vmViewIndex.allSetting.disableButtonSubmit(!1);t.dataSetUpModalDiscountOneTimeUse.isUse()&&vmViewIndex.allSetting.disableButtonSubmit(!0);t.dataSetUpModalDiscountOneTimeUse.discountGroup(t.discountGroup.slice(0));t.dataSetUpModalDiscountOneTimeUse.termsAmountMin()==0&&t.dataSetUpModalDiscountOneTimeUse.isUnlimitMin(!0);t.dataSetUpModalDiscountOneTimeUse.termsAmountMax()==0&&t.dataSetUpModalDiscountOneTimeUse.isUnlimitMax(!0);t.dataSetUpModalDiscountOneTimeUse.shippingTypeId(shippingType.cAll);t.dataSetUpModalDiscountOneTimeUse.isPickup()&&!t.dataSetUpModalDiscountOneTimeUse.isDelivery()?t.dataSetUpModalDiscountOneTimeUse.shippingTypeId(shippingType.cPickUp):!t.dataSetUpModalDiscountOneTimeUse.isPickup()&&t.dataSetUpModalDiscountOneTimeUse.isDelivery()&&t.dataSetUpModalDiscountOneTimeUse.shippingTypeId(shippingType.cDelivery);t.dataSetUpModalDiscountOneTimeUse.startDate(moment(new Date(t.dataSetUpModalDiscountOneTimeUse.startDate())).format());t.dataSetUpModalDiscountOneTimeUse.endDate(moment(new Date(t.dataSetUpModalDiscountOneTimeUse.endDate())).format());$("#modalSetUpDiscountOneTimeUse").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnUpdate(!0);t.chkBtnAdd(!1)},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.allSetting.disableButtonSubmit(!1);t.dataSetUpModalDiscountOneTimeUse.discountGroup(t.discountGroup.slice(0));$("#modalSetUpDiscountOneTimeUse").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnAdd(!0);t.chkBtnUpdate(!1)}}},{location:"before",template:function(){return $("<div/>").addClass("informer").append($("<h2 />").text("Select Group : "))}},{widget:"dxSelectBox",location:"before",options:t.filterDiscount})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$("#gridDiscountOneTimeUse .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.dataGridMainPrice=ko.observable({dataSource:t.dataMainPrice,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!1,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){i=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"priceMin",caption:"Price Min",width:"350",dataType:"number",alignment:"center",format:"currency",precision:2},{dataField:"priceMax",caption:"Price Max",width:"350",dataType:"number",alignment:"center",format:"currency",precision:2},],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(n){var i=n.data,r=ko.mapping.toJSON(i);ko.mapping.fromJSON(r,{},t.dataSetUpMainPrice);t.dataSetUpMainPrice.isUnlimitPriceMin(t.dataSetUpMainPrice.priceMin()=="0.00"?!0:!1);t.dataSetUpMainPrice.isUnlimitPriceMax(t.dataSetUpMainPrice.priceMax()=="0.00"?!0:!1);vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalMainPriceSetup").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnUpdate(!0);t.chkBtnAdd(!1)},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({location:"before",template:function(){return $("<div/>").addClass("informer").append($("<h2 />").text("Please setting Main Price before setting Condition."))}},{widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.allSetting.disableButtonSubmit(!1);t.dataMainPrice().length>0&&vmViewIndex.allSetting.disableButtonSubmit(!0);$("#modalMainPriceSetup").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnAdd(!0);t.chkBtnUpdate(!1)}}})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$("#gridMainPrice .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.dataGridGroupMainFood=ko.observable({dataSource:t.dataGroupMainFood,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!1,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){i=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"promotionGroupMainFoodName",caption:"Group Name",width:"150"},{dataField:"strMainFoodName",caption:"Main Food",width:"585"},],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(n){var r=n.data,u=ko.mapping.toJSON(r),i;ko.mapping.fromJSON(u,{},t.dataSetUpGroupMainFood);i=t.dataArrMainFood.slice(0);ko.utils.arrayForEach(t.dataSetUpGroupMainFood.listPromotionMainFood(),function(n){var t=i.findIndex(function(t){return t.foodId()==n.foodId()});i.splice(t,1)});t.dataSetUpGroupMainFood.arrMainFood(i.slice(0));vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalGroupMainFoodSetup").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnUpdate(!0);t.chkBtnAdd(!1)},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({location:"before",template:function(){return $("<div/>").addClass("informer").append($("<h2 />").text("Please setting Group Main Food before setting Condition."))}},{widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.allSetting.disableButtonSubmit(!1);t.dataSetUpGroupMainFood.arrMainFood(t.dataArrMainFood.slice(0));$("#modalGroupMainFoodSetup").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnAdd(!0);t.chkBtnUpdate(!1)}}})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$("#gridGroupMainFood .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.dataGridGroupFreeFood=ko.observable({dataSource:t.dataGroupFreeFood,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!1,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){i=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"promotionGroupFreeFoodName",caption:"Group Name",width:"150"},{dataField:"strFreeFoodName",caption:"Main Food",width:"585"},],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(n){var r=n.data,u=ko.mapping.toJSON(r),i;ko.mapping.fromJSON(u,{},t.dataSetUpGroupFreeFood);i=t.dataArrFreeFood.slice(0);ko.utils.arrayForEach(t.dataSetUpGroupFreeFood.listPromotionFreeFood(),function(n){var t=i.findIndex(function(t){return t.foodId()==n.foodId()});i.splice(t,1)});t.dataSetUpGroupFreeFood.arrFreeFood(i.slice(0));vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalGroupFreeFoodSetup").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnUpdate(!0);t.chkBtnAdd(!1)},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({location:"before",template:function(){return $("<div/>").addClass("informer").append($("<h2 />").text("Please setting Group Free Food first."))}},{widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.allSetting.disableButtonSubmit(!1);t.dataSetUpGroupFreeFood.arrFreeFood(t.dataArrFreeFood.slice(0));$("#modalGroupFreeFoodSetup").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnAdd(!0);t.chkBtnUpdate(!1)}}})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$("#gridGroupFreeFood .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.dataGridConditionMainPrice=ko.observable({dataSource:t.dataConditionMainPrice,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!1,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){i=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"strMainPriceName",caption:"Main Price",alignment:"center",width:"150"},{dataField:"strGrpFreeFoodName",caption:"Group FreeFood Name",alignment:"center",width:"250"},{dataField:"isAutoFree",caption:"Auto Free",alignment:"center",width:"80"},{dataField:"active",caption:"Active",alignment:"center",width:"80"},{dataField:"startDate",caption:"StartDate",alignment:"center",dataType:"date",width:"100"},{dataField:"endDate",caption:"EndDate",alignment:"center",dataType:"date",width:"100"},],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(n){var u=n.data,f=ko.mapping.toJSON(u),i,r;ko.mapping.fromJSON(f,{},t.dataSetUpCondition);t.dataSetUpCondition.isTermsPrice(!0);t.dataSetUpCondition.isTermsFood(!1);t.dataSetUpCondition.tempListMainPrice(t.dataMainPrice.slice(0));t.dataSetUpCondition.tempListGroupFreeFood(t.dataGroupFreeFood.slice(0));t.dataSetUpCondition.isEmptyMainPrice(t.dataSetUpCondition.tempListMainPrice().length==0?!0:!1);t.dataSetUpCondition.isEmptyGrpFreeFood(t.dataSetUpCondition.tempListGroupFreeFood().length==0?!0:!1);vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalConditionSetup").modal({keyboard:!1,backdrop:"static",show:!0});t.dataSetUpCondition.isEmptyMainPrice()==!1&&(i=t.dataSetUpCondition.tempListMainPrice().findIndex(function(n){return n.promotionMainPriceId()==t.dataSetUpCondition.promotionMainPriceId()}),$(".cardPrice").find("div.card.card-body.form-group.card-price")[i].classList.add("card-active"));t.dataSetUpCondition.isEmptyGrpFreeFood()==!1&&(r=$(".cardFreeFood").find("div.card.form-group.card-food"),ko.utils.arrayForEach(t.dataSetUpCondition.listPromotionGroupFreeFood(),function(n){var i=t.dataSetUpCondition.tempListGroupFreeFood().findIndex(function(t){return t.promotionGroupFreeFoodId()==n});r[i].classList.add("card-active")}));t.chkBtnUpdate(!0);t.chkBtnAdd(!1)},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalConditionSetup").modal({keyboard:!1,backdrop:"static",show:!0});t.dataSetUpCondition.isTermsPrice(!0);t.dataSetUpCondition.isTermsFood(!1);t.dataSetUpCondition.promotionTypeId(cConditionPrice);t.dataSetUpCondition.tempListMainPrice(t.dataMainPrice.slice(0));t.dataSetUpCondition.tempListGroupFreeFood(t.dataGroupFreeFood.slice(0));t.dataSetUpCondition.isEmptyMainPrice(t.dataSetUpCondition.tempListMainPrice().length==0?!0:!1);t.dataSetUpCondition.isEmptyGrpFreeFood(t.dataSetUpCondition.tempListGroupFreeFood().length==0?!0:!1);t.dataSetUpCondition.isEmptyMainPrice()||(t.dataSetUpCondition.promotionMainPriceId(_.first(t.dataSetUpCondition.tempListMainPrice()).promotionMainPriceId()),t.dataSetUpCondition.promotionTypeId(cConditionPrice),$(".cardPrice").find("div.card.card-body.form-group.card-price")[0].classList.add("card-active"));t.chkBtnAdd(!0);t.chkBtnUpdate(!1)}}})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$("#gridConditionMainPrice .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.dataGridConditionMainFood=ko.observable({dataSource:t.dataConditionMainFood,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!1,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){i=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"strGrpMainFoodName",caption:"Group MainFood Name",alignment:"center",width:"180"},{dataField:"strGrpFreeFoodName",caption:"Group FreeFood Name",alignment:"center",width:"180"},{dataField:"isAutoFree",caption:"Auto Free",alignment:"center",width:"80"},{dataField:"active",caption:"Active",alignment:"center",width:"80"},{dataField:"startDate",caption:"StartDate",alignment:"center",dataType:"date",width:"100"},{dataField:"endDate",caption:"EndDate",alignment:"center",dataType:"date",width:"100"},],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(n){var r=n.data,u=ko.mapping.toJSON(r),i;ko.mapping.fromJSON(u,{},t.dataSetUpCondition);t.dataSetUpCondition.isTermsPrice(!1);t.dataSetUpCondition.isTermsFood(!0);t.dataSetUpCondition.tempListGroupMainFood(t.dataGroupMainFood().slice(0));t.dataSetUpCondition.tempListGroupFreeFood(t.dataGroupFreeFood().slice(0));t.dataSetUpCondition.isEmptyGrpMainFood(t.dataSetUpCondition.tempListGroupMainFood().length==0?!0:!1);t.dataSetUpCondition.isEmptyGrpFreeFood(t.dataSetUpCondition.tempListGroupFreeFood().length==0?!0:!1);vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalConditionSetup").modal({keyboard:!1,backdrop:"static",show:!0});t.dataSetUpCondition.isEmptyGrpMainFood()==!1&&(i=$(".cardMainFood").find("div.card.form-group.card-food"),ko.utils.arrayForEach(t.dataSetUpCondition.listPromotionGroupMainFood(),function(n){var r=t.dataSetUpCondition.tempListGroupMainFood().findIndex(function(t){return t.promotionGroupMainFoodId()==n});i[r].classList.add("card-active")}));t.dataSetUpCondition.isEmptyGrpFreeFood()==!1&&(i=$(".cardFreeFood").find("div.card.form-group.card-food"),ko.utils.arrayForEach(t.dataSetUpCondition.listPromotionGroupFreeFood(),function(n){var r=t.dataSetUpCondition.tempListGroupFreeFood().findIndex(function(t){return t.promotionGroupFreeFoodId()==n});i[r].classList.add("card-active")}));t.chkBtnUpdate(!0);t.chkBtnAdd(!1)},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.allSetting.disableButtonSubmit(!1);$("#modalConditionSetup").modal({keyboard:!1,backdrop:"static",show:!0});t.dataSetUpCondition.isTermsPrice(!1);t.dataSetUpCondition.isTermsFood(!0);t.dataSetUpCondition.promotionTypeId(cConditionFood);t.dataSetUpCondition.tempListGroupMainFood(t.dataGroupMainFood().slice(0));t.dataSetUpCondition.tempListGroupFreeFood(t.dataGroupFreeFood().slice(0));t.dataSetUpCondition.isEmptyGrpMainFood(t.dataSetUpCondition.tempListGroupMainFood().length==0?!0:!1);t.dataSetUpCondition.isEmptyGrpFreeFood(t.dataSetUpCondition.tempListGroupFreeFood().length==0?!0:!1);t.chkBtnAdd(!0);t.chkBtnUpdate(!1)}}})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$("#gridConditionMainFood .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.dataGridShopClose=ko.observable({dataSource:t.dataShopClose,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!1,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){i=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"startDate",caption:"StartDate",alignment:"center",dataType:"date",width:"200"},{dataField:"endDate",caption:"EndDate",alignment:"center",dataType:"date",width:"200"},{dataField:"reason",caption:"CloseReason",width:"200"},{dataField:"time",caption:"",width:80,alignment:"center"}],onCellPrepared:function(n){var i=n.column,r=n.value,t="";i.dataField==="time"&&(isEmpty(r)||(t="<span><i class='fa fa-trash fa-lg' style='color:red;'><\/i><\/span>",n.cellElement.html(t)))},onCellClick:function(n){var r=n.data,u,f,i;n.rowType=="data"&&n.column.dataField=="time"?(u="",u=r.time().length==1?_.first(r.time()).shopCloseId():r.time()[0].shopCloseId()+","+r.time()[1].shopCloseId(),swalConfirmDeleteShopClose(cfrmDeleteShopClose,u)):n.rowType=="data"&&(f=ko.mapping.toJSON(r),ko.mapping.fromJSON(f,{},t.dataSetUpModalShopClose),i=r.time(),i.sort(function(n,t){var i=moment(n.startTimePmAm(),moment_time_format_hhmmssa),r=moment(t.startTimePmAm(),moment_time_format_hhmmssa);return i>r?1:-1}),t.dataSetUpModalShopClose.shopCloseIdFirst(_.first(i).shopCloseId()),t.dataSetUpModalShopClose.hasShowSecondTime(!0),_.first(i).startTime()==time_start_24h&&_.first(i).endTime()==time_end_24h?(t.dataSetUpModalShopClose.valActive24Hour(!0),t.dataSetUpModalShopClose.valFirstHourStartTime(moment(time_start_24h,moment_time_format_hhmmss)),t.dataSetUpModalShopClose.valFirstHourEndTime(moment(time_end_24h,moment_time_format_hhmmss))):(t.dataSetUpModalShopClose.valActive24Hour(!1),t.dataSetUpModalShopClose.valFirstHourStartTime(moment(_.first(i).startTime(),moment_time_format_hhmmss)),t.dataSetUpModalShopClose.valFirstHourEndTime(moment(_.first(i).endTime(),moment_time_format_hhmmss))),i.length>1&&(t.dataSetUpModalShopClose.valSecondHourStartTime(moment(i[1].startTime(),moment_time_format_hhmmss)),t.dataSetUpModalShopClose.valSecondHourEndTime(moment(i[1].endTime(),moment_time_format_hhmmss)),t.dataSetUpModalShopClose.shopCloseIdSecond(i[1].shopCloseId()),t.dataSetUpModalShopClose.hasShowSecondTime(!1)),vmViewIndex.allSetting.disableButtonSubmit(!1),$("#modalSetUpShopClose").modal({keyboard:!1,backdrop:"static",show:!0}),t.chkBtnUpdate(!0),t.chkBtnAdd(!1))},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.allSetting.disableButtonSubmit(!1);t.dataSetUpModalShopClose.valFirstHourStartTime(moment(time_start_24h,moment_time_format_hhmmss));t.dataSetUpModalShopClose.valFirstHourEndTime(moment(time_end_24h,moment_time_format_hhmmss));t.dataSetUpModalShopClose.hasShowSecondTime(!0);$("#modalSetUpShopClose").modal({keyboard:!1,backdrop:"static",show:!0});t.chkBtnUpdate(!1);t.chkBtnAdd(!0)}}})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$("#gridShopClose .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.shippingType=ko.observable("2");t.isPickup=ko.observable(!1);t.isDelivery=ko.observable(!1);t.isPickupDelivery=ko.observable(!0);t.ckPickup=function(){return t.isPickup(!0),t.isDelivery(!1),t.isPickupDelivery(!1),t.shippingType("0"),!0};t.ckDelivery=function(){return t.isPickup(!1),t.isDelivery(!0),t.isPickupDelivery(!1),t.shippingType("1"),!0};t.ckPickupDelivery=function(){return t.isPickup(!1),t.isDelivery(!1),t.isPickupDelivery(!0),t.shippingType("2"),!0};t.showGuestCheckOut=ko.observable("1");t.isShowGuestCheckOut=ko.observable(!0);t.ckShowGuest=function(){return t.isShowGuestCheckOut(!0),t.showGuestCheckOut("1"),!0};t.ckHideGuest=function(){return t.isShowGuestCheckOut(!1),t.showGuestCheckOut("0"),!0};t.isMultiProduct=ko.observable(!1);t.isSmileDining=ko.observable(!0);t.selectProduct=ko.observable();var y=filterGlobalConfig(n,"productID"),h=y.split(","),p=checkMultiProduct(h),w=checkIsSmileDining(h,"");t.isMultiProduct(p);t.isSmileDining(w);t.filterProduct=new ProductViewModel(t,cfrmMySetting);t.fileNameBackground=ko.observable("");t.fileTypeBackground=ko.observable("");t.chooseImageBackground=function(n,i){if(i.target.file!="undefined"){vmViewIndex.showLoading(!0);t.fileNameBackground(_.first(i.target.files).name);t.fileTypeBackground(_.first(i.target.files).type);var r=URL.createObjectURL(_.first(i.target.files));$("#imgBgCropContainer").attr("src",r);$("#imgBgCropMobileContainer").attr("src",r);setTimeout(function(){$("#modalUploadImageBackground").modal("show")},500)}};var u=null,c=null,f=null,l=document.getElementById("imgBgCropContainer"),b=document.getElementById("imgBgCropMobileContainer"),e=[],a={viewMode:3,background:!1,cropBoxResizable:!1,guides:!1,center:!1,autoCropArea:1,dragMode:"move"},k={aspectRatio:414/248,viewMode:3,background:!1,cropBoxResizable:!1,guides:!1,center:!1,autoCropArea:0,minCropBoxWidth:414,minCropBoxHeight:248,dragMode:"move"};$("#modalUploadImageBackground").on("shown.bs.modal",function(){t.mobileCropMode()?t.mobileCropMode(!1):(u=new Cropper(l,a),vmViewIndex.showLoading(!1))}).on("hidden.bs.modal",function(){t.mobileCropMode()?(f.destroy(),f=null):(u.destroy(),u=null);$("#uploadImageBackground").val("");$("#modalUploadImageBackground .drag-container").removeClass("d-none");isEmpty(vmViewIndex.globalConfig.shopBackground())?$("#showUploadImageBackground").text(""):$("#showUploadImageBackground").text(vmViewIndex.globalConfig.shopBackground())});t.mobileCropMode=ko.observable(!1);t.switchMobileCropMode=ko.observable({switchedOffText:"OFF",switchedOnText:"ON",value:t.mobileCropMode,width:55,onValueChanged:function(n){vmViewIndex.showLoading(!0);n.value==!0?(t.mobileCropMode(!0),setTimeout(function(){f=new Cropper(b,k);$("#modalUploadImageBackground .drag-container").addClass("mobile");$("#modalUploadImageBackground .drag-container").removeClass("d-none");vmViewIndex.showLoading(!1)},200),c=u.getCroppedCanvas({width:1920,height:639}),u.destroy(),u=null):(t.mobileCropMode(!1),setTimeout(function(){u=new Cropper(l,a);$("#modalUploadImageBackground .drag-container").removeClass("mobile");$("#modalUploadImageBackground .drag-container").removeClass("d-none");vmViewIndex.showLoading(!1)},200),isEmpty(f)||(f.destroy(),f=null))}});$("#btnCropImageBackground").click(function(){e=[];canvas=t.mobileCropMode()?c:u.getCroppedCanvas({width:1920,height:639});canvas.toBlob(function(n){url=URL.createObjectURL(n);var t=new FileReader;t.readAsDataURL(n);t.onloadend=function(){const n=t.result;v(n)}})});t.submitUploadImageBackground=function(n){var r,u,t,f,i;if(!checkInternetConnection())return r=new ObjAlert(formId,cError_Fail_NoInternet,!1),r.getAlert(),!1;if(u=$("#"+cfrmUploadImageBackgroundSetting).parent(),t=new ObjValidateForm(cfrmUploadImageBackgroundSetting,u),vmViewIndex.disablePointer("default"),t.verifyData(),t.error.length>0)return t.showAlert&&(f=convertArrToString(t.error),swal(cSwal_Alert_Error,replaceNewLineToBr(f),cSwal_Icon_Error)),vmViewIndex.disablePointer("pointer"),!1;addSpinButton("modalUploadImageBackground");var e=new FormData,o=new ObjUrl(cfrmUploadImageBackgroundSetting),s=o.getUrlSubmitForm();for(i=0;i<n.length;i++)e.append("uploadImageBackground",n[i]);$.ajax({url:s,async:ajax_async,cache:ajax_cache,type:ajax_type_post,data:e,processData:!1,contentType:!1,timeout:ajax_timeout}).done(function(n){n.status&&(vmViewIndex.globalConfig.shopBackground(n.filename),vmViewIndex.globalConfig.delShopBackground(!0));$("#modalUploadImageBackground").modal("hide");var t=new ObjAlert(cfrmUploadImageBackgroundSetting,n.message,n.status);t.getAlert();removeSpinButton("modalUploadImageBackground");vmViewIndex.disablePointer("pointer")}).fail(function(){$("#modalUploadImageBackground").modal("hide");var n=new ObjAlert(formId,cError_Fail_TimeOut,!1);n.getAlert();removeSpinButton("modalUploadImageBackground");vmViewIndex.disablePointer("pointer")})};$("#modalUploadImageBackground .drag-container").click(function(){$(this).addClass("d-none")})}function SetupCouponDeliveryViewModel(n){var t=this;t.dataDiscountType=ko.observableArray([]);t.couponDeliveryId=ko.observable("");t.couponDeliveryName=ko.observable("");t.couponDeliveryDesc=ko.observable("");t.discountTypeId=ko.observable(3);t.isTotal=ko.observable(!1);t.totalCoupon=ko.observable(0);t.isMinimum=ko.observable(!1);t.minimumOrder=ko.observable(0).extend({numeric:2});t.amountOff=ko.observable(0).extend({numeric:2});t.percentOff=ko.observable(0).extend({numeric:0});t.isAmount=ko.observable(!1);t.isPercent=ko.observable(!1);t.isFree=ko.observable(!1);t.couponDeliveryCode=ko.observable("");t.startDate=ko.observable(moment(new Date).format("L"));t.endDate=ko.observable(moment(new Date).format("L"));t.active=ko.observable(!0);t.currentDate=ko.observable(moment(n).format("MM/DD/YYYY"));t.btnActive=ko.observable({offText:"NO",onText:"YES",value:t.active,width:switchActiveWidth55px,onValueChanged:function(n){n.value==!0?t.active(!0):t.active(!1)}});t.dxStartDate=ko.observable({acceptCustomValue:!1,width:"auto",pickerType:"calendar",type:"date",min:t.currentDate,value:t.startDate,onValueChanged:function(n){(n.value===""||n.value===null||n.value===undefined)&&n.component.option("isValid",!1);t.startDate(moment(new Date(n.value)).format())},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});t.dxEndDate=ko.observable({acceptCustomValue:!1,width:"auto",min:t.startDate,pickerType:"calendar",type:"date",value:t.endDate,onValueChanged:function(n){(n.value===""||n.value===null||n.value===undefined)&&n.component.option("isValid",!1);t.endDate(moment(new Date(n.value)).format())},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});t.ckTotal=function(){return t.isTotal()==!1&&(t.totalCoupon(0),removeClassValidationError(cfrmTotalCouponDelivery)),!0};t.ckMinimum=function(){return t.isMinimum()==!1&&(t.minimumOrder(0),removeClassValidationError(cfrmMinimumOrderCouponDelivery)),!0};t.ckFree=function(){return t.isFree(!0),t.isAmount(!1),t.isPercent(!1),t.amountOff(0),t.percentOff(0),removeClassValidationError(cfrmAmountOffCouponDelivery),removeClassValidationError(cfrmPercentOffCouponDelivery),!0};t.ckAmountOff=function(){return t.isFree(!1),t.isPercent(!1),t.isAmount(!0),t.percentOff(0),removeClassValidationError(cfrmPercentOffCouponDelivery),!0};t.ckPercentOff=function(){return t.isFree(!1),t.isPercent(!0),t.isAmount(!1),t.amountOff(0),removeClassValidationError(cfrmAmountOffCouponDelivery),!0};t.btnCloseSetup=function(){t.clearSetUp()};t.selectDiscountType=ko.observable({acceptCustomValue:!1,dataSource:t.dataDiscountType,displayExpr:"discountTypeName",value:t.discountTypeId,valueExpr:"discountTypeId",dropDownButtonTemplate:"dropDownButton",onItemClick:function(n){n.itemData!=null&&(n.itemData.discountTypeId()==1?vmViewIndex.allSetting.dataViewModelCouponDelivery.discountTypeId(1):n.itemData.discountTypeId()==2?vmViewIndex.allSetting.dataViewModelCouponDelivery.discountTypeId(2):n.itemData.discountTypeId()==4?vmViewIndex.allSetting.dataSetUpModal.discountTypeId(4):vmViewIndex.allSetting.dataViewModelCouponDelivery.discountTypeId(3))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()}});t.clearSetUp=function(){var n=this;n.couponDeliveryId("");n.couponDeliveryName("");n.couponDeliveryDesc("");n.discountTypeId(3);n.isTotal(!1);n.totalCoupon(0);n.isMinimum(!1);n.minimumOrder(0);n.amountOff(0);n.percentOff(0);n.isAmount(!1);n.isPercent(!1);n.isFree(!1);n.couponDeliveryCode("");n.startDate(moment(new Date).format("L"));n.endDate(moment(new Date).format("L"));n.active(!0)}}function SetUpDiscountViewModel(){var n=this;n.dataDiscountType=ko.observableArray([]);n.discountId=ko.observable("");n.discountName=ko.observable("");n.discountDesc=ko.observable("");n.discountTypeId=ko.observable(3);n.isCouponAmtOff=ko.observable(!0);n.isCouponPercentOff=ko.observable(!1);n.couponAmountOff=ko.observable(0).extend({numeric:2});n.couponPercentOff=ko.observable(0).extend({numeric:2});n.couponCode=ko.observable("");n.startDate=ko.observable(moment(new Date).format("L"));n.endDate=ko.observable(moment(new Date).format("L"));n.active=ko.observable(!0);n.isTotal=ko.observable(!1);n.totalCoupon=ko.observable(0);n.isAutoDiscount=ko.observable(!1);n.isCouponDiscount=ko.observable(!0);n.termsAmountMin=ko.observable(0).extend({numeric:2});n.termsAmountMax=ko.observable(0).extend({numeric:2});n.isUnlimitMin=ko.observable(!1);n.isUnlimitMax=ko.observable(!1);n.isPickup=ko.observable(!0);n.isDelivery=ko.observable(!0);n.shippingType=ko.observableArray([]);n.shippingTypeId=ko.observable(shippingType.cAll);n.shippingType([{name:shippingType.mapName[shippingType.cAll].name,id:shippingType.cAll},{name:shippingType.mapName[shippingType.cPickUp].name,id:shippingType.cPickUp},{name:shippingType.mapName[shippingType.cDelivery].name,id:shippingType.cDelivery}]);n.clickIsCouponAmtOff=function(){return n.isCouponAmtOff(!0),n.isCouponPercentOff(!1),n.couponPercentOff(0),!0};n.clickIsCouponPercentOff=function(){return n.isCouponPercentOff(!0),n.isCouponAmtOff(!1),n.couponAmountOff(0),!0};n.clickIsAutoDiscount=function(t){var i=t.allSetting.dataSetUpModal.isAutoDiscount();return i?(n.isAutoDiscount(!0),n.isCouponDiscount(!1),n.checkRangDiscount(),n.isTotal(!1)):(n.isAutoDiscount(!1),n.isCouponDiscount(!0),vmViewIndex.allSetting.disableButtonSubmit(!1)),n.couponCode(""),n.termsAmountMin(0),n.termsAmountMax(0),n.isUnlimitMin(!0),n.isUnlimitMax(!0),n.totalCoupon(0),!0};n.clickIsUnlimitMin=function(t){var i=t.allSetting.dataSetUpModal.isUnlimitMin();return n.termsAmountMin(0),n.isAutoDiscount()&&n.checkRangDiscount(),!0};n.clickIsUnlimitMax=function(t){var i=t.allSetting.dataSetUpModal.isUnlimitMax();return n.termsAmountMax(0),n.isAutoDiscount()&&n.checkRangDiscount(),!0};n.isCloseDiscount=ko.observable(!1);n.dxStartDate=ko.observable({acceptCustomValue:!1,width:"auto",pickerType:"calendar",type:"date",value:n.startDate,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.startDate(moment(new Date(t.value)).format())},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.dxEndDate=ko.observable({acceptCustomValue:!1,width:"auto",min:n.startDate,pickerType:"calendar",type:"date",value:n.endDate,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.endDate(moment(new Date(t.value)).format())},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.selectDiscountType=ko.observable({acceptCustomValue:!1,dataSource:n.dataDiscountType,displayExpr:"discountTypeName",value:n.discountTypeId,valueExpr:"discountTypeId",dropDownButtonTemplate:"dropDownButton",onItemClick:function(n){n.itemData!=null&&(n.itemData.discountTypeId()==1?vmViewIndex.allSetting.dataSetUpModal.discountTypeId(1):n.itemData.discountTypeId()==2?vmViewIndex.allSetting.dataSetUpModal.discountTypeId(2):n.itemData.discountTypeId()==4?vmViewIndex.allSetting.dataSetUpModal.discountTypeId(4):vmViewIndex.allSetting.dataSetUpModal.discountTypeId(3))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()}});n.selectShippingType=ko.observable({acceptCustomValue:!1,dataSource:n.shippingType,displayExpr:"name",value:n.shippingTypeId,valueExpr:"id",dropDownButtonTemplate:"dropDownButton",onItemClick:function(t){t.itemData!=null&&(t.itemData.id==shippingType.cPickUp?(vmViewIndex.allSetting.dataSetUpModal.shippingTypeId(shippingType.cPickUp),vmViewIndex.allSetting.dataSetUpModal.isPickup(!0),vmViewIndex.allSetting.dataSetUpModal.isDelivery(!1)):t.itemData.id==shippingType.cDelivery?(vmViewIndex.allSetting.dataSetUpModal.shippingTypeId(shippingType.cDelivery),vmViewIndex.allSetting.dataSetUpModal.isPickup(!1),vmViewIndex.allSetting.dataSetUpModal.isDelivery(!0)):(vmViewIndex.allSetting.dataSetUpModal.shippingTypeId(shippingType.cAll),vmViewIndex.allSetting.dataSetUpModal.isPickup(!0),vmViewIndex.allSetting.dataSetUpModal.isDelivery(!0)),n.isAutoDiscount()&&n.checkRangDiscount())},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()}});n.btnActive=ko.observable({offText:"NO",onText:"YES",value:n.active,width:switchActiveWidth60px,onValueChanged:function(t){t.value==!0?n.active(!0):n.active(!1);n.isAutoDiscount()&&n.checkRangDiscount()}});n.clickIsTotal=function(){return n.isTotal()==!1&&n.totalCoupon(0),!0};n.btnCloseSetUpDiscount=function(){n.isCloseDiscount(!0);n.clearSetUpDiscount();n.isCloseDiscount(!1);vmViewIndex.allSetting.disableButtonSubmit(!1)};n.clearSetUpDiscount=function(){var n=this;n.isCloseDiscount(!0);n.active(!0);n.discountId("");n.discountName("");n.discountDesc("");n.discountTypeId(3);n.isCouponAmtOff(!0);n.isCouponPercentOff(!1);n.couponAmountOff(0);n.couponPercentOff(0);n.couponCode("");n.startDate(moment(new Date).format("L"));n.endDate(moment(new Date).format("L"));n.isAutoDiscount(!1);n.isCouponDiscount(!0);n.termsAmountMin(0);n.termsAmountMax(0);n.isUnlimitMin(!1);n.isUnlimitMax(!1);n.isPickup(!0);n.isDelivery(!0);n.shippingTypeId(shippingType.cAll);n.isTotal(!1);n.totalCoupon(0);removeClassValidationError("#txtDiscount_DiscountAmountOff");removeClassValidationError("#txtDiscount_DiscountPercentOff")};n.checkRangDiscount=function(){var t,f,p;if(n.isCloseDiscount()==!1){if(vmViewIndex.allSetting.disableButtonSubmit(!1),isNaN(n.termsAmountMin())||isNaN(n.termsAmountMax()))return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscountMinMax_Empty,!1),!0;if(Number(n.termsAmountMin())>=Number(n.termsAmountMax())&&Number(n.termsAmountMax()!=0))return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscountMin_LessMax,!1),!1;var y=vmViewIndex.allSetting.data(),i=vmViewIndex.allSetting.dataSetUpModal.discountId(),o=_.filter(y,function(n){return n.couponCode()==null}),s=_.filter(y,function(n){return n.discountId()==i}),e;vmViewIndex.allSetting.dataSetUpModal.shippingTypeId()==shippingType.cAll&&(e=o);vmViewIndex.allSetting.dataSetUpModal.shippingTypeId()==shippingType.cPickUp&&(e=_.filter(o,function(n){return n.isPickup()==!0}));vmViewIndex.allSetting.dataSetUpModal.shippingTypeId()==shippingType.cDelivery&&(e=_.filter(o,function(n){return n.isDelivery()==!0}));var u=_.orderBy(e,function(n){return n.termsAmountMin()}),h=_.filter(u,function(n){return n.termsAmountMin()==0&&n.termsAmountMax()==0&&n.active()==!0&&n.discountId()!=i}),r=_.filter(u,function(n){return n.termsAmountMin()!=0&&n.termsAmountMax()==0});if(r.length!=0&&n.termsAmountMax()!=0&&(r=_.filter(r,function(t){return parseFloat(n.termsAmountMin())>=parseFloat(t.termsAmountMin())||parseFloat(n.termsAmountMax())>=parseFloat(t.termsAmountMin())})),r.length!=0&&(r=_.filter(r,function(n){return n.discountId()!=i})),t=_.filter(u,function(n){return n.termsAmountMin()==0&&n.termsAmountMax()!=0}),t.length!=0&&(t=_.filter(t,function(t){return parseFloat(n.termsAmountMax())!=0&&parseFloat(n.termsAmountMax())<=parseFloat(t.termsAmountMax())||parseFloat(n.termsAmountMin())<=parseFloat(t.termsAmountMax())})),t.length!=0&&(t=_.filter(t,function(n){return n.discountId()!=i})),f=_.filter(u,function(n){return n.termsAmountMin()!=0&&n.termsAmountMax()!=0}),p=_.filter(u,function(n){return(n.termsAmountMin()!=0||n.termsAmountMax()!=0)&&n.active()==!0}),p.length!=0&&vmViewIndex.allSetting.dataSetUpModal.active()==!0&&parseFloat(vmViewIndex.allSetting.dataSetUpModal.termsAmountMax())==0&&parseFloat(vmViewIndex.allSetting.dataSetUpModal.termsAmountMin())==0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_CustomDiscount_InRange,!1),!1;if(h.length!=0)if(s.length!=0){if(vmViewIndex.allSetting.dataSetUpModal.active()!=_.first(s).active()||_.first(s).couponCode()!=null)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+_.first(h).discountName()+'" ',!1),!1}else return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+_.first(h).discountName()+'" ',!1),!1;else{if(r!=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+_.first(r).discountName()+'" ',!1),!1;if(t!=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+_.first(t).discountName()+'" ',!1),!1;var c=_.filter(f,function(t){return _.inRange(parseFloat(n.termsAmountMin()),parseFloat(t.termsAmountMin()),parseFloat(t.termsAmountMax())+.01)}),l=_.filter(f,function(t){return _.inRange(parseFloat(n.termsAmountMax()),parseFloat(t.termsAmountMin()),parseFloat(t.termsAmountMax())+.01)}),w=_.findIndex(c,function(n){return n.discountId()!=i}),b=_.findIndex(l,function(n){return n.discountId()!=i});if(c.length>0&&w>=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+c[w].discountName()+'" ',!1),!1;if(l.length>0&&b>=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+l[b].discountName()+'" ',!1),!1;if(Number(n.termsAmountMin())<Number(n.termsAmountMax())){var a=_.filter(f,function(t){return _.inRange(parseFloat(t.termsAmountMin()),parseFloat(n.termsAmountMin()),parseFloat(n.termsAmountMax())+.01)}),v=_.filter(f,function(t){return _.inRange(parseFloat(t.termsAmountMax()),parseFloat(n.termsAmountMin()),parseFloat(n.termsAmountMax())+.01)}),k=_.findIndex(a,function(n){return n.discountId()!=i}),d=_.findIndex(v,function(n){return n.discountId()!=i});if(a.length>0&&k>=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+a[k].discountName()+'" ',!1),!1;if(v.length>0&&d>=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+v[d].discountName()+'" ',!1),!1}}return!0}return!0}}function SetUpDiscountOneTimeUseViewModel(){var n=this;n.dataDiscountType=ko.observableArray([]);n.discountOneTimeUseId=ko.observable("");n.discountOneTimeUseName=ko.observable("");n.group=ko.observable(0);n.discountTypeId=ko.observable(3);n.isCouponAmtOff=ko.observable(!0);n.isCouponPercentOff=ko.observable(!1);n.couponAmountOff=ko.observable(0).extend({numeric:2});n.couponPercentOff=ko.observable(0).extend({numeric:2});n.couponCode=ko.observable("");n.startDate=ko.observable(moment(new Date).format("L"));n.endDate=ko.observable(moment(new Date).format("L"));n.usedOn=ko.observable("");n.isUse=ko.observable(!1);n.discountGroup=ko.observableArray([]);n.termsAmountMin=ko.observable(0).extend({numeric:2});n.termsAmountMax=ko.observable(0).extend({numeric:2});n.isUnlimitMin=ko.observable(!1);n.isUnlimitMax=ko.observable(!1);n.isPickup=ko.observable(!0);n.isDelivery=ko.observable(!0);n.shippingType=ko.observableArray([]);n.shippingTypeId=ko.observable(shippingType.cAll);n.shippingType([{name:shippingType.mapName[shippingType.cAll].name,id:shippingType.cAll},{name:shippingType.mapName[shippingType.cPickUp].name,id:shippingType.cPickUp},{name:shippingType.mapName[shippingType.cDelivery].name,id:shippingType.cDelivery}]);n.clickIsUnlimitMin=function(t){var i=t.allSetting.dataSetUpModalDiscountOneTimeUse.isUnlimitMin();return n.termsAmountMin(0),!0};n.clickIsUnlimitMax=function(t){var i=t.allSetting.dataSetUpModalDiscountOneTimeUse.isUnlimitMax();return n.termsAmountMax(0),!0};n.selectShippingType=ko.observable({acceptCustomValue:!1,dataSource:n.shippingType,displayExpr:"name",value:n.shippingTypeId,valueExpr:"id",dropDownButtonTemplate:"dropDownButton",onItemClick:function(n){n.itemData!=null&&(n.itemData.id==shippingType.cPickUp?(vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.shippingTypeId(shippingType.cPickUp),vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.isPickup(!0),vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.isDelivery(!1)):n.itemData.id==shippingType.cDelivery?(vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.shippingTypeId(shippingType.cDelivery),vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.isPickup(!1),vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.isDelivery(!0)):(vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.shippingTypeId(shippingType.cAll),vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.isPickup(!0),vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.isDelivery(!0)))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()}});n.dxStartDate=ko.observable({acceptCustomValue:!1,width:"auto",pickerType:"calendar",type:"date",value:n.startDate,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.startDate(moment(new Date(t.value)).format())},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.dxEndDate=ko.observable({acceptCustomValue:!1,width:"auto",min:n.startDate,pickerType:"calendar",type:"date",value:n.endDate,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.endDate(moment(new Date(t.value)).format())},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.selectDiscountType=ko.observable({acceptCustomValue:!1,dataSource:n.dataDiscountType,displayExpr:"discountTypeName",value:n.discountTypeId,valueExpr:"discountTypeId",dropDownButtonTemplate:"dropDownButton",onItemClick:function(n){n.itemData!=null&&(n.itemData.discountTypeId()==1?vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.discountTypeId(1):n.itemData.discountTypeId()==2?vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.discountTypeId(2):n.itemData.discountTypeId()==4?vmViewIndex.allSetting.dataSetUpModalDiscountOneTimeUse.discountTypeId(4):vmViewIndex.allSetting.dataSetUpModal.discountTypeId(3))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()}});n.selectDiscountGroup=ko.observable({acceptCustomValue:!1,dataSource:n.discountGroup,displayExpr:"value",value:n.group,valueExpr:"id",dropDownButtonTemplate:"dropDownButton",onItemClick:function(t){t.itemData!=null&&n.group()},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()}});n.clickAmt=function(){return n.isCouponAmtOff(!0),n.isCouponPercentOff(!1),n.couponPercentOff(0),!0};n.clickPercent=function(){return n.isCouponPercentOff(!0),n.isCouponAmtOff(!1),n.couponAmountOff(0),!0};n.btnCloseSetUpDiscountOneTimeUse=function(){n.clearSetUpDiscountOneTimeUse()};n.clearSetUpDiscountOneTimeUse=function(){n.discountOneTimeUseId("");n.discountOneTimeUseName("");n.group(0);n.discountTypeId(3);n.isCouponAmtOff(!0);n.isCouponPercentOff(!1);n.couponAmountOff(0);n.couponPercentOff(0);n.couponCode("");n.startDate(moment(new Date).format("L"));n.endDate(moment(new Date).format("L"));n.usedOn("");n.isUse(!1);n.termsAmountMin(0);n.termsAmountMax(0);n.isUnlimitMin(!1);n.isUnlimitMax(!1);n.isPickup(!0);n.isDelivery(!0);n.shippingTypeId(shippingType.cAll)}}function SetUpShopCloseViewModel(){var n=this;n.shopCloseIdFirst=ko.observable("");n.shopCloseIdSecond=ko.observable("");n.startDate=ko.observable(moment().format("L"));n.endDate=ko.observable(moment().format("L"));n.startTime=ko.observable(null);n.endTime=ko.observable(null);n.reason=ko.observable("");n.valFirstHourStartTime=ko.observable(null);n.valFirstHourEndTime=ko.observable(null);n.valSecondHourStartTime=ko.observable(null);n.valSecondHourEndTime=ko.observable(null);n.valActive24Hour=ko.observable(!0);n.hasShowSecondTime=ko.observable(!1);n.enableSaveChanges=ko.observable(!0);n.dateFromDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.startDate,width:150,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.startDate(moment(new Date(t.value)).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.dateEndDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.endDate,min:n.startDate,width:150,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.endDate(moment(new Date(t.value)).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.clickActive24Hour=ko.observable({offText:"NO",onText:"YES",value:n.valActive24Hour,width:switchActiveWidth55px,onValueChanged:function(n){var t=vmViewIndex.allSetting.dataSetUpModalShopClose;n.value==!0?(t.valFirstHourStartTime(moment(time_start_24h,moment_time_format_hhmmss)),t.valFirstHourEndTime(moment(time_end_24h,moment_time_format_hhmmss)),t.valSecondHourStartTime(null),t.valSecondHourEndTime(null),t.valActive24Hour(!0),t.hasShowSecondTime(!0)):t.valActive24Hour(!1)}});n.timeObj=ko.pureComputed(function(){var t;return t=n.valActive24Hour()?{active24Hour:n.valActive24Hour(),firstStart:moment(time_start_24h,moment_time_format_hhmmss).format(moment_time_format_HHmmss),firstEnd:moment(time_end_24h,moment_time_format_hhmmss).format(moment_time_format_HHmmss),secondStart:null,secondEnd:null,showSecondTime:!n.hasShowSecondTime()}:n.hasShowSecondTime()?{active24Hour:n.valActive24Hour(),firstStart:moment(n.valFirstHourStartTime()).format(moment_time_format_HHmmss),firstEnd:moment(n.valFirstHourEndTime()).format(moment_time_format_HHmmss),secondStart:null,secondEnd:null,showSecondTime:!n.hasShowSecondTime()}:{active24Hour:n.valActive24Hour(),firstStart:moment(n.valFirstHourStartTime()).format(moment_time_format_HHmmss),firstEnd:moment(n.valFirstHourEndTime()).format(moment_time_format_HHmmss),secondStart:moment(n.valSecondHourStartTime()).format(moment_time_format_HHmmss),secondEnd:moment(n.valSecondHourEndTime()).format(moment_time_format_HHmmss),showSecondTime:!n.hasShowSecondTime()},ko.toJSON(t)});n.clickShowSecondTime=function(){n.hasShowSecondTime(!1);n.valSecondHourStartTime(null);n.valSecondHourEndTime(null)};n.clickHiddenSecondTime=function(){n.hasShowSecondTime(!0);n.valSecondHourStartTime(null);n.valSecondHourEndTime(null)};n.valFirstHourStartTimeEdit=ko.observable({max:n.valFirstHourEndTime,pickerType:"list",type:"time",value:n.valFirstHourStartTime,disabled:n.valActive24Hour,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valFirstHourStartTime(t.value);n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.valFirstHourEndTimeEdit=ko.observable({min:n.valFirstHourStartTime,max:n.valSecondHourStartTime,type:"time",pickerType:"list",value:n.valFirstHourEndTime,disabled:n.valActive24Hour,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valFirstHourEndTime(t.value);n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.valSecondHourStartTimeEdit=ko.observable({min:n.valFirstHourEndTime,max:n.valSecondHourEndTime,type:"time",pickerType:"list",value:n.valSecondHourStartTime,disabled:n.valActive24Hour,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valSecondHourStartTime(t.value);n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.valSecondHourEndTimeEdit=ko.observable({min:n.valSecondHourStartTime,type:"time",pickerType:"list",value:n.valSecondHourEndTime,disabled:n.valActive24Hour,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valSecondHourEndTime(t.value);n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.btnCloseSetUpShopClose=function(){n.clearSetUpShopClose()};n.clearSetUpShopClose=function(){n.shopCloseIdFirst("");n.shopCloseIdSecond("");n.startDate(moment().format("L"));n.endDate(moment().format("L"));n.startTime(null);n.endTime(null);n.reason("");n.valFirstHourStartTime(moment(time_start_24h,moment_time_format_hhmmss));n.valFirstHourEndTime(moment(time_end_24h,moment_time_format_hhmmss));n.valSecondHourStartTime(null);n.valSecondHourEndTime(null);n.valActive24Hour(!0);n.hasShowSecondTime(!0);n.enableSaveChanges(!0)}}function SetUpAutoChargeViewModel(){var n=this;n.autoChargeId=ko.observable("");n.autoChargeName=ko.observable("");n.autoChargeDesc=ko.observable("");n.isAmtCharge=ko.observable(!0);n.isPercentCharge=ko.observable(!1);n.amountCharge=ko.observable(0).extend({numeric:2});n.percentCharge=ko.observable(0).extend({numeric:2});n.isTax=ko.observable(!1);n.taxCharge=ko.observable(0).extend({numeric:2});n.isPickUp=ko.observable(!1);n.isDelivery=ko.observable(!1);n.active=ko.observable(!0);n.clickIsAmtCharge=function(){return n.isAmtCharge(!0),n.isPercentCharge(!1),n.percentCharge(0),!0};n.clickIsPercentCharge=function(){return n.isAmtCharge(!1),n.isPercentCharge(!0),n.amountCharge(0),!0};n.btnActive=ko.observable({offText:"NO",onText:"YES",value:n.active,width:switchActiveWidth55px,onValueChanged:function(t){t.value==!0?n.active(!0):n.active(!1)}});n.btnCloseSetUpAutoCharge=function(){n.clearSetUpAutoCharge()};n.clearSetUpAutoCharge=function(){n.autoChargeId("");n.autoChargeName("");n.autoChargeDesc("");n.isAmtCharge(!0);n.isPercentCharge(!1);n.amountCharge("0.00");n.percentCharge("0.00");n.isTax(!1);n.taxCharge("0.00");n.isPickUp(!1);n.isDelivery(!1);n.active(!0);removeClassValidationError("#txtAutoCharge_AmountCharge");removeClassValidationError("#txtAutoCharge_PercentCharge");removeClassValidationError("#txtAutoCharge_TaxCharge")}}function SetUpHolidayViewModel(){var n=this;n.holidayId=ko.observable("");n.description=ko.observable("");n.startDate=ko.observable(moment().format("L"));n.endDate=ko.observable(moment().format("L"));n.active=ko.observable(!0);n.dateFromDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.startDate,width:150,invalidDateMessage:"Value must be a date",onValueChanged:function(t){t.value!=""&&t.value!=undefined?n.startDate(moment(t.value).format("L")):n.startDate(moment(new Date).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.dateEndDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.endDate,width:150,invalidDateMessage:"Value must be a date",onValueChanged:function(t){t.value!=""&&t.value!=undefined?n.endDate(moment(t.value).format("L")):n.endDate(moment(new Date).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.btnActive=ko.observable({offText:"NO",onText:"YES",value:n.active,width:switchActiveWidth55px,onValueChanged:function(t){t.value==!0?n.active(!0):n.active(!1)}});n.btnCloseSetUpHoliday=function(){n.clearSetUpHoliday()};n.clearSetUpHoliday=function(){n.holidayId("");n.description("");n.startDate(moment().format("L"));n.endDate(moment().format("L"));n.active(!0)}}function GraguitySettingViewModel(){var n=this;n.gratuityChargeAuto=ko.observable("");n.gratuityChargeAutoEnable=ko.observable();n.gratuityChargeAutoDisable=ko.observable();n.gratuityPartySize=ko.observable("");n.gratuityChargeId=ko.observable();n.gratuityChargeTax=ko.observable("");n.gratuityChargeTaxEnable=ko.observable();n.gratuityChargeTaxDisable=ko.observable();n.gratuityChargeTaxPercentage=ko.observable();n.dataGratuityCharge=ko.observableArray([]);n.clickChargeAutoEnable=function(){return n.gratuityChargeAutoEnable(!0),n.gratuityChargeAutoDisable(!1),n.gratuityChargeAuto("1"),!0};n.clickChargeAutoDisable=function(){return n.gratuityChargeAutoEnable(!1),n.gratuityChargeAutoDisable(!0),n.gratuityChargeAuto("0"),!0};n.clickChargeTaxEnable=function(){return n.gratuityChargeTaxEnable(!0),n.gratuityChargeTaxDisable(!1),n.gratuityChargeTax("1"),!0};n.clickChargeTaxDisable=function(){return n.gratuityChargeTaxEnable(!1),n.gratuityChargeTaxDisable(!0),n.gratuityChargeTax("0"),!0};n.gratuityChargeSelect=ko.observable({dataSource:{store:n.dataGratuityCharge,sort:"graguityId"},displayExpr:"graguityName",valueExpr:"graguityId",value:n.gratuityChargeId,dropDownButtonTemplate:"dropDownButton",searchEnabled:!0,onItemClick:function(t){n.gratuityChargeId(t.itemData.graguityId())}});n.blurPartySize=function(){var t=$(event.target).val();t=$.isNumeric(t)?parseInt(t):1;n.gratuityPartySize(t)};n.blurChargeTaxPercent=function(){var t=$(event.target).val();t=$.isNumeric(t)?rountTwo(t):0;t<0&&(t=0);n.gratuityChargeTaxPercentage(t)};n.btnCloseGratuityCharge=function(){var n=JSON.parse(getObjFormAjax(cJsonGetGlobalConfig,products.cSmileContactless)),t=JSON.parse(getObjFormAjax(cJsonGetGraguity,""));DataGraguityViewModel(n,t)}}function SetUpMainPriceViewModel(){var n=this;n.promotionMainPriceId=ko.observable();n.priceMin=ko.observable(0).extend({numeric:2});n.priceMax=ko.observable(0).extend({numeric:2});n.isUnlimitPriceMin=ko.observable(!0);n.isUnlimitPriceMax=ko.observable(!0);n.clickIsUnlimitPriceMin=function(t){var i=t.allSetting.dataSetUpMainPrice.isUnlimitPriceMin();return n.priceMin(0),i&&n.checkInRange(),!0};n.clickIsUnlimitPriceMax=function(t){var i=t.allSetting.dataSetUpMainPrice.isUnlimitPriceMax();return n.priceMax(0),i&&n.checkInRange(),!0};n.btnCloseSetUpMainPrice=function(){n.clearSetUpMainPrice();vmViewIndex.allSetting.disableButtonSubmit(!1)};n.clearSetUpMainPrice=function(){n.priceMin(0);n.priceMax(0);n.isUnlimitPriceMin(!0);n.isUnlimitPriceMax(!0);n.promotionMainPriceId("")};n.checkInRange=function(){var t,f,w;vmViewIndex.allSetting.disableButtonSubmit(!1);var y=vmViewIndex.allSetting.dataMainPrice(),i=vmViewIndex.allSetting.dataSetUpMainPrice.promotionMainPriceId(),b=_.filter(y,function(n){return n.promotionMainPriceId()==i}),u=_.orderBy(y,function(n){return n.priceMin()}),p=_.filter(u,function(n){return n.priceMin()==0&&n.priceMax()==0&&n.promotionMainPriceId()!=i}),r=_.filter(u,function(n){return n.priceMin()!=0&&n.priceMax()==0});if(r.length!=0&&(r=_.filter(r,function(t){return parseFloat(n.priceMin())>=parseFloat(t.priceMin())||parseFloat(n.priceMax())>=parseFloat(t.priceMin())||parseFloat(n.priceMax())==0})),r.length!=0&&(r=_.filter(r,function(n){return n.promotionMainPriceId()!=i})),t=_.filter(u,function(n){return n.priceMin()==0&&n.priceMax()!=0}),t.length!=0&&(t=_.filter(t,function(t){return parseFloat(n.priceMax())<=parseFloat(t.priceMax())||parseFloat(n.priceMin())<=parseFloat(t.priceMax())})),t.length!=0&&(t=_.filter(t,function(n){return n.promotionMainPriceId()!=i})),f=_.filter(u,function(n){return n.priceMin()!=0&&n.priceMax()!=0}),w=_.filter(u,function(n){return(n.priceMin()!=0||n.priceMax()!=0)&&n.promotionMainPriceId()!=i}),w.length!=0&&parseFloat(vmViewIndex.allSetting.dataSetUpMainPrice.priceMax())==0&&parseFloat(vmViewIndex.allSetting.dataSetUpMainPrice.priceMin())==0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_CustomDiscount_InRange,!1),!1;if(p.length!=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+_.first(p).priceMin()+' - Unlimit" ',!1),!1;if(r!=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+_.first(r).priceMin()+' - Unlimit" ',!1),!1;if(t!=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+_.first(t).priceMin()+" - "+_.first(t).priceMax()+'" ',!1),!1;var e=_.filter(f,function(t){return _.inRange(parseFloat(n.priceMin()),parseFloat(t.priceMin()),parseFloat(t.priceMax())+.01)}),o=_.filter(f,function(t){return _.inRange(parseFloat(n.priceMax()),parseFloat(t.priceMin()),parseFloat(t.priceMax())+.01)}),c=_.findIndex(e,function(n){return n.promotionMainPriceId()!=i}),l=_.findIndex(o,function(n){return n.promotionMainPriceId()!=i});if(e.length>0&&c>=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+e[c].priceMin()+" - "+e[c].priceMax()+'" ',!1),!1;if(o.length>0&&l>=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+o[l].priceMin()+" - "+o[l].priceMax()+'" ',!1),!1;if(Number(n.priceMin())<Number(n.priceMax())){var s=_.filter(f,function(t){return _.inRange(parseFloat(t.priceMin()),parseFloat(n.priceMin()),parseFloat(n.priceMax())+.01)}),h=_.filter(f,function(t){return _.inRange(parseFloat(t.priceMax()),parseFloat(n.priceMin()),parseFloat(n.priceMax())+.01)}),a=_.findIndex(s,function(n){return n.promotionMainPriceId()!=i}),v=_.findIndex(h,function(n){return n.promotionMainPriceId()!=i});if(s.length>0&&a>=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+s[a].priceMin()+" - "+s[a].priceMax()+'" ',!1),!1;if(h.length>0&&v>=0)return vmViewIndex.allSetting.setDisableButtonSubmit(),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+h[v].priceMin()+" - "+h[v].priceMax()+'" ',!1),!1}return!0}}function SetUpGroupMainFoodViewModel(){var n=this;n.promotionGroupMainFoodId=ko.observable();n.promotionGroupMainFoodName=ko.observable();n.listPromotionMainFood=ko.observableArray([]);n.strMainFoodName=ko.observable();n.arrMainFood=ko.observableArray([]);n.tempListSelectFood=ko.observableArray([]);n.selectItemKey=ko.observableArray([]);n.jsonPromotionMainFood=ko.observable();n.listFood=ko.observable({dataSource:{store:n.arrMainFood,group:"foodCatName"},grouped:!0,searchEnabled:!0,searchExpr:["foodCatName","foodName"],itemTemplate:function(n,t,i){i.append($("<p>").text(n.foodName()).css("margin",0))},selectionMode:"multiple",showSelectionControls:!0,collapsibleGroups:!0,selectedItemKeys:n.selectItemKey,onSelectionChanged:function(t){if(t.addedItems.length!=0)n.tempListSelectFood().push(_.first(t.addedItems));else if(t.removedItems.length!=0){var i=_.first(t.removedItems),r=n.tempListSelectFood().findIndex(function(n){return n.foodId()==i.foodId()});n.tempListSelectFood.splice(r,1)}}});n.clickAddPromotionMainFood=function(){var t,i;n.tempListSelectFood().length!=0&&(t=n.tempListSelectFood.slice(0),n.tempListSelectFood([]),i=[],ko.utils.arrayForEach(t,function(t){n.listPromotionMainFood.push(t);i.push(t.foodId());var r=n.arrMainFood().findIndex(function(n){return n.foodId()==t.foodId()});n.arrMainFood.splice(r,1)}),n.jsonPromotionMainFood(generateJsonData(n.listPromotionMainFood())))};n.changeOrderQty=function(t,i){var u=n.listPromotionMainFood().findIndex(function(n){return n.foodId()==t.foodId()}),r=$(i.target).val();(r==""||parseInt(r)<=0)&&(r="1");$(i.target).val(r);n.listPromotionMainFood()[u].qty(parseInt(r));n.jsonPromotionMainFood(generateJsonData(n.listPromotionMainFood()))};n.clickDelPromotionMainFood=function(t){var r=n.listPromotionMainFood().findIndex(function(n){return n.foodId()==t.foodId()}),i;n.listPromotionMainFood.splice(r,1);n.arrMainFood.push(t);i=n.tempListSelectFood.slice(0);n.selectItemKey([]);_.forEach(i,function(t){n.selectItemKey.push(t)});n.tempListSelectFood(i);n.listPromotionMainFood().length==0?n.jsonPromotionMainFood(""):n.jsonPromotionMainFood(generateJsonData(n.listPromotionMainFood()))};n.btnCloseSetUpGroupMainFood=function(){n.clearSetUpGroupMainFood();vmViewIndex.allSetting.disableButtonSubmit(!1)};n.clearSetUpGroupMainFood=function(){n.promotionGroupMainFoodId("");n.promotionGroupMainFoodName("");n.listPromotionMainFood([]);n.strMainFoodName("");n.arrMainFood([]);n.tempListSelectFood([]);n.selectItemKey([]);n.jsonPromotionMainFood("")}}function SetUpGroupFreeFoodViewModel(){var n=this;n.promotionGroupFreeFoodId=ko.observable();n.promotionGroupFreeFoodName=ko.observable();n.listPromotionFreeFood=ko.observableArray([]);n.strFreeFoodName=ko.observable();n.arrFreeFood=ko.observableArray([]);n.tempListSelectFood=ko.observableArray([]);n.selectItemKey=ko.observableArray([]);n.jsonPromotionFreeFood=ko.observable();n.listFood=ko.observable({dataSource:{store:n.arrFreeFood,group:"foodCatName"},grouped:!0,searchEnabled:!0,searchExpr:["foodCatName","foodName"],itemTemplate:function(n,t,i){i.append($("<p>").text(n.foodName()).css("margin",0))},selectionMode:"multiple",showSelectionControls:!0,collapsibleGroups:!0,selectedItemKeys:n.selectItemKey,onSelectionChanged:function(t){if(t.addedItems.length!=0)n.tempListSelectFood().push(_.first(t.addedItems));else if(t.removedItems.length!=0){var i=_.first(t.removedItems),r=n.tempListSelectFood().findIndex(function(n){return n.foodId()==i.foodId()});n.tempListSelectFood.splice(r,1)}}});n.clickAddPromotionFreeFood=function(){var t,i;n.tempListSelectFood().length!=0&&(t=n.tempListSelectFood.slice(0),n.tempListSelectFood([]),i=[],ko.utils.arrayForEach(t,function(t){n.listPromotionFreeFood.push(t);i.push(t.foodId());var r=n.arrFreeFood().findIndex(function(n){return n.foodId()==t.foodId()});n.arrFreeFood.splice(r,1)}),n.jsonPromotionFreeFood(generateJsonData(n.listPromotionFreeFood())))};n.changeOrderQty=function(t,i){var u=n.listPromotionFreeFood().findIndex(function(n){return n.foodId()==t.foodId()}),r=$(i.target).val();(r==""||parseInt(r)<=0)&&(r="1");$(i.target).val(r);n.listPromotionFreeFood()[u].qty(parseInt(r));n.jsonPromotionFreeFood(generateJsonData(n.listPromotionFreeFood()))};n.clickDelPromotionFreeFood=function(t){var r=n.listPromotionFreeFood().findIndex(function(n){return n.foodId()==t.foodId()}),i;n.listPromotionFreeFood.splice(r,1);n.arrFreeFood.push(t);i=n.tempListSelectFood.slice(0);n.selectItemKey([]);_.forEach(i,function(t){n.selectItemKey.push(t)});n.tempListSelectFood(i);n.listPromotionFreeFood().length==0?n.jsonPromotionFreeFood(""):n.jsonPromotionFreeFood(generateJsonData(n.listPromotionFreeFood()))};n.btnCloseSetUpGroupFreeFood=function(){n.clearSetUpGroupFreeFood();vmViewIndex.allSetting.disableButtonSubmit(!1)};n.clearSetUpGroupFreeFood=function(){n.promotionGroupFreeFoodId("");n.promotionGroupFreeFoodName("");n.listPromotionFreeFood([]);n.strFreeFoodName("");n.arrFreeFood([]);n.tempListSelectFood([]);n.selectItemKey([]);n.jsonPromotionFreeFood("")}}function generateJsonData(n){var t=[];return ko.utils.arrayForEach(n,function(n){t.push({foodCatName:n.foodCatName(),foodCatId:n.foodCatId(),foodId:n.foodId(),foodName:n.foodName(),qty:n.qty()})}),JSON.stringify(t)}function SetUpConditionViewModel(){var n=this;n.promotionId=ko.observable();n.promotionTypeId=ko.observable();n.promotionTypeName=ko.observable();n.isAutoFree=ko.observable(!0);n.active=ko.observable(!0);n.startDate=ko.observable(moment().format("L"));n.endDate=ko.observable(moment().format("L"));n.promotionMainPriceId=ko.observable();n.promotionGroupMainFood=ko.observable();n.promotionGroupFreeFood=ko.observable();n.promotionGroupMainFoodStr=ko.observable();n.promotionGroupFreeFoodStr=ko.observable();n.listPromotionGroupMainFood=ko.observableArray([]);n.listPromotionGroupFreeFood=ko.observableArray([]);n.strGrpMainFoodName=ko.observable("");n.strGrpFreeFoodName=ko.observable("");n.strMainPriceName=ko.observable("");n.tempListMainPrice=ko.observableArray([]);n.tempListGroupMainFood=ko.observableArray([]);n.tempListGroupFreeFood=ko.observableArray([]);n.isConditionFree=ko.observable(!1);n.isConditionMain=ko.observable(!0);n.isTermsPrice=ko.observable(!0);n.isTermsFood=ko.observable(!1);n.isEmptyMainPrice=ko.observable(!1);n.isEmptyGrpMainFood=ko.observable(!1);n.isEmptyGrpFreeFood=ko.observable(!1);n.clickNextCondition=function(){return n.isConditionFree(!0),n.isConditionMain(!1),!0};n.clickBackCondition=function(){return n.isConditionFree(!1),n.isConditionMain(!0),!0};n.btnActive=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.active,onValueChanged:function(t){t.value==!0?n.active(!0):n.active(!1)}});n.btnAutoFree=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.isAutoFree,onValueChanged:function(t){t.value==!0?n.isAutoFree(!0):n.isAutoFree(!1)}});n.dateFromDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.startDate,width:150,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.startDate(moment(new Date(t.value)).format())},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.dateEndDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.endDate,min:n.startDate,width:150,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.endDate(moment(new Date(t.value)).format())},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.clickMainPrice=function(t){var i=t.promotionMainPriceId(),r=n.tempListMainPrice().findIndex(function(n){return n.promotionMainPriceId()==i}),u=$(".cardPrice").find("div.card.card-body.form-group.card-price");u[r].classList.value.indexOf("card-active")==-1&&$(".cardPrice").find("div").removeClass("card-active");u[r].classList.add("card-active");n.promotionMainPriceId(i)};n.clickMainFood=function(t){var i=t.promotionGroupMainFoodId(),r=n.tempListGroupMainFood().findIndex(function(n){return n.promotionGroupMainFoodId()==i}),u=$(".cardMainFood").find("div.card.form-group.card-food"),f,e;n.listPromotionGroupMainFood()==null?(u[r].classList.add("card-active"),f=[],f.push(i),n.listPromotionGroupMainFood(f)):n.listPromotionGroupMainFood().includes(i)?(u[r].classList.remove("card-active"),e=n.listPromotionGroupMainFood().findIndex(function(n){return n==i}),n.listPromotionGroupMainFood().splice(e,1)):(u[r].classList.add("card-active"),n.listPromotionGroupMainFood().push(i));n.promotionGroupMainFoodStr(n.listPromotionGroupMainFood().join(","))};n.clickFreeFood=function(t){var i=t.promotionGroupFreeFoodId(),r=n.tempListGroupFreeFood().findIndex(function(n){return n.promotionGroupFreeFoodId()==i}),u=$(".cardFreeFood").find("div.card.form-group.card-food"),f;n.listPromotionGroupFreeFood().includes(i)?(u[r].classList.remove("card-active"),f=n.listPromotionGroupFreeFood().findIndex(function(n){return n==i}),n.listPromotionGroupFreeFood().splice(f,1)):(u[r].classList.add("card-active"),n.listPromotionGroupFreeFood().push(i));n.promotionGroupFreeFoodStr(n.listPromotionGroupFreeFood().join(","))};n.btnCloseSetUpCondition=function(){n.clearSetUpCondition();vmViewIndex.allSetting.disableButtonSubmit(!1)};n.clearSetUpCondition=function(){n.promotionId("");n.promotionTypeId("");n.isAutoFree(!0);n.active(!0);n.startDate(moment().format("L"));n.endDate(moment().format("L"));n.promotionMainPriceId("");n.promotionGroupMainFood("");n.promotionGroupFreeFood("");n.listPromotionGroupMainFood([]);n.listPromotionGroupFreeFood([]);n.strGrpMainFoodName("");n.strGrpFreeFoodName("");n.strMainPriceName("");n.isConditionFree(!1);n.isConditionMain(!0);n.isTermsPrice(!0);n.isTermsFood(!1);n.isEmptyMainPrice(!1);n.isEmptyGrpMainFood(!1);n.isEmptyGrpFreeFood(!1);n.promotionGroupMainFoodStr("");n.promotionGroupFreeFoodStr("");$(".cardPrice").find("div").removeClass("card-active");$(".cardFreeFood").find("div").removeClass("card-active");$(".cardMainFood").find("div").removeClass("card-active")}}function AllTimeViewModel(n){function u(n,t,i){var r=new ObjUrl(n),u=r.getUrlFromJson(),f={foodSetId:t,key:i};return getJsonFromAjax(u,!ajax_async,ajax_cache,ajax_type_post,f,ajax_timeout)}var t=this,f=divShowTimeSun,e=divShowTimeMon,o=divShowTimeTue,s=divShowTimeWed,h=divShowTimeThu,c=divShowTimeFri,l=divShowTimeSat,a=divShowTimeAlldays,i,r;t.foodsetidkey=ko.observableArray([]);isEmpty(n)?(t.dataViewModel=ko.observableArray([]),t.data=ko.observableArray([]),t.dataModal=new NewDataTimeMenu,t.dataObj=ko.pureComputed(function(){return ko.toJSON(t.dataViewModel())}),t.dataListTimeMenu=ko.observableArray([]),t.dataListTimePickUp=ko.observableArray([]),t.dataListTimeDelivery=ko.observableArray([]),t.dataListFoodSetTimeMap=ko.observableArray([]),t.dataListFoodSetName=ko.observableArray([]),t.hasShowFoodSet=ko.observable(!1),t.selectFoodSet=ko.observable(""),t.typeTimeName=ko.observable("TimeMenu"),t.selectListFoodSetId=ko.observableArray([]),t.dataObjSelectTagBox=ko.pureComputed(function(){return ko.toJSON(t.selectListFoodSetId())}),t.valDaySunTimeMenuEdit=ko.observable("SUN"),t.valDayMonTimeMenuEdit=ko.observable("MON"),t.valDayTueTimeMenuEdit=ko.observable("TUE"),t.valDayWedTimeMenuEdit=ko.observable("WED"),t.valDayThuTimeMenuEdit=ko.observable("THU"),t.valDayFriTimeMenuEdit=ko.observable("FRI"),t.valDaySatTimeMenuEdit=ko.observable("SAT"),t.valDayAllEdit=ko.observable("ALLDAYS"),t.hasSunTimeMenuEdit=ko.observable(!1),t.hasMonTimeMenuEdit=ko.observable(!1),t.hasTueTimeMenuEdit=ko.observable(!1),t.hasWedTimeMenuEdit=ko.observable(!1),t.hasThuTimeMenuEdit=ko.observable(!1),t.hasFriTimeMenuEdit=ko.observable(!1),t.hasSatTimeMenuEdit=ko.observable(!1),t.hasAllDaysTimeMenuEdit=ko.observable(!1),t.clickSelectFirstSunTimeMenuEdit=function(){return!0},t.clickSelectSecondSunTimeMenuEdit=function(){return!0},t.clickSelectFirstMonTimeMenuEdit=function(){return!0},t.clickSelectSecondMonTimeMenuEdit=function(){return!0},t.clickSelectFirstTueTimeMenuEdit=function(){return!0},t.clickSelectSecondTueTimeMenuEdit=function(){return!0},t.clickSelectFirstWedTimeMenuEdit=function(){return!0},t.clickSelectSecondWedTimeMenuEdit=function(){return!0},t.clickSelectFirstThuTimeMenuEdit=function(){return!0},t.clickSelectSecondThuTimeMenuEdit=function(){return!0},t.clickSelectFirstFriTimeMenuEdit=function(){return!0},t.clickSelectSecondFriTimeMenuEdit=function(){return!0},t.clickSelectFirstSatTimeMenuEdit=function(){return!0},t.clickSelectSecondSatTimeMenuEdit=function(){return!0},t.clickSelectFirstAllDaysTimeMenuEdit=function(){return!0},t.clickSelectSecondAllDaysTimeMenuEdit=function(){return!0},i=ko.observableArray([{name:"Menu Hour",id:1},{name:"Pickup Hour",id:2},{name:"Delivery Hour",id:3},{name:"FoodSetTimeMap",id:4}]),t.selectTime=ko.observable({dataSource:new DevExpress.data.ArrayStore({data:i(),key:"id"}),displayExpr:"name",valueExpr:"id",value:_.first(i()).id,placeholder:"Select Time",onValueChanged:function(n){switch(n.value){case 1:vmViewIndex.allSetTime.typeTimeName("TimeMenu");DataTimeMenu(vmViewIndex.allSetTime.dataListTimeMenu());vmViewIndex.allSetTime.hasShowFoodSet(!1);hiddenShowTimeMenuEdit();break;case 2:vmViewIndex.allSetTime.typeTimeName("TimePickUp");DataTimeMenu(vmViewIndex.allSetTime.dataListTimePickUp());vmViewIndex.allSetTime.hasShowFoodSet(!1);hiddenShowTimeMenuEdit();break;case 3:vmViewIndex.allSetTime.typeTimeName("TimeDelivery");DataTimeMenu(vmViewIndex.allSetTime.dataListTimeDelivery());vmViewIndex.allSetTime.hasShowFoodSet(!1);hiddenShowTimeMenuEdit();break;case 4:vmViewIndex.allSetTime.typeTimeName("FoodSetTimeMap");DataTimeMenu(vmViewIndex.allSetTime.dataListFoodSetTimeMap());vmViewIndex.allSetTime.hasShowFoodSet(!0);hiddenShowTimeMenuEdit();break;default:vmViewIndex.allSetTime.hasShowFoodSet(!1)}}}),r=ko.observableArray([{name:"Menu Hour",id:1},{name:"FoodSetTimeMap",id:4}]),t.selectTimeContactless=ko.observable({dataSource:new DevExpress.data.ArrayStore({data:r(),key:"id"}),displayExpr:"name",valueExpr:"id",value:_.first(r()).id,placeholder:"Select Time",onValueChanged:function(n){switch(n.value){case 1:vmViewIndex.allSetTime.typeTimeName("TimeMenu");DataTimeMenu(vmViewIndex.allSetTime.dataListTimeMenu());vmViewIndex.allSetTime.hasShowFoodSet(!1);hiddenShowTimeMenuEdit();break;case 4:vmViewIndex.allSetTime.typeTimeName("FoodSetTimeMap");DataTimeMenu(vmViewIndex.allSetTime.dataListFoodSetTimeMap());vmViewIndex.allSetTime.hasShowFoodSet(!0);hiddenShowTimeMenuEdit();break;default:vmViewIndex.allSetTime.hasShowFoodSet(!1)}}}),t.clickActive24HourSunTimeMenuEdit=ko.observable({offText:"NO",onText:"YES",value:t.dataModal.valActive24HourSunTimeMenuEdit,width:switchActiveWidth55px,onValueChanged:function(n){var t=vmViewIndex.allSetTime.dataModal;n.value==!0?(t.valFirstHourStartTimeSunTimeMenuEditValue(moment(time_start_24h,moment_time_format_hhmmss)),t.valFirstHourEndTimeSunTimeMenuEditValue(moment(time_end_24h,moment_time_format_hhmmss)),t.valSecondHourStartTimeSunTimeMenuEditValue(null),t.valSecondHourEndTimeSunTimeMenuEditValue(null),t.valActive24HourSunTimeMenuEdit(!0),t.valSelectFirstSunTimeMenuEdit(!0),t.valSelectSecondSunTimeMenuEdit(!0),t.hasShowSecondSunTimeMenuEdit(!0),hideErorrTimePeriodTimeMenuEdit()):t.valActive24HourSunTimeMenuEdit(!1)}}),t.clickActive24HourMonTimeMenuEdit=ko.observable({offText:"NO",onText:"YES",value:t.dataModal.valActive24HourMonTimeMenuEdit,width:switchActiveWidth55px,onValueChanged:function(n){var t=vmViewIndex.allSetTime.dataModal;n.value==!0?(t.valFirstHourStartTimeMonTimeMenuEditValue(moment(time_start_24h,moment_time_format_hhmmss)),t.valFirstHourEndTimeMonTimeMenuEditValue(moment(time_end_24h,moment_time_format_hhmmss)),t.valSecondHourStartTimeMonTimeMenuEditValue(null),t.valSecondHourEndTimeMonTimeMenuEditValue(null),t.valActive24HourMonTimeMenuEdit(!0),t.valSelectFirstMonTimeMenuEdit(!0),t.valSelectSecondMonTimeMenuEdit(!0),t.hasShowSecondMonTimeMenuEdit(!0),hideErorrTimePeriodTimeMenuEdit()):t.valActive24HourMonTimeMenuEdit(!1)}}),t.clickActive24HourTueTimeMenuEdit=ko.observable({offText:"NO",onText:"YES",value:t.dataModal.valActive24HourTueTimeMenuEdit,width:switchActiveWidth55px,onValueChanged:function(n){var t=vmViewIndex.allSetTime.dataModal;n.value==!0?(t.valFirstHourStartTimeTueTimeMenuEditValue(moment(time_start_24h,moment_time_format_hhmmss)),t.valFirstHourEndTimeTueTimeMenuEditValue(moment(time_end_24h,moment_time_format_hhmmss)),t.valSecondHourStartTimeTueTimeMenuEditValue(null),t.valSecondHourEndTimeTueTimeMenuEditValue(null),t.valActive24HourTueTimeMenuEdit(!0),t.valSelectFirstTueTimeMenuEdit(!0),t.valSelectSecondTueTimeMenuEdit(!0),t.hasShowSecondTueTimeMenuEdit(!0),hideErorrTimePeriodTimeMenuEdit()):t.valActive24HourTueTimeMenuEdit(!1)}}),t.clickActive24HourWedTimeMenuEdit=ko.observable({offText:"NO",onText:"YES",value:t.dataModal.valActive24HourWedTimeMenuEdit,width:switchActiveWidth55px,onValueChanged:function(n){var t=vmViewIndex.allSetTime.dataModal;n.value==!0?(t.valFirstHourStartTimeWedTimeMenuEditValue(moment(time_start_24h,moment_time_format_hhmmss)),t.valFirstHourEndTimeWedTimeMenuEditValue(moment(time_end_24h,moment_time_format_hhmmss)),t.valSecondHourStartTimeWedTimeMenuEditValue(null),t.valSecondHourEndTimeWedTimeMenuEditValue(null),t.valActive24HourWedTimeMenuEdit(!0),t.valSelectFirstWedTimeMenuEdit(!0),t.valSelectSecondWedTimeMenuEdit(!0),t.hasShowSecondWedTimeMenuEdit(!0),hideErorrTimePeriodTimeMenuEdit()):t.valActive24HourWedTimeMenuEdit(!1)}}),t.clickActive24HourThuTimeMenuEdit=ko.observable({offText:"NO",onText:"YES",value:t.dataModal.valActive24HourThuTimeMenuEdit,width:switchActiveWidth55px,onValueChanged:function(n){var t=vmViewIndex.allSetTime.dataModal;n.value==!0?(t.valFirstHourStartTimeThuTimeMenuEditValue(moment(time_start_24h,moment_time_format_hhmmss)),t.valFirstHourEndTimeThuTimeMenuEditValue(moment(time_end_24h,moment_time_format_hhmmss)),t.valSecondHourStartTimeThuTimeMenuEditValue(null),t.valSecondHourEndTimeThuTimeMenuEditValue(null),t.valActive24HourThuTimeMenuEdit(!0),t.valSelectFirstThuTimeMenuEdit(!0),t.valSelectSecondThuTimeMenuEdit(!0),t.hasShowSecondThuTimeMenuEdit(!0),hideErorrTimePeriodTimeMenuEdit()):t.valActive24HourThuTimeMenuEdit(!1)}}),t.clickActive24HourFriTimeMenuEdit=ko.observable({offText:"NO",onText:"YES",value:t.dataModal.valActive24HourFriTimeMenuEdit,width:switchActiveWidth55px,onValueChanged:function(n){var t=vmViewIndex.allSetTime.dataModal;n.value==!0?(t.valFirstHourStartTimeFriTimeMenuEditValue(moment(time_start_24h,moment_time_format_hhmmss)),t.valFirstHourEndTimeFriTimeMenuEditValue(moment(time_end_24h,moment_time_format_hhmmss)),t.valSecondHourStartTimeFriTimeMenuEditValue(null),t.valSecondHourEndTimeFriTimeMenuEditValue(null),t.valActive24HourFriTimeMenuEdit(!0),t.valSelectFirstFriTimeMenuEdit(!0),t.valSelectSecondFriTimeMenuEdit(!0),t.hasShowSecondFriTimeMenuEdit(!0),hideErorrTimePeriodTimeMenuEdit()):t.valActive24HourFriTimeMenuEdit(!1)}}),t.clickActive24HourSatTimeMenuEdit=ko.observable({offText:"NO",onText:"YES",value:t.dataModal.valActive24HourSatTimeMenuEdit,width:switchActiveWidth55px,onValueChanged:function(n){var t=vmViewIndex.allSetTime.dataModal;n.value==!0?(t.valFirstHourStartTimeSatTimeMenuEditValue(moment(time_start_24h,moment_time_format_hhmmss)),t.valFirstHourEndTimeSatTimeMenuEditValue(moment(time_end_24h,moment_time_format_hhmmss)),t.valSecondHourStartTimeSatTimeMenuEditValue(null),t.valSecondHourEndTimeSatTimeMenuEditValue(null),t.valActive24HourSatTimeMenuEdit(!0),t.valSelectFirstSatTimeMenuEdit(!0),t.valSelectSecondSatTimeMenuEdit(!0),t.hasShowSecondSatTimeMenuEdit(!0),hideErorrTimePeriodTimeMenuEdit()):t.valActive24HourSatTimeMenuEdit(!1)}}),t.clickActive24HourAllDaysTimeMenuEdit=ko.observable({offText:"NO",onText:"YES",value:t.dataModal.valActive24HourAllDaysTimeMenuEdit,width:switchActiveWidth55px,onValueChanged:function(n){var t=vmViewIndex.allSetTime.dataModal;n.value==!0?(t.valFirstHourStartTimeAllDaysTimeMenuEditValue(moment(time_start_24h,moment_time_format_hhmmss)),t.valFirstHourEndTimeAllDaysTimeMenuEditValue(moment(time_end_24h,moment_time_format_hhmmss)),t.valSecondHourStartTimeAllDaysTimeMenuEditValue(null),t.valSecondHourEndTimeAllDaysTimeMenuEditValue(null),t.valActive24HourAllDaysTimeMenuEdit(!0),t.valSelectFirstAllDaysTimeMenuEdit(!0),t.valSelectSecondAllDaysTimeMenuEdit(!0),t.hasShowSecondAllDaysTimeMenuEdit(!0),hideErorrTimePeriodTimeMenuEdit()):t.valActive24HourAllDaysTimeMenuEdit(!1)}}),t.clickSunTimeMenuEdit=function(){hiddenShowTimeMenuEdit();t.hasSunTimeMenuEdit(!1);t.hasMonTimeMenuEdit(!1);t.hasTueTimeMenuEdit(!1);t.hasWedTimeMenuEdit(!1);t.hasThuTimeMenuEdit(!1);t.hasFriTimeMenuEdit(!1);t.hasSatTimeMenuEdit(!1);t.hasAllDaysTimeMenuEdit(!1);var n=t.hasSunTimeMenuEdit();t.hasSunTimeMenuEdit(!n);t.hasSunTimeMenuEdit()&&f.show()},t.clickMonTimeMenuEdit=function(){hiddenShowTimeMenuEdit();t.hasSunTimeMenuEdit(!1);t.hasMonTimeMenuEdit(!1);t.hasTueTimeMenuEdit(!1);t.hasWedTimeMenuEdit(!1);t.hasThuTimeMenuEdit(!1);t.hasFriTimeMenuEdit(!1);t.hasSatTimeMenuEdit(!1);t.hasAllDaysTimeMenuEdit(!1);var n=t.hasMonTimeMenuEdit();t.hasMonTimeMenuEdit(!n);t.hasMonTimeMenuEdit()&&e.show()},t.clickTueTimeMenuEdit=function(){hiddenShowTimeMenuEdit();t.hasSunTimeMenuEdit(!1);t.hasMonTimeMenuEdit(!1);t.hasTueTimeMenuEdit(!1);t.hasWedTimeMenuEdit(!1);t.hasThuTimeMenuEdit(!1);t.hasFriTimeMenuEdit(!1);t.hasSatTimeMenuEdit(!1);t.hasAllDaysTimeMenuEdit(!1);var n=t.hasTueTimeMenuEdit();t.hasTueTimeMenuEdit(!n);t.hasTueTimeMenuEdit()&&o.show()},t.clickWedTimeMenuEdit=function(){hiddenShowTimeMenuEdit();t.hasSunTimeMenuEdit(!1);t.hasMonTimeMenuEdit(!1);t.hasTueTimeMenuEdit(!1);t.hasWedTimeMenuEdit(!1);t.hasThuTimeMenuEdit(!1);t.hasFriTimeMenuEdit(!1);t.hasSatTimeMenuEdit(!1);t.hasAllDaysTimeMenuEdit(!1);var n=t.hasWedTimeMenuEdit();t.hasWedTimeMenuEdit(!n);t.hasWedTimeMenuEdit()&&s.show()},t.clickThuTimeMenuEdit=function(){hiddenShowTimeMenuEdit();t.hasSunTimeMenuEdit(!1);t.hasMonTimeMenuEdit(!1);t.hasTueTimeMenuEdit(!1);t.hasWedTimeMenuEdit(!1);t.hasThuTimeMenuEdit(!1);t.hasFriTimeMenuEdit(!1);t.hasAllDaysTimeMenuEdit(!1);t.hasSatTimeMenuEdit(!1);var n=t.hasThuTimeMenuEdit();t.hasThuTimeMenuEdit(!n);t.hasThuTimeMenuEdit()&&h.show()},t.clickFriTimeMenuEdit=function(){hiddenShowTimeMenuEdit();t.hasSunTimeMenuEdit(!1);t.hasMonTimeMenuEdit(!1);t.hasTueTimeMenuEdit(!1);t.hasWedTimeMenuEdit(!1);t.hasThuTimeMenuEdit(!1);t.hasFriTimeMenuEdit(!1);t.hasSatTimeMenuEdit(!1);t.hasAllDaysTimeMenuEdit(!1);var n=t.hasFriTimeMenuEdit();t.hasFriTimeMenuEdit(!n);t.hasFriTimeMenuEdit()&&c.show()},t.clickSatTimeMenuEdit=function(){hiddenShowTimeMenuEdit();t.hasSunTimeMenuEdit(!1);t.hasMonTimeMenuEdit(!1);t.hasTueTimeMenuEdit(!1);t.hasWedTimeMenuEdit(!1);t.hasThuTimeMenuEdit(!1);t.hasFriTimeMenuEdit(!1);t.hasSatTimeMenuEdit(!1);t.hasAllDaysTimeMenuEdit(!1);var n=t.hasSatTimeMenuEdit();t.hasSatTimeMenuEdit(!n);t.hasSatTimeMenuEdit()&&l.show()},t.clickAllDaysTimeMenuEdit=function(){hiddenShowTimeMenuEdit();t.hasSunTimeMenuEdit(!1);t.hasMonTimeMenuEdit(!1);t.hasTueTimeMenuEdit(!1);t.hasWedTimeMenuEdit(!1);t.hasThuTimeMenuEdit(!1);t.hasFriTimeMenuEdit(!1);t.hasSatTimeMenuEdit(!1);t.hasAllDaysTimeMenuEdit(!1);vmViewIndex.allSetTime.dataModal.valFirstHourStartTimeAllDaysTimeMenuEditValue(moment(time_start_24h,moment_time_format_hhmmss));vmViewIndex.allSetTime.dataModal.valFirstHourEndTimeAllDaysTimeMenuEditValue(moment(time_end_24h,moment_time_format_hhmmss));vmViewIndex.allSetTime.dataModal.valSecondHourStartTimeAllDaysTimeMenuEditValue(null);vmViewIndex.allSetTime.dataModal.valSecondHourEndTimeAllDaysTimeMenuEditValue(null);vmViewIndex.allSetTime.dataModal.valActive24HourAllDaysTimeMenuEdit(!0);vmViewIndex.allSetTime.dataModal.valSelectFirstAllDaysTimeMenuEdit(!0);vmViewIndex.allSetTime.dataModal.valSelectSecondAllDaysTimeMenuEdit(!0);vmViewIndex.allSetTime.dataModal.hasShowSecondAllDaysTimeMenuEdit(!0);hideErorrTimePeriodTimeMenuEdit();var n=t.hasAllDaysTimeMenuEdit();t.hasAllDaysTimeMenuEdit(!n);t.hasAllDaysTimeMenuEdit()&&divShowTimeAlldays.show()},t.clickShowSecondSunTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondSunTimeMenuEdit();n.hasShowSecondSunTimeMenuEdit(!t);n.valSelectSecondSunTimeMenuEdit(!0)},t.clickHiddenSecondSunTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondSunTimeMenuEdit();n.hasShowSecondSunTimeMenuEdit(!t);n.valSecondHourStartTimeSunTimeMenuEditValue(null);n.valSecondHourEndTimeSunTimeMenuEditValue(null);n.valSelectSecondSunTimeMenuEdit(!1)},t.clickShowSecondMonTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondMonTimeMenuEdit();n.hasShowSecondMonTimeMenuEdit(!t)},t.clickHiddenSecondMonTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondMonTimeMenuEdit();n.hasShowSecondMonTimeMenuEdit(!t);n.valSecondHourStartTimeMonTimeMenuEditValue(null);n.valSecondHourEndTimeMonTimeMenuEditValue(null);n.valSelectSecondMonTimeMenuEdit(!0)},t.clickShowSecondTueTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondTueTimeMenuEdit();n.hasShowSecondTueTimeMenuEdit(!t);n.valSelectSecondTueTimeMenuEdit(!0)},t.clickHiddenSecondTueTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondTueTimeMenuEdit();n.hasShowSecondTueTimeMenuEdit(!t);n.valSecondHourStartTimeTueTimeMenuEditValue(null);n.valSecondHourEndTimeTueTimeMenuEditValue(null);n.valSelectSecondTueTimeMenuEdit(!1)},t.clickShowSecondWedTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondWedTimeMenuEdit();n.hasShowSecondWedTimeMenuEdit(!t);n.valSelectSecondWedTimeMenuEdit(!0)},t.clickHiddenSecondWedTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondWedTimeMenuEdit();n.hasShowSecondWedTimeMenuEdit(!t);n.valSecondHourStartTimeWedTimeMenuEditValue(null);n.valSecondHourEndTimeWedTimeMenuEditValue(null);n.valSelectSecondWedTimeMenuEdit(!1)},t.clickShowSecondThuTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondThuTimeMenuEdit();n.hasShowSecondThuTimeMenuEdit(!t);n.valSelectSecondThuTimeMenuEdit(!0)},t.clickHiddenSecondThuTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondThuTimeMenuEdit();n.hasShowSecondThuTimeMenuEdit(!t);n.valSecondHourStartTimeThuTimeMenuEditValue(null);n.valSecondHourEndTimeThuTimeMenuEditValue(null);n.valSelectSecondThuTimeMenuEdit(!1)},t.clickShowSecondFriTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondFriTimeMenuEdit();n.hasShowSecondFriTimeMenuEdit(!t);n.valSelectSecondFriTimeMenuEdit(!0)},t.clickHiddenSecondFriTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondFriTimeMenuEdit();n.hasShowSecondFriTimeMenuEdit(!t);n.valSecondHourStartTimeFriTimeMenuEditValue(null);n.valSecondHourEndTimeFriTimeMenuEditValue(null);n.valSelectSecondFriTimeMenuEdit(!1)},t.clickShowSecondSatTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondSatTimeMenuEdit();n.hasShowSecondSatTimeMenuEdit(!t);n.valSelectSecondSatTimeMenuEdit(!0)},t.clickHiddenSecondSatTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondSatTimeMenuEdit();n.hasShowSecondSatTimeMenuEdit(!t);n.valSecondHourStartTimeSatTimeMenuEditValue(null);n.valSecondHourEndTimeSatTimeMenuEditValue(null);n.valSelectSecondSatTimeMenuEdit(!1)},t.clickShowSecondAllDaysTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondAllDaysTimeMenuEdit();n.hasShowSecondAllDaysTimeMenuEdit(!t);n.valSelectSecondAllDaysTimeMenuEdit(!0)},t.clickHiddenSecondAllDaysTimeMenuEdit=function(){var n=vmViewIndex.allSetTime.dataModal,t=n.hasShowSecondAllDaysTimeMenuEdit();n.hasShowSecondAllDaysTimeMenuEdit(!t);n.valSecondHourStartTimeAllDaysTimeMenuEditValue(null);n.valSecondHourEndTimeAllDaysTimeMenuEditValue(null);n.valSelectSecondAllDaysTimeMenuEdit(!1)},t.btnCloseEditSetTimeMenu=function(){if(vmViewIndex.allSetTime.typeTimeName!="")switch(vmViewIndex.allSetTime.typeTimeName()){case"TimeMenu":DataTimeMenu(vmViewIndex.allSetTime.dataListTimeMenu());vmViewIndex.allSetTime.hasShowFoodSet(!1);hiddenShowTimeMenuEdit();break;case"TimePickUp":DataTimeMenu(vmViewIndex.allSetTime.dataListTimePickUp());vmViewIndex.allSetTime.hasShowFoodSet(!1);hiddenShowTimeMenuEdit();break;case"TimeDelivery":DataTimeMenu(vmViewIndex.allSetTime.dataListTimeDelivery());vmViewIndex.allSetTime.hasShowFoodSet(!1);hiddenShowTimeMenuEdit();break;case"FoodSetTimeMap":DataTimeMenu(vmViewIndex.allSetTime.dataListFoodSetTimeMap());vmViewIndex.allSetTime.hasShowFoodSet(!0);vmViewIndex.allSetTime.selectFoodSet({value:_.first(vmViewIndex.allSetTime.foodsetidkey())});hiddenShowTimeMenuEdit()}},t.btnClickSave=function(){vmViewIndex.allSetTime.dataViewModel([]);var n=vmViewIndex.allSetTime.dataModal;vmViewIndex.allSetTime.dataViewModel.push(new DataTimeViewModel(n.valActive24HourSunTimeMenuEdit(),n.valSelectFirstSunTimeMenuEdit(),n.valSelectSecondSunTimeMenuEdit(),cDay_Sunday,n.valFirstHourStartTimeSunTimeMenuEditValue(),n.valFirstHourEndTimeSunTimeMenuEditValue(),n.valSecondHourStartTimeSunTimeMenuEditValue(),n.valSecondHourEndTimeSunTimeMenuEditValue(),!n.hasShowSecondSunTimeMenuEdit()));vmViewIndex.allSetTime.dataViewModel.push(new DataTimeViewModel(n.valActive24HourMonTimeMenuEdit(),n.valSelectFirstMonTimeMenuEdit(),n.valSelectSecondMonTimeMenuEdit(),cDay_Monday,n.valFirstHourStartTimeMonTimeMenuEditValue(),n.valFirstHourEndTimeMonTimeMenuEditValue(),n.valSecondHourStartTimeMonTimeMenuEditValue(),n.valSecondHourEndTimeMonTimeMenuEditValue(),!n.hasShowSecondMonTimeMenuEdit()));vmViewIndex.allSetTime.dataViewModel.push(new DataTimeViewModel(n.valActive24HourTueTimeMenuEdit(),n.valSelectFirstTueTimeMenuEdit(),n.valSelectSecondTueTimeMenuEdit(),cDay_Tuesday,n.valFirstHourStartTimeTueTimeMenuEditValue(),n.valFirstHourEndTimeTueTimeMenuEditValue(),n.valSecondHourStartTimeTueTimeMenuEditValue(),n.valSecondHourEndTimeTueTimeMenuEditValue(),!n.hasShowSecondTueTimeMenuEdit()));vmViewIndex.allSetTime.dataViewModel.push(new DataTimeViewModel(n.valActive24HourWedTimeMenuEdit(),n.valSelectFirstWedTimeMenuEdit(),n.valSelectSecondWedTimeMenuEdit(),cDay_Wednesday,n.valFirstHourStartTimeWedTimeMenuEditValue(),n.valFirstHourEndTimeWedTimeMenuEditValue(),n.valSecondHourStartTimeWedTimeMenuEditValue(),n.valSecondHourEndTimeWedTimeMenuEditValue(),!n.hasShowSecondWedTimeMenuEdit()));vmViewIndex.allSetTime.dataViewModel.push(new DataTimeViewModel(n.valActive24HourThuTimeMenuEdit(),n.valSelectFirstThuTimeMenuEdit(),n.valSelectSecondThuTimeMenuEdit(),cDay_Thursday,n.valFirstHourStartTimeThuTimeMenuEditValue(),n.valFirstHourEndTimeThuTimeMenuEditValue(),n.valSecondHourStartTimeThuTimeMenuEditValue(),n.valSecondHourEndTimeThuTimeMenuEditValue(),!n.hasShowSecondThuTimeMenuEdit()));vmViewIndex.allSetTime.dataViewModel.push(new DataTimeViewModel(n.valActive24HourFriTimeMenuEdit(),n.valSelectFirstFriTimeMenuEdit(),n.valSelectSecondFriTimeMenuEdit(),cDay_Friday,n.valFirstHourStartTimeFriTimeMenuEditValue(),n.valFirstHourEndTimeFriTimeMenuEditValue(),n.valSecondHourStartTimeFriTimeMenuEditValue(),n.valSecondHourEndTimeFriTimeMenuEditValue(),!n.hasShowSecondFriTimeMenuEdit()));vmViewIndex.allSetTime.dataViewModel.push(new DataTimeViewModel(n.valActive24HourSatTimeMenuEdit(),n.valSelectFirstSatTimeMenuEdit(),n.valSelectSecondSatTimeMenuEdit(),cDay_Saturday,n.valFirstHourStartTimeSatTimeMenuEditValue(),n.valFirstHourEndTimeSatTimeMenuEditValue(),n.valSecondHourStartTimeSatTimeMenuEditValue(),n.valSecondHourEndTimeSatTimeMenuEditValue(),!n.hasShowSecondSatTimeMenuEdit()));vmViewIndex.allSetTime.dataViewModel.push(new DataTimeViewModel(n.valActive24HourAllDaysTimeMenuEdit(),n.valSelectFirstAllDaysTimeMenuEdit(),n.valSelectSecondAllDaysTimeMenuEdit(),cDay_AllDay,n.valFirstHourStartTimeAllDaysTimeMenuEditValue(),n.valFirstHourEndTimeAllDaysTimeMenuEditValue(),n.valSecondHourStartTimeAllDaysTimeMenuEditValue(),n.valSecondHourEndTimeAllDaysTimeMenuEditValue(),!n.hasShowSecondAllDaysTimeMenuEdit()));$("#submitSetAllTime").click()}):(ko.mapping.fromJS(n.listFoodSet,{},vmViewIndex.allSetTime.dataListFoodSetName),ko.mapping.fromJS(n.listFoodSetTimeMap,{},vmViewIndex.allSetTime.dataListFoodSetTimeMap),ko.mapping.fromJS(n.listTimeMenu,{},vmViewIndex.allSetTime.dataListTimeMenu),ko.mapping.fromJS(n.listTimePickUp,{},vmViewIndex.allSetTime.dataListTimePickUp),ko.mapping.fromJS(n.listTimeDelivery,{},vmViewIndex.allSetTime.dataListTimeDelivery),DataTimeMenu(vmViewIndex.allSetTime.dataListTimeMenu()),isEmpty(vmViewIndex.allSetTime.dataListFoodSetName())||(vmViewIndex.allSetTime.selectListFoodSetId.push(_.first(vmViewIndex.allSetTime.dataListFoodSetName()).foodSetId()),vmViewIndex.allSetTime.foodsetidkey.push(_.first(vmViewIndex.allSetTime.dataListFoodSetName()).foodSetId())),t.storefoodset=new DevExpress.data.ArrayStore({data:[],key:"foodSetId"}),_.forEach(vmViewIndex.allSetTime.dataListFoodSetName(),function(n){t.storefoodset.insert(n)}),vmViewIndex.allSetTime.selectFoodSet({dataSource:t.storefoodset,displayExpr:"foodSetName",valueExpr:"foodSetId",searchEnabled:!0,value:_.first(vmViewIndex.allSetTime.selectListFoodSetId()),placeholder:"Select..",onValueChanged:function(n){n.value===""||n.value===null||n.value===undefined||n.value.length==0?n.component.option("isValid",!1):n.component.option("isValid",!0);var t=u(cJsonGetFoodSetTimeMapById,n.value,products.cSmileDining);vmViewIndex.allSetting.isSmileDining()==!1&&(t=u(cJsonGetFoodSetTimeMapById,n.value,products.cSmileContactless));isEmpty(t)?DataTimeMenu(null):DataTimeMenu(JSON.parse(t));vmViewIndex.allSetTime.selectListFoodSetId([]);vmViewIndex.allSetTime.selectListFoodSetId.push(n.value)}}))}function hiddenShowTimeMenuEdit(){divShowTimeSun.hide();divShowTimeMon.hide();divShowTimeTue.hide();divShowTimeWed.hide();divShowTimeThu.hide();divShowTimeFri.hide();divShowTimeSat.hide();divShowTimeAlldays.hide()}function removeBorderClassTimeMenuEdit(){var n=$("#modalEditTimeMenu");n.find(".btn-circle.sun").removeClass("is-active-allday");n.find(".btn-circle.mon").removeClass("is-active-allday");n.find(".btn-circle.tue").removeClass("is-active-allday");n.find(".btn-circle.wed").removeClass("is-active-allday");n.find(".btn-circle.thu").removeClass("is-active-allday");n.find(".btn-circle.fri").removeClass("is-active-allday");n.find(".btn-circle.sat").removeClass("is-active-allday");n.find(".btn-circle.sat").removeClass("is-active-allday");n.find(".btn-circle.sun").removeClass("is-active-sun");n.find(".btn-circle.mon").removeClass("is-active-mon");n.find(".btn-circle.tue").removeClass("is-active-tue");n.find(".btn-circle.wed").removeClass("is-active-wed");n.find(".btn-circle.thu").removeClass("is-active-thu");n.find(".btn-circle.fri").removeClass("is-active-fri");n.find(".btn-circle.sat").removeClass("is-active-sat");n.find(".btn-circle.sat").removeClass("is-active-sat");n.find(".h6 a").removeClass("link-active-allday")}function hideErorrTimePeriodTimeMenuEdit(){var n=divShowTimeSun,t=divShowTimeMon,i=divShowTimeTue,r=divShowTimeWed,u=divShowTimeThu,f=divShowTimeFri,e=divShowTimeSat,o=divShowTimeAlldays;n.find(".gb_color-message-error").hide();t.find(".gb_color-message-error").hide();i.find(".gb_color-message-error").hide();r.find(".gb_color-message-error").hide();u.find(".gb_color-message-error").hide();f.find(".gb_color-message-error").hide();e.find(".gb_color-message-error").hide();o.find(".gb_color-message-error").hide();n.find("input:empty.input-validation-error").removeClass(cCssInputValidateError);t.find("input:empty.input-validation-error").removeClass(cCssInputValidateError);i.find("input:empty.input-validation-error").removeClass(cCssInputValidateError);r.find("input:empty.input-validation-error").removeClass(cCssInputValidateError);u.find("input:empty.input-validation-error").removeClass(cCssInputValidateError);f.find("input:empty.input-validation-error").removeClass(cCssInputValidateError);e.find("input:empty.input-validation-error").removeClass(cCssInputValidateError);o.find("input:empty.input-validation-error").removeClass(cCssInputValidateError)}function AllMapViewModel(){var n=this;n.settingDictionaryMapZone=ko.observableArray([]);n.settingDictionaryMapZonePrice=ko.observableArray([]);n.listMapZoneMile=ko.observableArray([]);n.shopMapCode=ko.observable("");n.shopLatitude=ko.observable("");n.shopLongitude=ko.observable("");n.typeMap=ko.observable(0);n.mapZone=ko.observableArray([]);n.tmpMapZone=n.mapZone();n.blurPrice=function(t,i){var r=$(i.target).val(),u;r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);u=ko.utils.arrayFilter(n.listMapZoneMile(),function(n){return n.mapZoneId()==t.mapZoneId()});_.first(u).price(r)};n.blurStartMile=function(t,i){var r=$(i.target).val(),u;r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);u=ko.utils.arrayFilter(n.listMapZoneMile(),function(n){return n.mapZoneId()==t.mapZoneId()});_.first(u).startMile(r)};n.blurEndMile=function(t,i){var r=$(i.target).val(),u;r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);u=ko.utils.arrayFilter(n.listMapZoneMile(),function(n){return n.mapZoneId()==t.mapZoneId()});_.first(u).endMile(r)};n.visibleZone1=ko.observable(!0);n.visibleZone2=ko.observable(!1);n.visibleZone3=ko.observable(!1);n.clickZone1=function(){n.visibleZone1(!0);n.visibleZone2(!1);n.visibleZone3(!1);getMap(_.first(vmViewIndex.allMapZone.mapZone()).MapZoneValue(),parseFloat(vmViewIndex.globalConfig.shopLatitude()),parseFloat(vmViewIndex.globalConfig.shopLongitude()),1)};n.clickZone2=function(){n.visibleZone1(!1);n.visibleZone2(!0);n.visibleZone3(!1);getMap(vmViewIndex.allMapZone.mapZone()[1].MapZoneValue(),parseFloat(vmViewIndex.globalConfig.shopLatitude()),parseFloat(vmViewIndex.globalConfig.shopLongitude()),2)};n.clickZone3=function(){n.visibleZone1(!1);n.visibleZone2(!1);n.visibleZone3(!0);getMap(vmViewIndex.allMapZone.mapZone()[2].MapZoneValue(),parseFloat(vmViewIndex.globalConfig.shopLatitude()),parseFloat(vmViewIndex.globalConfig.shopLongitude()),3)};n.switchMapZone=ko.observable(!0);n.clickChooseDrawMaps=function(){n.typeMap(0);getMap(_.first(vmViewIndex.allMapZone.mapZone()).MapZoneValue(),parseFloat(vmViewIndex.globalConfig.shopLatitude()),parseFloat(vmViewIndex.globalConfig.shopLongitude()),1)};n.clickChooseSetMile=function(){n.typeMap(1)};n.visibleMileZone1=ko.observable(!0);n.visibleMileZone2=ko.observable(!1);n.visibleMileZone3=ko.observable(!1);n.clickSetMileZone1=function(){n.visibleMileZone1(!0);n.visibleMileZone2(!1);n.visibleMileZone3(!1)};n.clickSetMileZone2=function(){n.visibleMileZone1(!1);n.visibleMileZone2(!0);n.visibleMileZone3(!1)};n.clickSetMileZone3=function(){n.visibleMileZone1(!1);n.visibleMileZone2(!1);n.visibleMileZone3(!0)};n.hasDeliveryFreeTime=ko.observable(!0);n.enableSaveChanges=ko.observable(!1);n.mapZone1Id=ko.observable(null);n.mapZone2Id=ko.observable(null);n.mapZone3Id=ko.observable(null);dataDeliveryFreeTime=divShowDeliveryFreeTime;showModalDeliveryFreeTime=modalDeliveryFreeTime;n.editStartTime=ko.observable(null);n.editEndTime=ko.observable(null);n.editMapZoneID=ko.observable(null);n.editShopMapCode=ko.observable(null);n.editDeliveryFreeTimeID=ko.observable(null);n.editActiveDeliveryFreeTime=ko.observable(!1);n.startDeliveryFreeTimeDrawMapZone1=ko.observable("");n.endDeliveryFreeTimeDrawMapZone1=ko.observable("");n.activeDeliveryDrawMapZone1=ko.observable("");n.activeDeliveryFreeTimeDrawMapZone1=ko.observable(!1);n.disableDeliveryFreeTimeDrawMapZone1=ko.observable(!0);n.valStartTimeDrawMapZone1=ko.observable(null);n.valEndTimeDrawMapZone1=ko.observable(null);n.valShopMapCodeDrawMapZone1=ko.observable(null);n.mapZoneIdDrawMapZone1=ko.observable(null);n.deliveryFreeTimeIdDrawMapZone1=ko.observable(null);n.startDeliveryFreeTimeDrawMapZone1({max:n.valEndTimeDrawMapZone1,pickerType:"list",type:"time",value:n.valStartTimeDrawMapZone1,disabled:n.disableDeliveryFreeTimeDrawMapZone1,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valStartTimeDrawMapZone1(moment(t.value,moment_time_format_hhmmss));n.editStartTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.endDeliveryFreeTimeDrawMapZone1({min:n.valStartTimeDrawMapZone1,type:"time",pickerType:"list",value:n.valEndTimeDrawMapZone1,disabled:n.disableDeliveryFreeTimeDrawMapZone1,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valEndTimeDrawMapZone1(moment(t.value,moment_time_format_hhmmss));n.editEndTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.activeDeliveryDrawMapZone1=ko.observable({offText:"NO",onText:"YES",value:n.activeDeliveryFreeTimeDrawMapZone1,width:switchActiveWidth55px,onValueChanged:function(t){t.value==!0?(n.disableDeliveryFreeTimeDrawMapZone1(!1),n.editActiveDeliveryFreeTime(!0)):(n.disableDeliveryFreeTimeDrawMapZone1(!0),n.editActiveDeliveryFreeTime(!1))}});n.startDeliveryFreeTimeDrawMapZone2=ko.observable("");n.endDeliveryFreeTimeDrawMapZone2=ko.observable("");n.activeDeliveryDrawMapZone2=ko.observable("");n.activeDeliveryFreeTimeDrawMapZone2=ko.observable(!1);n.disableDeliveryFreeTimeDrawMapZone2=ko.observable(!0);n.valStartTimeDrawMapZone2=ko.observable(null);n.valEndTimeDrawMapZone2=ko.observable(null);n.valShopMapCodeDrawMapZone2=ko.observable(null);n.mapZoneIdDrawMapZone2=ko.observable(null);n.deliveryFreeTimeIdDrawMapZone2=ko.observable(null);n.startDeliveryFreeTimeDrawMapZone2({max:n.valEndTimeDrawMapZone2,pickerType:"list",type:"time",value:n.valStartTimeDrawMapZone2,disabled:n.disableDeliveryFreeTimeDrawMapZone2,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valStartTimeDrawMapZone2(moment(t.value,moment_time_format_hhmmss));n.editStartTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.endDeliveryFreeTimeDrawMapZone2({min:n.valStartTimeDrawMapZone2,type:"time",pickerType:"list",value:n.valEndTimeDrawMapZone2,disabled:n.disableDeliveryFreeTimeDrawMapZone2,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valEndTimeDrawMapZone2(moment(t.value,moment_time_format_hhmmss));n.editEndTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.activeDeliveryDrawMapZone2=ko.observable({offText:"NO",onText:"YES",value:n.activeDeliveryFreeTimeDrawMapZone2,width:switchActiveWidth55px,onValueChanged:function(t){t.value==!0?(n.disableDeliveryFreeTimeDrawMapZone2(!1),n.editActiveDeliveryFreeTime(!0)):(n.disableDeliveryFreeTimeDrawMapZone2(!0),n.editActiveDeliveryFreeTime(!1))}});n.startDeliveryFreeTimeDrawMapZone3=ko.observable("");n.endDeliveryFreeTimeDrawMapZone3=ko.observable("");n.activeDeliveryDrawMapZone3=ko.observable("");n.activeDeliveryFreeTimeDrawMapZone3=ko.observable(!1);n.disableDeliveryFreeTimeDrawMapZone3=ko.observable(!0);n.valStartTimeDrawMapZone3=ko.observable(null);n.valEndTimeDrawMapZone3=ko.observable(null);n.valShopMapCodeDrawMapZone3=ko.observable(null);n.mapZoneIdDrawMapZone3=ko.observable(null);n.deliveryFreeTimeIdDrawMapZone3=ko.observable(null);n.startDeliveryFreeTimeDrawMapZone3({max:n.valEndTimeDrawMapZone3,pickerType:"list",type:"time",value:n.valStartTimeDrawMapZone3,disabled:n.disableDeliveryFreeTimeDrawMapZone3,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valStartTimeDrawMapZone3(moment(t.value,moment_time_format_hhmmss));n.editStartTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.endDeliveryFreeTimeDrawMapZone3({min:n.valStartTimeDrawMapZone3,type:"time",pickerType:"list",value:n.valEndTimeDrawMapZone3,disabled:n.disableDeliveryFreeTimeDrawMapZone3,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valEndTimeDrawMapZone3(moment(t.value,moment_time_format_hhmmss));n.editEndTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.activeDeliveryDrawMapZone3=ko.observable({offText:"NO",onText:"YES",value:n.activeDeliveryFreeTimeDrawMapZone3,width:switchActiveWidth55px,onValueChanged:function(t){t.value==!0?(n.disableDeliveryFreeTimeDrawMapZone3(!1),n.editActiveDeliveryFreeTime(!0)):(n.disableDeliveryFreeTimeDrawMapZone3(!0),n.editActiveDeliveryFreeTime(!1))}});n.startDeliveryFreeTimeSetMileZone1=ko.observable("");n.endDeliveryFreeTimeSetMileZone1=ko.observable("");n.activeDeliverySetMileZone1=ko.observable("");n.activeDeliveryFreeTimeSetMileZone1=ko.observable(!1);n.disableDeliveryFreeTimeSetMileZone1=ko.observable(!0);n.valStartTimeSetMileZone1=ko.observable(null);n.valEndTimeSetMileZone1=ko.observable(null);n.valShopMapCodeSetMileZone1=ko.observable(null);n.mapZoneIdSetMileZone1=ko.observable(null);n.deliveryFreeTimeIdSetMileZone1=ko.observable(null);n.startDeliveryFreeTimeSetMileZone1({max:n.valEndTimeSetMileZone1,pickerType:"list",type:"time",value:n.valStartTimeSetMileZone1,disabled:n.disableDeliveryFreeTimeSetMileZone1,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valStartTimeSetMileZone1(moment(t.value,moment_time_format_hhmmss));n.editStartTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.endDeliveryFreeTimeSetMileZone1({min:n.valStartTimeSetMileZone1,type:"time",pickerType:"list",value:n.valEndTimeSetMileZone1,disabled:n.disableDeliveryFreeTimeSetMileZone1,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valEndTimeSetMileZone1(moment(t.value,moment_time_format_hhmmss));n.editEndTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.activeDeliverySetMileZone1=ko.observable({offText:"NO",onText:"YES",value:n.activeDeliveryFreeTimeSetMileZone1,width:switchActiveWidth55px,onValueChanged:function(t){t.value==!0?(n.disableDeliveryFreeTimeSetMileZone1(!1),n.editActiveDeliveryFreeTime(!0)):(n.disableDeliveryFreeTimeSetMileZone1(!0),n.editActiveDeliveryFreeTime(!1))}});n.startDeliveryFreeTimeSetMileZone2=ko.observable("");n.endDeliveryFreeTimeSetMileZone2=ko.observable("");n.activeDeliverySetMileZone2=ko.observable("");n.activeDeliveryFreeTimeSetMileZone2=ko.observable(!1);n.disableDeliveryFreeTimeSetMileZone2=ko.observable(!0);n.valStartTimeSetMileZone2=ko.observable(null);n.valEndTimeSetMileZone2=ko.observable(null);n.valShopMapCodeSetMileZone2=ko.observable(null);n.mapZoneIdSetMileZone2=ko.observable(null);n.deliveryFreeTimeIdSetMileZone2=ko.observable(null);n.startDeliveryFreeTimeSetMileZone2({max:n.valEndTimeSetMileZone2,pickerType:"list",type:"time",value:n.valStartTimeSetMileZone2,disabled:n.disableDeliveryFreeTimeSetMileZone2,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valStartTimeSetMileZone2(moment(t.value,moment_time_format_hhmmss));n.editStartTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.endDeliveryFreeTimeSetMileZone2({min:n.valStartTimeSetMileZone2,type:"time",pickerType:"list",value:n.valEndTimeSetMileZone2,disabled:n.disableDeliveryFreeTimeSetMileZone2,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valEndTimeSetMileZone2(moment(t.value,moment_time_format_hhmmss));n.editEndTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.activeDeliverySetMileZone2=ko.observable({offText:"NO",onText:"YES",value:n.activeDeliveryFreeTimeSetMileZone2,width:switchActiveWidth55px,onValueChanged:function(t){t.value==!0?(n.disableDeliveryFreeTimeSetMileZone2(!1),n.editActiveDeliveryFreeTime(!0)):(n.disableDeliveryFreeTimeSetMileZone2(!0),n.editActiveDeliveryFreeTime(!1))}});n.startDeliveryFreeTimeSetMileZone3=ko.observable("");n.endDeliveryFreeTimeSetMileZone3=ko.observable("");n.activeDeliverySetMileZone3=ko.observable("");n.activeDeliveryFreeTimeSetMileZone3=ko.observable(!1);n.disableDeliveryFreeTimeSetMileZone3=ko.observable(!0);n.valStartTimeSetMileZone3=ko.observable(null);n.valEndTimeSetMileZone3=ko.observable(null);n.valShopMapCodeSetMileZone3=ko.observable(null);n.mapZoneIdSetMileZone3=ko.observable(null);n.deliveryFreeTimeIdSetMileZone3=ko.observable(null);n.startDeliveryFreeTimeSetMileZone3({max:n.valEndTimeSetMileZone3,pickerType:"list",type:"time",value:n.valStartTimeSetMileZone3,disabled:n.disableDeliveryFreeTimeSetMileZone3,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valStartTimeSetMileZone3(moment(t.value,moment_time_format_hhmmss));n.editStartTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.endDeliveryFreeTimeSetMileZone3({min:n.valStartTimeSetMileZone3,type:"time",pickerType:"list",value:n.valEndTimeSetMileZone3,disabled:n.disableDeliveryFreeTimeSetMileZone3,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valEndTimeSetMileZone3(moment(t.value,moment_time_format_hhmmss));n.editEndTime(moment(t.value).format(moment_time_format_HHmmss));n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.activeDeliverySetMileZone3=ko.observable({offText:"NO",onText:"YES",value:n.activeDeliveryFreeTimeSetMileZone3,width:switchActiveWidth55px,onValueChanged:function(t){t.value==!0?(n.disableDeliveryFreeTimeSetMileZone3(!1),n.editActiveDeliveryFreeTime(!0)):(n.disableDeliveryFreeTimeSetMileZone3(!0),n.editActiveDeliveryFreeTime(!1))}});n.clickDeliveryFreeTime=function(){var t=n.hasDeliveryFreeTime();n.hasDeliveryFreeTime(t);n.hasDeliveryFreeTime()&&(dataDeliveryFreeTime.hide(),n.editStartTime(null),n.editEndTime(null),n.editMapZoneID(null),n.editShopMapCode(null),n.editDeliveryFreeTimeID(null),n.editActiveDeliveryFreeTime(!1),n.typeMap()==0?n.visibleZone1()?(n.mapZoneIdDrawMapZone1()==null&&(n.mapZoneIdDrawMapZone1(n.mapZone1Id()),n.valShopMapCodeDrawMapZone1(n.typeMap())),dataDeliveryFreeTime.show(function(){n.editMapZoneID(n.mapZoneIdDrawMapZone1());n.editDeliveryFreeTimeID(n.deliveryFreeTimeIdDrawMapZone1());n.editShopMapCode(n.valShopMapCodeDrawMapZone1());n.editStartTime(moment(n.valStartTimeDrawMapZone1()).format(moment_time_format_HHmmss));n.editEndTime(moment(n.valEndTimeDrawMapZone1()).format(moment_time_format_HHmmss));n.editActiveDeliveryFreeTime(n.activeDeliveryFreeTimeDrawMapZone1());showModalDeliveryFreeTime.modal()})):n.visibleZone2()?(n.mapZoneIdDrawMapZone2()==null&&(n.mapZoneIdDrawMapZone2(n.mapZone2Id()),n.valShopMapCodeDrawMapZone2(n.typeMap())),dataDeliveryFreeTime.show(function(){n.editMapZoneID(n.mapZoneIdDrawMapZone2());n.editDeliveryFreeTimeID(n.deliveryFreeTimeIdDrawMapZone2());n.editShopMapCode(n.valShopMapCodeDrawMapZone2());n.editStartTime(moment(n.valStartTimeDrawMapZone2()).format(moment_time_format_HHmmss));n.editEndTime(moment(n.valEndTimeDrawMapZone2()).format(moment_time_format_HHmmss));n.editActiveDeliveryFreeTime(n.activeDeliveryFreeTimeDrawMapZone2());showModalDeliveryFreeTime.modal()})):n.visibleZone3()&&(n.mapZoneIdDrawMapZone3()==null&&(n.mapZoneIdDrawMapZone3(n.mapZone3Id()),n.valShopMapCodeDrawMapZone3(n.typeMap())),dataDeliveryFreeTime.show(function(){n.editMapZoneID(n.mapZoneIdDrawMapZone3());n.editDeliveryFreeTimeID(n.deliveryFreeTimeIdDrawMapZone3());n.editShopMapCode(n.valShopMapCodeDrawMapZone3());n.editStartTime(moment(n.valStartTimeDrawMapZone3()).format(moment_time_format_HHmmss));n.editEndTime(moment(n.valEndTimeDrawMapZone3()).format(moment_time_format_HHmmss));n.editActiveDeliveryFreeTime(n.activeDeliveryFreeTimeDrawMapZone3());showModalDeliveryFreeTime.modal()})):n.visibleMileZone1()?(n.mapZoneIdSetMileZone1()==null&&(n.mapZoneIdSetMileZone1(n.mapZone1Id()),n.valShopMapCodeSetMileZone1(n.typeMap())),dataDeliveryFreeTime.show(function(){n.editMapZoneID(n.mapZoneIdSetMileZone1());n.editDeliveryFreeTimeID(n.deliveryFreeTimeIdSetMileZone1());n.editShopMapCode(n.valShopMapCodeSetMileZone1());n.editStartTime(moment(n.valStartTimeSetMileZone1()).format(moment_time_format_HHmmss));n.editEndTime(moment(n.valEndTimeSetMileZone1()).format(moment_time_format_HHmmss));n.editActiveDeliveryFreeTime(n.activeDeliveryFreeTimeSetMileZone1());showModalDeliveryFreeTime.modal()})):n.visibleMileZone2()?(n.mapZoneIdSetMileZone2()==null&&(n.mapZoneIdSetMileZone2(n.mapZone2Id()),n.valShopMapCodeSetMileZone2(n.typeMap())),dataDeliveryFreeTime.show(function(){n.editMapZoneID(n.mapZoneIdSetMileZone2());n.editDeliveryFreeTimeID(n.deliveryFreeTimeIdSetMileZone2());n.editShopMapCode(n.valShopMapCodeSetMileZone2());n.editStartTime(moment(n.valStartTimeSetMileZone2()).format(moment_time_format_HHmmss));n.editEndTime(moment(n.valEndTimeSetMileZone2()).format(moment_time_format_HHmmss));n.editActiveDeliveryFreeTime(n.activeDeliveryFreeTimeSetMileZone2());showModalDeliveryFreeTime.modal()})):n.visibleMileZone3()&&(n.mapZoneIdSetMileZone3()==null&&(n.mapZoneIdSetMileZone3(n.mapZone3Id()),n.valShopMapCodeSetMileZone3(n.typeMap())),dataDeliveryFreeTime.show(function(){n.editMapZoneID(n.mapZoneIdSetMileZone3());n.editDeliveryFreeTimeID(n.deliveryFreeTimeIdSetMileZone3());n.editShopMapCode(n.valShopMapCodeSetMileZone3());n.editStartTime(moment(n.valStartTimeSetMileZone3()).format(moment_time_format_HHmmss));n.editEndTime(moment(n.valEndTimeSetMileZone3()).format(moment_time_format_HHmmss));n.editActiveDeliveryFreeTime(n.activeDeliveryFreeTimeSetMileZone3());showModalDeliveryFreeTime.modal()})))};n.activeCustomMile=ko.observable(!1);n.customMileZone=ko.observable();n.listValueCustom=ko.observableArray([]);n.jsonValueCustom=ko.observable();n.tempActiveCustomMile=ko.observable();n.tempCustomMileZone=ko.observable();n.tempListValueCustom=ko.observableArray([]);n.switchActiveCustomMile=ko.observable({offText:"NO",onText:"YES",value:n.activeCustomMile,width:switchActiveWidth55px,onValueChanged:function(t){t.value==!0?n.activeCustomMile(!0):n.activeCustomMile(!1)}});n.zoneSelect=ko.observable("1");n.allZone=ko.observableArray([{name:"Zone1",id:"1"},{name:"Zone2",id:"2"},{name:"Zone3",id:"3"}]);n.selectZone=ko.observable({dataSource:new DevExpress.data.ArrayStore({data:n.allZone(),key:"id"}),displayExpr:"name",valueExpr:"id",value:n.zoneSelect,placeholder:"Select Zone",onValueChanged:function(t){n.customMileZone(t.value);var i=rountTwo(parseFloat(vmViewIndex.allMapZone.listMapZoneMile()[t.value-1].endMile())+.01);n.listValueCustom()[0].minMile(i)}});n.clickMinusValueCustom=function(t){const i=t();var r=n.listValueCustom()[i].minMile();i+1<n.listValueCustom().length&&n.listValueCustom()[i+1].minMile(r);n.listValueCustom.splice(i,1)};n.clickPlusValueCustom=function(){var t=ko.observable(0),i=ko.observable(0),r=rountTwo(parseFloat(Math.max.apply(Math,n.listValueCustom().map(function(n){return n.maxMile()})))+.01),u=ko.observable(r);n.listValueCustom.push({minMile:u,maxMile:t,pricePerMile:i})};n.clickModalCustomMile=function(){var t,u,i;n.activeCustomMile(n.tempActiveCustomMile());n.customMileZone(n.tempCustomMileZone());var f=parseInt(n.customMileZone()),e=parseFloat(vmViewIndex.allMapZone.listMapZoneMile()[f-1].endMile()),r=[],i=ko.observable(0);for(t=0;t<n.tempListValueCustom().length;t++)t==0?(i=ko.observable(rountTwo(e+.01)),r.push({minMile:i,maxMile:n.tempListValueCustom()[t].maxMile,pricePerMile:n.tempListValueCustom()[t].pricePerMile})):(u=parseFloat(n.tempListValueCustom()[t-1].maxMile())+.01,i=ko.observable(rountTwo(u)),r.push({minMile:i,maxMile:n.tempListValueCustom()[t].maxMile,pricePerMile:n.tempListValueCustom()[t].pricePerMile}));if(n.listValueCustom(r.slice(0)),n.listValueCustom().length==0){var o=ko.observable(0),s=ko.observable(0),i=ko.observable(0);i(parseFloat(vmViewIndex.allMapZone.listMapZoneMile()[0].endMile()));n.listValueCustom.push({minMile:i,maxMile:o,pricePerMile:s})}n.zoneSelect(n.customMileZone())};n.blurMaxMile=function(t,i,r){var u=$(r.target).val();const f=t();u=$.isNumeric(u)?rountTwo(u):0;u<0&&(u=0);n.listValueCustom()[f].maxMile(u);n.listValueCustom().length!=f+1&&n.listValueCustom()[f+1].minMile(rountTwo(u+.01))};n.blurPricePerMile=function(t,i,r){var u=$(r.target).val();const f=t();u=$.isNumeric(u)?rountTwo(u):0;u<0&&(u=0);n.listValueCustom()[f].pricePerMile(u)};n.valueCustomObj=ko.pureComputed(function(){return ko.toJSON(n.listValueCustom())});n.clickSubmitCustonMile=function(){verifyMaxMile()?verifyMaxMileDuplicate()?vmViewIndex.allMapZone.customMileZone()!="3"&&vmViewIndex.allMapZone.activeCustomMile()?swalConfirmSaveOverMile(cfrmUpdateCustomMapZoneMile,vmViewIndex.allMapZone.customMileZone()):$("#"+cfrmUpdateCustomMapZoneMile).submit():swal(cSwal_Alert_Error,cError_CustomOverMile_MaxMile_Duplicate,cSwal_Icon_Error):swal(cSwal_Alert_Error,cError_CustomOverMile_MaxMile_LessThan,cSwal_Icon_Error)};n.clickSubmitMapZoneMile=function(){verifyMapZoneMile()?$("#"+cfrmUpdateMapZoneMile).submit():swalConfirmSaveMapZoneMile(cfrmUpdateMapZoneMile,vmViewIndex.allMapZone.tempCustomMileZone())}}function AllRestaurantViewModel(){var n=this;n.data=ko.observableArray([]);n.selectBoxDomainId=ko.observable("");n.selectBoxAllRestaurant=ko.observable("")}function GlobalConfigViewModel(n,t){var i=this,r,u,f,e;if(isEmpty(n))i.allTimeZone=ko.observableArray([]),i.shopNumber=ko.observable(""),i.shopName=ko.observable(""),i.shopCode=ko.observable(""),i.shopStreet=ko.observable(""),i.shopZipCode=ko.observable(""),i.shopPhone=ko.observable(""),i.shopBroad=ko.observable(""),i.timeStartPickup=ko.observable(""),i.timeEndPickup=ko.observable(""),i.timeStartDelivery=ko.observable(""),i.timeEndDelivery=ko.observable(""),i.shopLatitude=ko.observable(""),i.shopLongitude=ko.observable(""),i.shopMapCode=ko.observable(""),i.shopDeliveryTax=ko.observable(""),i.payByCash=ko.observable(""),i.payByCredit=ko.observable(""),i.minimumOrder=ko.observable(""),i.shopOpen=ko.observable(""),i.shopOpenContactless=ko.observable(""),i.shopCloseReason=ko.observable(""),i.shopCloseStartDate=ko.observable(""),i.shopCloseEndDate=ko.observable(""),i.shippingType=ko.observable(""),i.startDate=ko.observable(""),i.endDate=ko.observable(""),i.isShopOpen=ko.observable(!0),i.isShopOpenContactless=ko.observable(!0),i.txtShopOpen=ko.observable(""),i.txtShopOpenContactless=ko.observable(""),i.currentDate=ko.observable(""),i.switchShopOpen=ko.observable(),i.switchShopOpenUtils=ko.observable(),i.switchShopOpenUtilsContactless=ko.observable(),i.dxShopCloseStart=ko.observable(),i.dxShopCloseEnd=ko.observable(),i.shopPeriodTime=ko.observable(""),i.shopPeriodTimePickup=ko.observable(""),i.shopPeriodTimeDelivery=ko.observable(""),i.shopLogo=ko.observable(""),i.shopLastUpdate=ko.observable(""),i.calTax=ko.observable(""),i.shopLogo=ko.observable(""),i.shopBackground=ko.observable(""),i.delShopBackground=ko.observable(!1),i.shopTimeZoneCode=ko.observable(""),i.selectBoxTimeZoneCode=ko.observable(""),i.shipmentType=ko.observable(""),i.mapOptions=ko.observable(""),i.specialInstructions=ko.observable(""),i.allowJoinTicket=ko.observable(!1),i.showPartySize=ko.observable(!1),i.tipsDesc=ko.observable(""),i.themeColor=ko.observable(""),i.tipsAuto=ko.observable(""),i.isShopInfo=ko.observable(""),i.tipsDescForStore=ko.observable(""),i.tipsDescForCredit=ko.observable(""),i.customButtonPayAtStore=ko.observable(""),i.customButtonCredit=ko.observable(""),i.customSpecialInstructions=ko.observable(""),i.customButtonPickup=ko.observable(""),i.customButtonDelivery=ko.observable(""),i.hasAnnounceData=ko.observable(!1),i.shopHeader=ko.observable(""),i.shopBadge=ko.observable(""),i.shopActive=ko.observable(""),i.shopAnnounceImage=ko.observable(""),i.delAnnounceImage=ko.observable(!1),i.delShopLogo=ko.observable(!1),i.shopAnnounceCustomImage=ko.observable(""),i.shopAnnounceCustomActive=ko.observable(""),i.delAnnounceCustomImage=ko.observable(!1),i.isShowAnnouceCustom=ko.observable(!1),i.showCustom=ko.observable(!1),i.switchShopCustom=ko.observable({offText:"No",onText:"Yes",value:i.showCustom,width:80,onValueChanged:function(n){n.value==!0?(i.showCustom(!0),$("#showUploadAnnounceImage").val(""),$("#showUploadAnnounceCustomImage").val("")):(i.showCustom(!1),$("#showUploadAnnounceImage").val(""),$("#showUploadAnnounceCustomImage").val(""))}}),i.tipGuide=ko.observable(""),i.tipGuideArray=ko.observableArray([]),i.showTipGuidePlus=ko.observable(!1),i.showTipGuideMinus=ko.observable(!1),i.currentDateTime=ko.observable(""),i.orderLimit=ko.observable("0"),i.topic=ko.observable(""),i.question=ko.observable(""),i.descriptionSelect=ko.observable(""),i.descriptionNotSelect=ko.observable(""),i.addPrice=ko.observable(""),i.autoSelect=ko.observable(""),i.showUtensils=ko.observable(""),i.showCurbsidePickup=ko.observable("0"),i.customCurbsideInstruction=ko.observable(""),i.dataTipsGuideAuto=ko.observableArray([]),i.selectTipGuideAuto=ko.observableArray([]),i.showGuestCheckOut=ko.observable("0"),i.autoSyncProduct=ko.observable(!1);else{i.allTimeZone=ko.observableArray([]);ko.mapping.fromJS(t,{},i.allTimeZone);i.shopNumber=ko.observable(filterGlobalConfig(n,gcShopNumber));i.shopName=ko.observable(filterGlobalConfig(n,gcShopName));i.shopCode=ko.observable(filterGlobalConfig(n,gcShopCode));i.shopStreet=ko.observable(filterGlobalConfig(n,gcShopStreet));i.shopZipCode=ko.observable(filterGlobalConfig(n,gcShopPostal));i.shopPhone=ko.observable(getPhoneFormatUs(filterGlobalConfig(n,gcShopPhone)));i.shopBroad=ko.observable(filterGlobalConfig(n,gcShopBroad));i.isShopInfo=ko.observable(filterGlobalConfig(n,"shop-info")=="1"||filterGlobalConfig(n,"shop-info")==""?!0:!1);i.hasAnnounceData=ko.observable(!0);i.shopHeader=ko.observable(filterGlobalConfig(n,gcAnnounceHeader));i.shopBadge=ko.observable(filterGlobalConfig(n,gcAnnounceBadge));i.shopActive=ko.observable(filterGlobalConfig(n,gcAnnounceActive));i.shopAnnounceImage=ko.observable(filterGlobalConfig(n,gcAnnounceImage));i.shopAnnounceCustomImage=ko.observable(filterGlobalConfig(n,"broad-custom-image"));i.shopAnnounceCustomActive=ko.observable(filterGlobalConfig(n,"broad-custom-active"));i.delAnnounceCustomImage=ko.observable(!1);i.shopAnnounceCustomImage()==""||i.shopAnnounceCustomImage()==null?i.delAnnounceCustomImage(!1):i.delAnnounceCustomImage(!0);i.isShowAnnouceCustom=ko.observable(!1);i.showCustom=ko.observable(!1);i.switchShopCustom=ko.observable({offText:"No",onText:"Yes",value:i.showCustom,width:80,onValueChanged:function(n){n.value==!0?(i.showCustom(!0),$("#showUploadAnnounceImage").val(i.shopAnnounceImage()),$("#showUploadAnnounceCustomImage").val(i.shopAnnounceCustomImage())):(i.showCustom(!1),$("#showUploadAnnounceImage").val(i.shopAnnounceImage()),$("#showUploadAnnounceCustomImage").val(i.shopAnnounceCustomImage()))}});i.delAnnounceImage=ko.observable(!1);i.delShopLogo=ko.observable(!1);i.delShopBackground=ko.observable(!1);i.shopAnnounceImage()==""||i.shopAnnounceImage()==null?i.delAnnounceImage(!1):i.delAnnounceImage(!0);r="";switch(checkResolution()){case"xs":r=cMobile;break;case"sm":r=cTABLET;break;case"md":r=cTABLET;break;default:r=cDESKTOP}cPathGiftCardImage=cProtocal+"://img.smiledining.com/"+i.shopCode()+"/GIFTCER/"+ +r+"/";cPathFileBase=cProtocal+"://img.smiledining.com/"+i.shopCode()+"/";i.currentDateTime=ko.observable(filterGlobalConfig(n,"currentDateTime"));i.timeStartPickup=ko.observable(filterGlobalConfig(n,gcTimePickupStart));i.timeEndPickup=ko.observable(filterGlobalConfig(n,gcTimePickupEnd));i.timeStartDelivery=ko.observable(filterGlobalConfig(n,gcTimeDeliveryStart));i.timeEndDelivery=ko.observable(filterGlobalConfig(n,gcTimeDeliveryEnd));i.shopLatitude=ko.observable(filterGlobalConfig(n,gcShopMapLat));i.shopLongitude=ko.observable(filterGlobalConfig(n,gcShopMapLng));i.shopMapCode=ko.observable(filterGlobalConfig(n,gcShopMapCode));i.shopDeliveryTax=ko.observable(filterGlobalConfig(n,gcShopDeliveryTax));i.payByCash=ko.observable(filterGlobalConfig(n,gcPayByCash));i.payByCredit=ko.observable(filterGlobalConfig(n,gcPayByCredit));i.minimumOrder=ko.observable(parseFloat(filterGlobalConfig(n,gcCalminumumOrder)));i.shopOpen=ko.observable(shopStatus(filterGlobalConfig(n,gcShopStatus)));i.tipGuide=ko.observable(filterGlobalConfig(n,"tip-guide"));i.tipGuide()==""&&i.tipGuide("10,15,18,20");i.shopOpenContactless=ko.observable(shopStatus(filterGlobalConfig(n,gcShopStatus)));i.shopCloseReason=ko.observable(filterGlobalConfig(n,gcShopCloseReason));u=ko.observable(filterGlobalConfig(n,gcShopCloseStartDate));u.length>0&&(u=moment(u,moment_date_format_yyyymmddthhmmss).format(moment_date_format_yyyymmdd));f=ko.observable(filterGlobalConfig(n,gcShopCloseEndDate));f.length>0&&(f=moment(f,moment_date_format_yyyymmddthhmmss).format(moment_date_format_yyyymmdd));i.shopCloseStartDate=ko.observable(u);i.shopCloseEndDate=ko.observable(f);i.shippingType=ko.observable(filterGlobalConfig(n,gcShippingType));i.shopPeriodTime=ko.observable(filterGlobalConfig(n,gcShopPeriodTime));i.shopPeriodTimePickup=ko.observable(filterGlobalConfig(n,"shop-period-time-pickup"));i.shopPeriodTimeDelivery=ko.observable(filterGlobalConfig(n,"shop-period-time-delivery"));i.shopLogo=ko.observable(filterGlobalConfig(n,gcShopLogo));i.shopBackground=ko.observable(filterGlobalConfig(n,"shop-background"));i.shopLastUpdate=ko.observable(filterGlobalConfig(n,gcShopLastUpdate));i.calTax=ko.observable(filterGlobalConfig(n,gcCalTax));i.shopTimeZoneCode=ko.observable(filterGlobalConfig(n,gcShopTimeZoneCode));i.shipmentType=ko.observable(getShippingType(filterGlobalConfig(n,gcShippingType)));i.specialInstructions=ko.observable(filterGlobalConfig(n,gcSpecialInstructions));i.allowJoinTicket=ko.observable(filterGlobalConfig(n,"allow-join-ticket"));i.showPartySize=ko.observable(filterGlobalConfig(n,"contactless-show-party-size"));i.tipsDesc=ko.observable(filterGlobalConfig(n,gcTipsDesc));i.themeColor=ko.observable(filterGlobalConfig(n,gcThemeColor));i.tipsAuto=ko.observable(filterGlobalConfig(n,"tip-auto"));i.tipsDescForStore=ko.observable(filterGlobalConfig(n,gcTipsDescForStore));i.tipsDescForCredit=ko.observable(filterGlobalConfig(n,gcTipsDescForCredit));i.customButtonPayAtStore=ko.observable(filterGlobalConfig(n,gcCustomButtonPayAtStore));i.customButtonCredit=ko.observable(filterGlobalConfig(n,gcCustomButtonCredit));i.customSpecialInstructions=ko.observable(filterGlobalConfig(n,gcCustomSpecialInstructions));i.customButtonPickup=ko.observable(filterGlobalConfig(n,"custom-button-type-pickup"));i.customButtonDelivery=ko.observable(filterGlobalConfig(n,"custom-button-type-delivery"));i.orderLimit=ko.observable(filterGlobalConfig(n,gcOrderLimit));i.topic=ko.observable(filterGlobalConfig(n,"utensils-topic"));i.question=ko.observable(filterGlobalConfig(n,"utensils-question"));i.descriptionSelect=ko.observable(filterGlobalConfig(n,"utensils-description-select"));i.descriptionNotSelect=ko.observable(filterGlobalConfig(n,"utensils-description-not-select"));i.addPrice=ko.observable(filterGlobalConfig(n,"utensils-price"));i.autoSelect=ko.observable(filterGlobalConfig(n,"utensils-auto-select"));i.showUtensils=ko.observable(filterGlobalConfig(n,"utensils-show"));e=i.tipGuide().split(",");i.tipGuideArray=ko.observableArray([]);i.tipGuideArray(e);i.showTipGuidePlus=ko.observable(!1);i.showTipGuideMinus=ko.observable(!1);i.showTipGuidePlus(e.length==4?!1:!0);i.showTipGuideMinus(e.length==1?!1:!0);updateTipGuideTable(i.tipGuideArray());i.showCurbsidePickup=ko.observable(filterGlobalConfig(n,gcShowCurbsidePickup));i.showCurbsidePickup()==""&&i.showCurbsidePickup("0");i.customCurbsideInstruction=ko.observable(filterGlobalConfig(n,gcCustomCurbsideInstruction));i.customCurbsideInstruction()==""&&i.customCurbsideInstruction(cCurbsideInstructionDefault);i.showGuestCheckOut=ko.observable(filterGlobalConfig(n,"show-guest-checkout"));i.autoSyncProduct=ko.observable(filterGlobalConfig(n,"deliverect-autosync-product")=="1"?!0:!1);i.shopLogo()==""||i.shopLogo()==null?i.delShopLogo(!1):i.delShopLogo(!0);i.shopBackground()==""||i.shopBackground()==null?i.delShopBackground(!1):i.delShopBackground(!0);i.selectBoxTimeZoneCode=ko.observable(i.shopTimeZoneCode());i.shopTimeZoneCode({dataSource:new DevExpress.data.ArrayStore({data:i.allTimeZone(),key:"timeZoneCode"}),dropDownButtonTemplate:"dropDownButton",displayExpr:o,valueExpr:"timeZoneCode",value:i.selectBoxTimeZoneCode,searchEnabled:!0,onValueChanged:function(n){var t=ko.utils.arrayFilter(i.allTimeZone(),function(t){return t.timeZoneCode()==n.value}),r=_.first(t);i.selectBoxTimeZoneCode(r.timeZoneCode());i.shopTimeZoneCode().value=n.value}});function o(n){return n?n.name()+" "+n.time():""}i.startDate=ko.observable("");i.endDate=ko.observable("");i.isShopOpen=ko.observable(!0);i.isShopOpenContactless=ko.observable(!0);i.txtShopOpen=ko.observable("");i.txtShopOpenContactless=ko.observable("");i.currentDate=ko.observable(moment(i.currentDateTime(),moment_date_format_mmddyyyyhhmmssa).format(moment_date_format_yyyymmdd));i.computeMinEndDate=ko.pureComputed(function(){return i.startDate()==null||isEmpty(i.startDate())?i.currentDate():moment(i.startDate()).isAfter(i.currentDate())?i.startDate():i.currentDate()});i.switchShopOpen=ko.observable({offText:"Close",onText:"Open",value:i.isShopOpen,width:80,onValueChanged:function(n){n.value==!0?(i.txtShopOpen("OPEN"),i.isShopOpen(!0)):(i.txtShopOpen("CLOSE"),i.isShopOpen(!1))}});i.switchShopOpenUtils=ko.observable();i.switchShopOpenUtilsContactless=ko.observable();i.dxShopCloseStart=ko.observable({value:i.startDate,width:"auto",pickerType:"calendar",type:"date",min:i.currentDate,acceptCustomValue:!0,onValueChanged:function(n){n.value?i.startDate(moment(n.value,moment_date_format_yyyymmdd).format(moment_date_format_yyyymmdd)):i.startDate("")}});i.dxShopCloseEnd=ko.observable({value:i.endDate,width:"auto",pickerType:"calendar",type:"date",min:i.computeMinEndDate,acceptCustomValue:!0,onValueChanged:function(n){n.value?i.endDate(moment(n.value,moment_date_format_yyyymmdd).format(moment_date_format_yyyymmdd)):i.endDate("")}});i.dataTipsGuideAuto=ko.observableArray([]);i.dataTipsGuideAuto.push("Off");ko.utils.arrayForEach(i.tipGuideArray(),function(n){i.dataTipsGuideAuto.push(n+"")});i.selectTipGuideAuto=ko.observable({dataSource:new DevExpress.data.ArrayStore({data:i.dataTipsGuideAuto()}),value:i.tipsAuto()==""?"Off":i.tipsAuto(),onValueChanged:function(n){i.tipsAuto(n.value);setTipsAuto(n.value)}})}i.clickMinusTipGuide=function(n,t){var u=ko.contextFor(t.target),f=u.$index(),r=vmViewIndex.globalConfig.tipGuideArray();r.splice(f,1);vmViewIndex.globalConfig.tipGuideArray(r);i.tipGuideArray().length<4&&vmViewIndex.globalConfig.showTipGuidePlus(!0);i.tipGuideArray().length==1&&vmViewIndex.globalConfig.showTipGuideMinus(!1);updateTipGuideTable(i.tipGuideArray());resetTipsAuto()};i.clickPlusTipGuide=function(){i.tipGuideArray.push("");i.tipGuideArray().length==4&&vmViewIndex.globalConfig.showTipGuidePlus(!1);i.tipGuideArray().length>1&&vmViewIndex.globalConfig.showTipGuideMinus(!0);updateTipGuideTable(i.tipGuideArray())};i.updateTipGuideArray=function(n,t,i){var r=$(i.target).val(),u;r=$.isNumeric(r)?rountTwo(r):"";r<0&&(r="");u=ko.observableArray([]);const f=n();u(vmViewIndex.globalConfig.tipGuideArray.slice(0));u.splice(f,1,r);vmViewIndex.globalConfig.tipGuideArray.removeAll();vmViewIndex.globalConfig.tipGuideArray(u().slice(0));resetTipsAuto()}}function resetTipsAuto(){var t,n,r;const i=ko.utils.arrayFilter(vmViewIndex.globalConfig.tipGuideArray(),function(n){return n==vmViewIndex.globalConfig.tipsAuto()});t=$("#selectTipAuto").dxSelectBox("instance");isEmpty(t)||(n=t.getDataSource(),r=n.items(),n.store().clear(),n.store().insert("Off"),ko.utils.arrayForEach(vmViewIndex.globalConfig.tipGuideArray(),function(t){n.store().insert(t+"")}),n.load(),t.option("value",i.length==0?"Off":_.head(i)+""),setTipsAuto(vmViewIndex.globalConfig.tipsAuto()))}function setTipsAuto(n){$(".tipsAuto").removeClass("hover");isEmpty(n)||$(".tipsAuto").filter('[data-tip="tipsAuto'+n+'"]').addClass("hover")}function updateTipGuideTable(n){for(var r=$(window).width(),t=0,u=n.length,f=r<576?20:15,i=0;i<u;i++)t+=f;document.getElementById("tb-tipguide").style.width=t+"%"}function CustomerViewModel(n){var t=this;isEmpty(n)?(t.customerId=ko.observable(""),t.firstName=ko.observable(""),t.lastName=ko.observable(""),t.flag=ko.observable(!1),t.email=ko.observable(""),t.isExternalLogIn=ko.observable(!1)):ko.mapping.fromJSON(n,{},t)}function ChangePassword(){var n=this;n.oldPassword=ko.observable("");n.newPassword=ko.observable("");n.confirmPassword=ko.observable("")}function MapViewModel(n,t,i){var r=this;r.mapzone=ko.observableArray([]);r.mapzoneGeography=ko.observableArray([]);r.mapzoneMile=ko.observableArray([]);ko.mapping.fromJSON(n,{},r.mapzone);ko.mapping.fromJSON(t,{},r.mapzoneGeography);ko.mapping.fromJSON(i,{},r.mapzoneMile)}function DeliveryChargeViewModel(n){var t=this;t.deliveryChargePercentage=ko.observableArray([]);ko.mapping.fromJSON(n,{},t.deliveryChargePercentage)}function LiveOrderViewModel(){var n=this;n.ticket=ko.observableArray([]);n.confirm=ko.observable(!1);n.activeFeeCreditMarketing=ko.observable(!1);n.showFoodDetail=function(n,t){var i=$(t.target).parent().parent().parent().parent().parent().parent().parent().parent().parent();i.find(".front").rotateY(180);i.find(".back").rotateY(0)};n.showTicket=function(n,t){var i=$(t.target).parent().parent().parent().parent().parent().parent().parent().parent();i.find(".front").rotateY(0);i.find(".back").rotateY(180)}}function convertBase64toFile(n){const t=new Promise((t,i)=>{fetch(n).then(n=>n.blob()).then(n=>{const r=new File([n],"Filename.jpg",{type:"image/jpeg"});typeof r!="undefined"?t(r):i(new Error(r))})});t.then(t=>{const i=t;vmViewIndex.menu.checkDataMenu()!="undefined"?($("img",vmViewIndex.menu.elementImageId()).attr("src",n),$("img",vmViewIndex.menu.elementImageId()).attr("width","115"),$("img",vmViewIndex.menu.elementImageId()).attr("height","115"),vmViewIndex.menu.dataSetupFoodModal.image(n),vmViewIndex.menu.dataSetupFoodModal.tempId(i),$("#modalSetUpFoodUploadImage").modal("hide"),removeSpinButton("modalSetUpFoodUploadImage"),vmViewIndex.disableButtonCloseModal(!1),vmViewIndex.disablePointer("pointer")):vmViewIndex.menu.typeUploadImage()=="dropImage"?vmViewIndex.menu.uploadDropImage(i):vmViewIndex.menu.typeUploadImage()=="clickImage"&&vmViewIndex.menu.submitChangeImage(vmViewIndex.menu.elementChangeImage(),i,!0)});t.catch(()=>{swal("Error",cSwal_Alert_Error,cSwal_Icon_Error),vmViewIndex.menu.dataSetupFoodModal.image(""),vmViewIndex.disableButtonCloseModal(!1),vmViewIndex.disablePointer("pointer"),$("#modalSetUpFoodUploadImage").modal("hide")})}function MenuSetupViewModel(){var n=this;n.firstShowSunStartTime=ko.observable("");n.firstShowSunEndTime=ko.observable("");n.secondShowSunStartTime=ko.observable("");n.secondShowSunEndTime=ko.observable("");n.firstShowMonStartTime=ko.observable("");n.firstShowMonEndTime=ko.observable("");n.secondShowMonStartTime=ko.observable("");n.secondShowMonEndTime=ko.observable("");n.firstShowTueStartTime=ko.observable("");n.firstShowTueEndTime=ko.observable("");n.secondShowTueStartTime=ko.observable("");n.secondShowTueEndTime=ko.observable("");n.firstShowWedStartTime=ko.observable("");n.firstShowWedEndTime=ko.observable("");n.secondShowWedStartTime=ko.observable("");n.secondShowWedEndTime=ko.observable("");n.firstShowThuStartTime=ko.observable("");n.firstShowThuEndTime=ko.observable("");n.secondShowThuStartTime=ko.observable("");n.secondShowThuEndTime=ko.observable("");n.firstShowFriStartTime=ko.observable("");n.firstShowFriEndTime=ko.observable("");n.secondShowFriStartTime=ko.observable("");n.secondShowFriEndTime=ko.observable("");n.firstShowSatStartTime=ko.observable("");n.firstShowSatEndTime=ko.observable("");n.secondShowSatStartTime=ko.observable("");n.secondShowSatEndTime=ko.observable("");n.tempDataShowTime=ko.observableArray([]);n.dataShowTime=ko.observableArray([]);n.choiceOptions=ko.observableArray([]);n.choice=ko.observableArray([]);n.dataMenu=ko.observableArray([]);n.dataFoodChoiceMap=ko.observableArray([]);n.isActiveFilterMenuFoodSet=ko.observable(!0);n.isDeactiveFilterMenuFoodSet=ko.observable(!1);n.isAllFilterMenuFoodSet=ko.observable(!1);n.isActiveFilterMenuFoodCat=ko.observable(!0);n.isDeactiveFilterMenuFoodCat=ko.observable(!1);n.isAllFilterMenuFoodCat=ko.observable(!1);n.isActiveFilterMenuFood=ko.observable(!0);n.isDeactiveFilterMenuFood=ko.observable(!1);n.isAllFilterMenuFood=ko.observable(!1);n.valueFilterMenuFoodSet=ko.observable(1);n.valueFilterMenuFoodCat=ko.observable(1);n.valueFilterMenuFood=ko.observable(1);n.defaultIsActiveFilterMenuFoodSet=ko.observable(!0);n.defaultIsDeactiveFilterMenuFoodSet=ko.observable(!1);n.defaultIsAllFilterMenuFoodSet=ko.observable(!1);n.defaultIsActiveFilterMenuFoodCat=ko.observable(!0);n.defaultIsDeactiveFilterMenuFoodCat=ko.observable(!1);n.defaultIsAllFilterMenuFoodCat=ko.observable(!1);n.defaultIsActiveFilterMenuFood=ko.observable(!0);n.defaultIsDeactiveFilterMenuFood=ko.observable(!1);n.defaultIsAllFilterMenuFood=ko.observable(!1);n.defaultValueFilterMenuFoodSet=ko.observable(1);n.defaultValueFilterMenuFoodCat=ko.observable(1);n.defaultValueFilterMenuFood=ko.observable(1);n.showFilterMenu=ko.observable(!1);n.defaultValueFilterProduct=ko.observable(products.cAllProduct);n.popupFilterMenu=ko.observable({width:600,height:280,contentTemplate:"filterMenu",position:{my:"top center",at:"top center",offset:"0 0",of:$("#showMenuSetUp")},height:function(){return $(window).width()<767?$(window).height()*1:280},width:function(){return $(window).width()<767?$(window).width()*1:600},shading:!1,async:!1,model:!1,showTitle:!0,titleTemplate:"<strong>Filter Menu<\/strong>",visible:n.showFilterMenu,dragEnabled:!1,closeOnOutsideClick:!0});n.clearFilterMenu=function(){n.valueFilterMenuFoodSet(n.defaultValueFilterMenuFoodSet());n.isActiveFilterMenuFoodSet(n.defaultIsActiveFilterMenuFoodSet());n.isDeactiveFilterMenuFoodSet(n.defaultIsDeactiveFilterMenuFoodSet());n.isAllFilterMenuFoodSet(n.defaultIsAllFilterMenuFoodSet());n.valueFilterMenuFoodCat(n.defaultValueFilterMenuFoodCat());n.isActiveFilterMenuFoodCat(n.defaultIsActiveFilterMenuFoodCat());n.isDeactiveFilterMenuFoodCat(n.defaultIsDeactiveFilterMenuFoodCat());n.isAllFilterMenuFoodCat(n.defaultIsAllFilterMenuFoodCat());n.valueFilterMenuFood(n.defaultValueFilterMenuFood());n.isActiveFilterMenuFood(n.defaultIsActiveFilterMenuFood());n.isDeactiveFilterMenuFood(n.defaultIsDeactiveFilterMenuFood());n.isAllFilterMenuFood(n.defaultIsAllFilterMenuFood())};n.AddDefaultFilterMenu=function(){n.defaultValueFilterMenuFoodSet(n.valueFilterMenuFoodSet());n.defaultIsActiveFilterMenuFoodSet(n.isActiveFilterMenuFoodSet());n.defaultIsDeactiveFilterMenuFoodSet(n.isDeactiveFilterMenuFoodSet());n.defaultIsAllFilterMenuFoodSet(n.isAllFilterMenuFoodSet());n.defaultValueFilterMenuFoodCat(n.valueFilterMenuFoodCat());n.defaultIsActiveFilterMenuFoodCat(n.isActiveFilterMenuFoodCat());n.defaultIsDeactiveFilterMenuFoodCat(n.isDeactiveFilterMenuFoodCat());n.defaultIsAllFilterMenuFoodCat(n.isAllFilterMenuFoodCat());n.defaultValueFilterMenuFood(n.valueFilterMenuFood());n.defaultIsActiveFilterMenuFood(n.isActiveFilterMenuFood());n.defaultIsDeactiveFilterMenuFood(n.isDeactiveFilterMenuFood());n.defaultIsAllFilterMenuFood(n.isAllFilterMenuFood())};n.clickActiveFilterMenuFoodSet=function(){return n.valueFilterMenuFoodSet(1),n.isActiveFilterMenuFoodSet(!0),n.isDeactiveFilterMenuFoodSet(!1),n.isAllFilterMenuFoodSet(!1),!0};n.clickDeactiveFilterMenuFoodSet=function(){return n.valueFilterMenuFoodSet(2),n.isActiveFilterMenuFoodSet(!1),n.isDeactiveFilterMenuFoodSet(!0),n.isAllFilterMenuFoodSet(!1),!0};n.clickAllFilterMenuFoodSet=function(){return n.valueFilterMenuFoodSet(3),n.isActiveFilterMenuFoodSet(!1),n.isDeactiveFilterMenuFoodSet(!1),n.isAllFilterMenuFoodSet(!0),!0};n.clickActiveFilterMenuFoodCat=function(){return n.valueFilterMenuFoodCat(1),n.isActiveFilterMenuFoodCat(!0),n.isDeactiveFilterMenuFoodCat(!1),n.isAllFilterMenuFoodCat(!1),!0};n.clickDeactiveFilterMenuFoodCat=function(){return n.valueFilterMenuFoodCat(2),n.isActiveFilterMenuFoodCat(!1),n.isDeactiveFilterMenuFoodCat(!0),n.isAllFilterMenuFoodCat(!1),!0};n.clickAllFilterMenuFoodCat=function(){return n.valueFilterMenuFoodCat(3),n.isActiveFilterMenuFoodCat(!1),n.isDeactiveFilterMenuFoodCat(!1),n.isAllFilterMenuFoodCat(!0),!0};n.clickActiveFilterMenuFood=function(){return n.valueFilterMenuFood(1),n.isActiveFilterMenuFood(!0),n.isDeactiveFilterMenuFood(!1),n.isAllFilterMenuFood(!1),!0};n.clickDeactiveFilterMenuFood=function(){return n.valueFilterMenuFood(2),n.isActiveFilterMenuFood(!1),n.isDeactiveFilterMenuFood(!0),n.isAllFilterMenuFood(!1),!0};n.clickAllFilterMenuFood=function(){return n.valueFilterMenuFood(3),n.isActiveFilterMenuFood(!1),n.isDeactiveFilterMenuFood(!1),n.isAllFilterMenuFood(!0),!0};n.btnCloseFilterMenu=function(){n.clearFilterMenu();n.showFilterMenu(!1)};n.btnClickFilterMenu=function(){n.showFilterMenu(!1);vmViewIndex.showLoading(!0);setTimeout(function(){n.valueProduct()==null&&n.valueProduct(n.defaultValueFilterProduct);MapDataMenu(n.foodSetJs(),n.foodCategoryJs(),n.foodJs(),n.foodSetTimeMapJs(),n.valueFilterMenuFoodSet(),n.valueFilterMenuFoodCat(),n.valueFilterMenuFood(),n.valueProduct());n.AddDefaultFilterMenu();vmViewIndex.showLoading(!1)},0)};n.foodSetJs=ko.observableArray([]);n.foodCategoryJs=ko.observableArray([]);n.foodJs=ko.observableArray([]);n.foodSetTimeMapJs=ko.observableArray([]);n.foodSet=ko.observableArray([]);n.foodCategory=ko.observableArray([]);n.food=ko.observableArray([]);n.foodChoiceMap=ko.observableArray([]);n.tempDataMenu=ko.observableArray([]);n.tempDataFoodCategory=ko.observableArray([]);n.optionSelectPickerFoodSet=ko.observableArray([]);n.optionSelectPickerFoodSetThirdParty=ko.observableArray([]);n.optionSelectPickerFoodCategory=ko.observableArray([]);n.optionSelectPickerRevenue=ko.observableArray([]);n.optionSelectPickerCopyFood=ko.observableArray([]);n.optionSelectPickerChoiceOption=ko.observableArray([]);n.optionSelectPickerChoiceOptionTemp=ko.observableArray([]);n.productTagStore=ko.observableArray([]);n.thirdPartyGroupStore=ko.observableArray([]);n.thirdPartyStore=ko.observableArray([]);n.listFoodThirdPartyStore=ko.observableArray([]);n.thirdPartyGroups=ko.observableArray([]);n.foodInThirdPartyGroup=ko.observableArray([]);n.choiceOptionsInThirdPartyGroup=ko.observableArray([]);n.listThirdPartyGroups=ko.observable("");n.listFoodInThirdPartyGroup=ko.observable("");n.baseFoodThirdParty=ko.observable("");n.listFoodIconMap=ko.observableArray([]);n.selectFoodSetId=ko.observable();n.selectFoodSetName=ko.observable();n.selectFoodSetSorting=ko.observable();n.selectFoodSetActive=ko.observable(!0);n.selectFoodSetIsThirdParty=ko.observable(!1);n.chkBtnAddFoodSet=ko.observable(!0);n.chkBtnAddFoodCategory=ko.observable(!0);n.chkBtnAddFood=ko.observable(!0);n.chkSelectedChoiceOption=ko.observable(!0);n.chkClickCheckbox=ko.observable(!1);n.dataSetupFoodSetModal=new SetupMenuViewModel;n.dataSetupFoodCategoryModal=new SetupSectionViewModel;n.dataSetupFoodModal=new SetupItemViewModel;n.arrModelCopyFood=ko.observableArray([]);n.chkSelectedChoiceOption=ko.observable(!0);n.chkClickCheckbox=ko.observable(!1);n.chkClickCopyFood=ko.observable(!1);n.tempDataDragging=ko.observableArray([]);n.tempItemDragging=ko.observableArray([]);n.foodTypeDragging=ko.observable();n.chkDrag=ko.observable(!1);n.chkSave=ko.observable(!1);n.disableButtonSubmit=ko.observable(!1);n.setDisableButtonSubmit=function(){n.disableButtonSubmit(!0)};n.elementChangeImage=ko.observable();n.tempImageId=ko.observable();n.checkDataMenu=ko.observable();n.datasetId=ko.observable("");n.typeUploadImage=ko.observable();n.elementImageId=ko.observable();n.arrProductAll=ko.observableArray([]);n.clickBtnSaveDrag=function(){if(vmViewIndex.menu.tempDataDragging().length!=0)switch(vmViewIndex.menu.foodTypeDragging){case"foodSet":swalConfirmSaveMenuDragging(cFoodSetUpdateDragging,vmViewIndex.menu.tempDataDragging(),vmViewIndex.menu.tempItemDragging());break;case"foodCategory":swalConfirmSaveMenuDragging(cFoodCategoryUpdateDragging,vmViewIndex.menu.tempDataDragging(),vmViewIndex.menu.tempItemDragging());break;case"food":swalConfirmSaveMenuDragging(cFoodUpdateDragging,vmViewIndex.menu.tempDataDragging(),vmViewIndex.menu.tempItemDragging())}};n.clickBtnUndoDrag=function(){vmViewIndex.showLoading(!0);setTimeout(function(){undoMenuDragging()},3e3)};n.dropImage=function(t,i){var u,r,f;n.typeUploadImage("dropImage");n.elementImageId($(i.target).parent());typeof i.dataTransfer!="undefined"&&(n.checkDataMenu(typeof t.menu),typeof t.menu=="undefined"?n.tempImageId(_.first(i.dataTransfer.files)):vmViewIndex.menu.dataSetupFoodModal.tempId(_.first(i.dataTransfer.files)),u=_.first(i.dataTransfer.files).name,r=u.split(".").pop().toUpperCase(),r!="PNG"&&r!="JPG"&&r!="GIF"&&r!="JPEG"||(n.elementChangeImage($(i.target).parent().parent().parent()),f=URL.createObjectURL(_.first(i.dataTransfer.files)),document.getElementById("image_crop_box").setAttribute("src",f),$("#modalSetUpFoodUploadImage").modal("show")))};n.uploadDropImage=function(t){var r=new FormData,e=_.first(n.elementChangeImage().find(".display-uploader")).dataset.id,i;r.append("uploader",t);r.append("foodIdImage",e);var o=new ObjUrl("frmChangeImage"),s=o.getUrlSubmitForm(),u=n.elementChangeImage().find(".progress-bar"),f=n.elementChangeImage().find(".progress-bar"),h=n.elementChangeImage().find("#status");h.empty();i="0%";u.width(i);f.html(i);$.ajax({type:"POST",url:s,data:r,contentType:!1,processData:!1,xhrFields:{onprogress:function(n){n.lengthComputable&&(i=n.loaded/n.total*100+"%",u.width(i),f.html(i))}},success:function(t){if(t.status){var i=JSON.parse(t.obj);setFoodImage(i)}else swal("Error",cSwal_Alert_Error,cSwal_Icon_Error);return n.checkDataMenu()=="undefined"&&($("#modalSetUpFoodUploadImage").modal("hide"),removeSpinButton("modalSetUpFoodUploadImage")),vmViewIndex.disableButtonCloseModal(!1),vmViewIndex.disablePointer("pointer"),!1},complete:function(){swal("Save",cSwal_Alert_Success,cSwal_Icon_Success);setTimeout(function(){var n="0%";u.width(n);f.html(n)},2e3)},error:function(){swal("Error",cSwal_Alert_Error,cSwal_Icon_Error)}})};n.arrOneTimeFormSubmit=ko.observableArray([]);n.changeImage=function(t,i){var o,s,r,f,h,u,c,e;n.arrOneTimeFormSubmit([]);o=$(i.target).attr("class");n.typeUploadImage("clickImage");n.elementImageId($(i.target).parent());o=="display-uploader"?typeof i.target.files!="undefined"&&(s=i.target.files.length,r=_.first($(i.target).parent().parent()).id,s>0&&(h=_.first(i.target.files).name,u=h.split(".").pop().toUpperCase(),u!="PNG"&&u!="JPG"&&u!="GIF"&&u!="JPEG"||(n.arrOneTimeFormSubmit().length>0&&!isEmpty(r)?(f=ko.utils.arrayFilter(n.arrOneTimeFormSubmit(),function(n){return n==r}),f.length==0&&(n.arrOneTimeFormSubmit.push(r),n.submitChangeImage($(i.target).parent().parent(),t.menu.dataSetupFoodModal.tempId(),!1))):(n.arrOneTimeFormSubmit.push(r),typeof t.menu=="undefined"?(n.checkDataMenu(typeof t.menu),n.elementChangeImage($(i.target).parent().parent()),n.tempImageId(t.tempId()),n.datasetId(i.target.dataset.id)):(n.checkDataMenu(typeof t.menu),t.menu.dataSetupFoodModal.tempId(_.first(i.target.files))),c=URL.createObjectURL(_.first(i.target.files)),document.getElementById("image_crop_box").setAttribute("src",c),$("#modalSetUpFoodUploadImage").modal("show"))))):(r=_.first($(i.target).parent().parent().parent()).id,f=ko.utils.arrayFilter(n.arrOneTimeFormSubmit(),function(n){return n==r}),f.length==0&&(n.arrOneTimeFormSubmit.push(r),typeof t.tempId!="undefined"?(vmViewIndex.menu.tempImageId(t.tempId()),e=t.tempId(),t.image("")):(e=t.menu.dataSetupFoodModal.tempId(),t.menu.dataSetupFoodModal.image(""))),vmViewIndex.menu.dataSetupFoodModal.tempId(null),$(i.target).parent().parent().find(".display-uploader").val(""),$(i.target).parent().parent().find(".image img").attr("src",""),$(i.target).parent().parent().find(".image img").removeAttr("src"),typeof t.tempId!="undefined"&&n.submitChangeImage($(i.target).parent().parent().parent(),e,!1))};n.cropActive=ko.observable(!1);n.switchCrop=ko.observable({offText:"NO",onText:"YES",value:n.cropActive,width:switchActiveWidth60px,onValueChanged:function(t){t.value==!0?(n.cropActive(!0),cropper=new Cropper(image,{aspectRatio:1,viewMode:3,preview:".image-preview"})):(n.cropActive(!1),cropper!=null&&(cropper.destroy(),cropper=null))}});n.cancelUploadImage=function(){vmViewIndex.menu.dataSetupFoodModal.image("");$("#uploaderEdit").val("");vmViewIndex.menu.dataSetupFoodModal.tempId("");$("#modalSetUpFoodUploadImage").modal("hide")};n.dropCustomImage=function(n,t){var i=$(t.currentTarget).attr("class"),u=_.first(t.dataTransfer.files).name,r=u.split(".").pop().toUpperCase();r!="PNG"&&r!="JPG"&&r!="GIF"&&r!="JPEG"||(i.includes("desktop-menu")?n.menu.dataSetupFoodModal.tempIdDesktopMenu(_.first(t.dataTransfer.files)):i.includes("desktop-food")?n.menu.dataSetupFoodModal.tempIdDesktopFood(_.first(t.dataTransfer.files)):i.includes("mobile-menu")?n.menu.dataSetupFoodModal.tempIdMobileMenu(_.first(t.dataTransfer.files)):i.includes("mobile-food")&&n.menu.dataSetupFoodModal.tempIdMobileFood(_.first(t.dataTransfer.files)))};n.changeCustomImage=function(t,i){var r,f,e,u;n.arrOneTimeFormSubmit([]);r=$(i.target).attr("class");r.includes("display-uploader")?typeof i.target.files!="undefined"&&(f=i.target.files.length,f>0&&(e=_.first(i.target.files).name,u=e.split(".").pop().toUpperCase(),u!="PNG"&&u!="JPG"&&u!="GIF"&&u!="JPEG"||(r.includes("desktop-menu")?t.menu.dataSetupFoodModal.tempIdDesktopMenu(_.first(i.target.files)):r.includes("desktop-food")?t.menu.dataSetupFoodModal.tempIdDesktopFood(_.first(i.target.files)):r.includes("mobile-menu")?t.menu.dataSetupFoodModal.tempIdMobileMenu(_.first(i.target.files)):r.includes("mobile-food")&&t.menu.dataSetupFoodModal.tempIdMobileFood(_.first(i.target.files))))):r.includes("desktop-menu")?(t.menu.dataSetupFoodModal.imageDesktopMenu(""),t.menu.dataSetupFoodModal.tempIdDesktopMenu(""),$(i.target).parent().parent().find(".display-uploader.desktop-menu").val(""),$(i.target).parent().parent().find(".image.image-desktop-menu img").attr("src",""),$(i.target).parent().parent().find(".image.image-desktop-menu img").removeAttr("src")):r.includes("desktop-food")?(t.menu.dataSetupFoodModal.imageDesktopFood(""),t.menu.dataSetupFoodModal.tempIdDesktopFood(""),$(i.target).parent().parent().find(".display-uploader.desktop-food").val(""),$(i.target).parent().parent().find(".image.image-desktop-food img").attr("src",""),$(i.target).parent().parent().find(".image.image-desktop-food img").removeAttr("src")):r.includes("mobile-menu")?(t.menu.dataSetupFoodModal.imageMobileMenu(""),t.menu.dataSetupFoodModal.tempIdMobileMenu(""),$(i.target).parent().parent().find(".display-uploader.mobile-menu").val(""),$(i.target).parent().parent().find(".image.image-mobile-menu img").attr("src",""),$(i.target).parent().parent().find(".image.image-mobile-menu img").removeAttr("src")):r.includes("mobile-food")&&(t.menu.dataSetupFoodModal.imageMobileFood(""),t.menu.dataSetupFoodModal.tempIdMobileFood(""),$(i.target).parent().parent().find(".display-uploader.mobile-food").val(""),$(i.target).parent().parent().find(".image.image-mobile-food img").attr("src",""),$(i.target).parent().parent().find(".image.image-mobile-food img").removeAttr("src"))};n.showFilterProduct=ko.observable(!1);n.selectProduct=ko.observable();n.arrProductFilter=ko.observableArray([]);n.valueProduct=ko.observable();n.submitChangeImage=function(t,i,r){var f=$(t).find(".progress-bar"),e=$(t).find(".progress-bar"),s=$(t).find("#status"),u=new FormData,h=new ObjUrl("frmChangeImage"),c=h.getUrlSubmitForm(),o;r?(u.append("uploader",i),u.append("foodIdImage",vmViewIndex.menu.datasetId()),u.append("tempId",vmViewIndex.menu.tempImageId())):(u.append("uploader",_.first(jQuery("#uploader"+i).get(0).files)),o=typeof event.target.dataset.id=="undefined"?vmViewIndex.menu.datasetId():event.target.dataset.id,u.append("foodIdImage",o),u.append("tempId",i));$.ajax({url:c,async:ajax_async,cache:ajax_cache,type:ajax_type_post,data:u,processData:!1,contentType:!1,timeout:ajax_timeout,beforeSend:function(){s.empty();var n="0%";f.width(n);e.html(n)},uploadProgress:function(n,t,i,r){var u=r+"%";f.width(u);e.html(u)},success:function(t){var r,i;return t.status?(r=JSON.parse(t.obj),setFoodImage(r),i="100%",f.width(i),e.html(i)):swal("Error",cSwal_Alert_Error,cSwal_Icon_Error),n.checkDataMenu()=="undefined"&&($("#modalSetUpFoodUploadImage").modal("hide"),removeSpinButton("modalSetUpFoodUploadImage")),vmViewIndex.disableButtonCloseModal(!1),vmViewIndex.disablePointer("pointer"),!1},complete:function(){setTimeout(function(){swal("Save",cSwal_Alert_Success,cSwal_Icon_Success)},500);setTimeout(function(){var n="0%";f.width(n);e.html(n)},2e3)}})};n.foodFilter=function(n,t){return ko.utils.arrayFilter(n.food,function(n){return n.foodSetId()==t.foodSetId()})};n.clickBtnAddFoodSet=function(){vmViewIndex.menu.disableButtonSubmit(!1);n.chkBtnAddFoodSet(!0)};n.clickBtnFoodSetSetting=function(t){n.chkBtnAddFoodSet(!1);vmViewIndex.menu.disableButtonSubmit(!1);n.dataSetupFoodSetModal.foodSetId(t.menu.selectFoodSetId());n.dataSetupFoodSetModal.foodSetName(t.menu.selectFoodSetName());n.dataSetupFoodSetModal.active(t.menu.selectFoodSetActive());n.dataSetupFoodSetModal.isThirdParty(t.menu.selectFoodSetIsThirdParty());t.menu.selectFoodSetIsThirdParty()==!0&&enableOrDisableCheckBox(cfrmFoodSetUp_ThirdParty,!0)};n.clickBtnAddFoodCategory=function(){vmViewIndex.menu.disableButtonSubmit(!1);n.chkBtnAddFoodCategory(!0)};n.clickBtnEditFoodCategory=function(t){n.chkBtnAddFoodCategory(!1);vmViewIndex.menu.disableButtonSubmit(!1);n.dataSetupFoodCategoryModal.foodCatId(t.foodCategory.foodCatId());n.dataSetupFoodCategoryModal.foodCatName(t.foodCategory.foodCatName());n.dataSetupFoodCategoryModal.foodCatDesc(t.foodCategory.foodCatDesc())};n.clickBtnAddFood=function(t,i){var u,r,f,e,o;n.chkBtnAddFood(!0);vmViewIndex.menu.disableButtonSubmit(!1);n.dataSetupFoodModal.foodSetId(t.foodSet.foodSetId());n.dataSetupFoodModal.foodCatId(t.foodCategory.foodCatId());u=ko.utils.arrayFilter(n.tempDataFoodCategory(),function(n){return n.foodSetId()==t.foodSet.foodSetId()});n.optionSelectPickerFoodCategory(u);n.dataSetupFoodModal.foodId("");n.dataSetupFoodModal.revenueClassId("");n.dataSetupFoodModal.taxRateId("");n.dataSetupFoodModal.image("");n.dataSetupFoodModal.imageThirdParty("");n.dataSetupFoodModal.plu("");n.dataSetupFoodModal.foodDesc("");n.dataSetupFoodModal.tempId(null);n.dataSetupFoodModal.isOutStock(!1);n.dataSetupFoodModal.isFree(!1);n.dataSetupFoodModal.isShow(!0);n.dataSetupFoodModal.productId();vmViewIndex.allSetting.isMultiProduct()==!1&&n.dataSetupFoodModal.productId(vmViewIndex.allSetting.isSmileDining()?products.cSmileDining:products.cSmileContactless);t.foodSet.isThirdParty()&&(r=products.cSmileThirdPartyIntegrations,n.dataSetupFoodModal.productId(r),f=r.split(","),n.dataSetupFoodModal.arrProduct(f),n.dataSetupFoodModal.isShowProductTags(n.dataSetupFoodModal.arrProduct().includes("5")?!0:!1));vmViewIndex.globalConfig.orderLimit()==="1"||vmViewIndex.globalConfig.orderLimit()==="2"?n.dataSetupFoodModal.showLimit(!0):n.dataSetupFoodModal.showLimit(!1);n.dataSetupFoodModal.qtyLimit(0);e=$(i.target).parent().parent();o=e.find("img").attr("src");$("#modalSetupFood .image").find("img").attr("src","");$("#modalSetupFood .image").find("img").removeAttr("src")};n.clickAddChoiceOption=function(){n.choiceOptions.push(new getChoiceOptions(1));n.optionSelectPickerChoiceOptionTemp.push(new optionSelectChoiceOptionTemp(0,""));n.dataSetupFoodModal.dataOptionFood(ko.toJSON(n.choiceOptions()));replaceChoiceOptionThirdParty()};n.clickDelChoiceOption=function(t,i){var o=ko.contextFor(i.target),u=o.$index(),f=ko.mapping.fromJS(ko.toJS(n.choiceOptions())),r=0,e;for(ko.utils.arrayFilter(f(),function(i){i.ChoiceOptionId()==t.ChoiceOptionId()&&i.CheckData()==t.CheckData()&&(t.CheckData()==0?(i.Active(!1),ko.utils.arrayForEach(i.Choice(),function(t){t.ChoiceName("");t.ChoicePrice(0);t.IsDefault(!1);n.choiceOptions(f())})):r==u&&(n.choiceOptions.remove(t),n.optionSelectPickerChoiceOptionTemp.splice(u,1)));r++}),n.chkSelectedChoiceOption(!0),r=0;r<n.choiceOptions().length-1;r++)e=ko.utils.arrayFilter(n.choiceOptions(),function(t){return t.ChoiceOptionId()==n.choiceOptions()[r].ChoiceOptionId()&&t.Active()!=!1}),e.length>1&&(swal(cError_ChoiceOption_Invalid,cError_ChoiceOptionName_Duplicate,cSwal_Icon_Error),n.chkSelectedChoiceOption(!1));n.dataSetupFoodModal.dataOptionFood(ko.toJSON(n.choiceOptions()));replaceChoiceOptionThirdParty()};n.clickAddChoice=function(t){n.choiceOptions()[t].Choice.push(new getChoice("","","0.00","",!1,!1,""));n.dataSetupFoodModal.dataOptionFood(ko.toJSON(n.choiceOptions()));replaceChoiceOptionThirdParty()};n.clickDelChoice=function(t,i){n.choiceOptions()[i].Choice.remove(t);n.dataSetupFoodModal.dataOptionFood(ko.toJSON(n.choiceOptions()));replaceChoiceOptionThirdParty()};n.clickBtnEditFood=function(t,i){var o,s,u,f,h,c,e,r;n.chkBtnAddFood(!1);vmViewIndex.menu.disableButtonSubmit(!1);n.dataSetupFoodModal.foodId(t.foodId());n.dataSetupFoodModal.foodName(t.foodName());n.dataSetupFoodModal.foodNameAlt(t.foodNameAlt());n.dataSetupFoodModal.foodPrice(t.foodPrice());n.dataSetupFoodModal.foodDesc(t.foodDesc());n.dataSetupFoodModal.active(t.active());n.dataSetupFoodModal.foodSetId(t.foodSetId());n.dataSetupFoodModal.foodCatId(t.foodCatId());n.dataSetupFoodModal.revenueClassId(t.revenueClassId());n.dataSetupFoodModal.taxRateId(t.taxRateId());o=ko.utils.arrayFilter(n.tempDataFoodCategory(),function(n){return n.foodSetId()==t.foodSetId()});n.optionSelectPickerFoodCategory(o);n.dataSetupFoodModal.isOutStock(t.isOutStock());n.dataSetupFoodModal.isFree(t.isFree());n.dataSetupFoodModal.isShow(t.isShow());n.dataSetupFoodModal.tempId(t.tempId());n.dataSetupFoodModal.image(t.image());n.dataSetupFoodModal.imageThirdParty(t.imageThirdParty());n.dataSetupFoodModal.plu(t.plu());n.dataSetupFoodModal.listProductTag(t.listProductTag());n.dataSetupFoodModal.productId(t.productId());t.productId!=null&&(s=t.productId().split(","));n.dataSetupFoodModal.arrProduct(s);n.dataSetupFoodModal.isShowProductTags(n.dataSetupFoodModal.arrProduct().includes("5")?!0:!1);vmViewIndex.globalConfig.orderLimit()==="1"||vmViewIndex.globalConfig.orderLimit()==="2"?n.dataSetupFoodModal.showLimit(!0):n.dataSetupFoodModal.showLimit(!1);n.dataSetupFoodModal.qtyLimit(t.qtyLimit());u=ko.utils.arrayFilter(n.listFoodIconMap(),function(n){return n.foodId()==t.foodId()});f=ko.observableArray([]);u.length>0&&(u.sort(function(n,t){return n.iconSorting()===t.iconSorting()?0:n.iconSorting()<t.iconSorting()?-1:1}),ko.utils.arrayForEach(u,function(t){var i=ko.utils.arrayFilter(n.dataSetupFoodModal.cloneArrayIcon(),function(n){return n.iconId()==t.iconId()});i.length>0&&(n.dataSetupFoodModal.listIcon.push(_.first(i).iconId()),f.push(new iconSortingModel(_.first(i),t.iconSorting())))}));h=new DevExpress.data.ArrayStore({key:"iconId",data:f()});n.dataSetupFoodModal.listIconForDrag(h);n.dataSetupFoodModal.showIconDrag(f().length>0?!0:!1);c=i.currentTarget.id=="divEditItem"?$(i.target).parent().parent():$(i.target).parent().parent().parent();e=t.image();r=t.imageThirdParty();typeof e!="undefined"||r!="undefined"?e.trim().length>0||r.trim().length>0?($("#modalSetupFood .image").find("img").attr("src",r.trim().length>0?r:e),$("#modalSetupFood .image").find("img").attr("width","115"),$("#modalSetupFood .image").find("img").attr("height","115")):(n.dataSetupFoodModal.image(""),n.dataSetupFoodModal.imageThirdParty(""),$("#modalSetupFood .image").find("img").attr("src",""),$("#modalSetupFood .image").find("img").removeAttr("src"),$("#uploaderEdit"+t.tempId()).val("")):(n.dataSetupFoodModal.image(""),n.dataSetupFoodModal.imageThirdParty(""),$("#modalSetupFood .image").find("img").attr("src",""),$("#modalSetupFood .image").find("img").removeAttr("src"),$("#uploaderEdit"+t.tempId()).val(""));n.optionSelectPickerChoiceOptionTemp([]);copyFood(n.dataSetupFoodModal.foodId(),i,0);t.plu()!=""?($("#modalSetupFood #selectPickerSection, #modalSetupFood #selectPickerRevenue, #modalSetupFood #selectCopyFood").dxSelectBox({disabled:!0}),$("#modalSetupFood #tagFood, #modalSetupFood #iconFood").dxTagBox({disabled:!0}),$("#modalSetupFood #grid-icon").dxDataGrid({disabled:!0})):($("#modalSetupFood #selectPickerSection, #modalSetupFood #selectPickerRevenue, #modalSetupFood #selectCopyFood").dxSelectBox({disabled:!1}),$("#modalSetupFood #tagFood, #modalSetupFood #iconFood").dxTagBox({disabled:!1}),$("#modalSetupFood #grid-icon").dxDataGrid({disabled:!1}))};n.clickCopyFoodDetail=function(t){var i=t.menu.dataSetupFoodModal.valCopyFood();n.choiceOptionsInThirdPartyGroup().length>0?copyFoodThirdParty(i,event,1):copyFood(i,event,1,!0);replaceChoiceOptionThirdParty()};n.clickClearCopyFood=function(){n.choiceOptions([]);n.choice([]);n.optionSelectPickerChoiceOptionTemp([]);n.dataSetupFoodModal.dataOptionFood([]);replaceChoiceOptionThirdParty()};n.disableClickClearCopyFood=ko.observable(!1);n.clickBtnLinkFood=function(t,i){n.thirdPartyGroups([]);n.foodInThirdPartyGroup([]);n.choiceOptionsInThirdPartyGroup([]);n.baseFoodThirdParty("");linkThirdParty(t,i);n.chkBtnAddFood(!1);vmViewIndex.menu.disableButtonSubmit(!1)};n.productId=ko.observable();n.clickSelectCheckBoxProduct=function(){var t=[],i;return n.productId(""),ko.utils.arrayForEach(n.dataSetupFoodModal.arrProduct(),function(n){t.push(parseInt(n))}),i=_.sortBy(t),n.productId(i.join(",")),n.dataSetupFoodModal.productId(n.productId()),n.dataSetupFoodModal.isShowProductTags(n.dataSetupFoodModal.arrProduct().includes("5")?!0:!1),!0};n.clickCopyFood=function(t,i){n.chkClickCopyFood(!0);$(i.target).closest("div .border-food").addClass("border-copy-food");copyFood(t.foodId(),i,0);n.arrModelCopyFood.push(new CopyfoodInFoodCategory(t.foodId(),t.tempId(),t.foodName(),t.foodNameAlt(),t.foodDesc(),t.productId,t.foodPrice(),t.image(),t.active(),t.revenueClassId(),t.taxRateId(),t.foodCatId(),t.foodSetId(),n.dataSetupFoodModal.dataOptionFood(),t.isOutStock(),t.isFree(),t.isShow(),t.listProductTag(),t.plu(),t.imageThirdParty()));updateCart();n.choiceOptions([]);n.choice([]);n.dataSetupFoodModal.dataOptionFood([])};n.clickDeleteFoodInCart=function(t){var i=t.TempId(),r="#border-food_"+i,u="#selectcopyfood_"+i;n.arrModelCopyFood.remove(t);$(r).removeClass("border-copy-food");updateCart();n.choiceOptions([]);n.choice([]);n.dataSetupFoodModal.dataOptionFood([])};n.clickPasteFood=function(t){if(n.arrModelCopyFood().length<=0)swal("Invalid Copy Food","Please choose Food to Copy.",cSwal_Icon_Error);else{vmViewIndex.showLoading(!0);var i=t.foodSet.foodSetId(),u=t.foodSet.foodSetName(),r=t.foodCategory.foodCatId();n.dataSetupFoodModal.foodSetId(i);n.dataSetupFoodModal.foodCatId(r);n.chkClickCopyFood(!1);$("#submitCopy").click()}};n.clickBtnDisableFoodCategory=function(n){changeActiveFoodCategory(cDisableFoodCategory,n)};n.clickIsDefaultChoice=function(n,t){var i=vmViewIndex.menu,f=i.choiceOptions()[n].Choice()[t].IsDefault(),u,e,r;if(i.choiceOptions()[n].Choice()[t].IsDefault(!f),i.choiceOptions()[n].Choice()[t].checkedIsDefault(!f),u=i.choiceOptionsInThirdPartyGroup().length>0?"#modalSetupFoodThirdParty #ChoiceOption_":"#ChoiceOption_",f)$(u+n+"_Choice_"+t+"_IsDefault").removeClass(),$(u+n+"_Choice_"+t+"_IsDefault").addClass("default-choice-uncheck");else{for(e=i.choiceOptions()[n].Choice().length,r=0;r<e;r++)r!=t&&(i.choiceOptions()[n].Choice()[r].IsDefault(!1),i.choiceOptions()[n].Choice()[r].checkedIsDefault(!1),$(u+n+"_Choice_"+r+"_IsDefault").removeClass(),$(u+n+"_Choice_"+r+"_IsDefault").addClass("default-choice-uncheck"));$(u+n+"_Choice_"+t+"_IsDefault").removeClass();$(u+n+"_Choice_"+t+"_IsDefault").addClass("chkDefault default-choice-check")}i.dataSetupFoodModal.dataOptionFood(ko.toJSON(i.choiceOptions()));replaceChoiceOptionThirdParty()};n.popoverShowtimes={target:"#link-showtimes",showEvent:"dxhoverstart",hideEvent:"dxhoverend",position:"bottom",width:280,showTitle:!0,title:"Day of the week.",visible:!1,animation:{show:{type:"pop",from:{scale:0},to:{scale:1}},hide:{type:"fade",from:1,to:0}},onContentReady:function(n){var t=n.component.content();$(t).css("padding","10px")}};n.clickUnlockFoodDeliverect=function(n){swalUnlockFoodDeliverect(n)}}function SetupMenuViewModel(){var n=this;n.foodSetId=ko.observable();n.foodSetName=ko.observable();n.active=ko.observable(!0);n.isThirdParty=ko.observable(!1);n.btnActive=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.active,onValueChanged:function(t){t.value==!0?n.active(!0):n.active(!1)}});n.clickIsThirdParty=function(t){var i=t.menu.dataSetupFoodSetModal.isThirdParty();return i?n.isThirdParty(!0):n.isThirdParty(!1),!0};n.btnCloseSetupFoodSet=function(){n.clearSetupFoodSet()};n.clearSetupFoodSet=function(){n.active(!0);n.foodSetName("");n.isThirdParty(!1);enableOrDisableCheckBox(cfrmFoodSetUp_ThirdParty,!1)}}function SetupSectionViewModel(){var n=this;n.foodCatId=ko.observable();n.foodCatName=ko.observable();n.foodCatDesc=ko.observable();n.foodCatSorting=ko.observable();n.active=ko.observable(!0);n.btnCloseSetupFoodCategory=function(){n.clearSetupFoodCategory()};n.clearSetupFoodCategory=function(){n.active(!0);n.foodCatName("");n.foodCatDesc("")}}function SetupItemViewModel(){var n=this;n.foodId=ko.observable();n.tempId=ko.observable();n.foodName=ko.observable("");n.foodNameAlt=ko.observable("");n.arrProduct=ko.observableArray([]);n.productId=ko.observable();n.foodDesc=ko.observable();n.foodPrice=ko.observable(0).extend({numeric:2});n.blurFoodPrice=function(){var t=$(event.target).val();$.isNumeric(t)||(t=0);n.foodPrice(t)};n.foodSorting=ko.observable();n.active=ko.observable(!0);n.isOutStock=ko.observable(!1);n.isFree=ko.observable(!1);n.isShow=ko.observable(!0);n.foodSetId=ko.observable();n.foodCatId=ko.observable();n.revenueClassId=ko.observable();n.taxRateId=ko.observable();n.image=ko.observable("");n.imageThirdParty=ko.observable("");n.plu=ko.observable("");n.thirdPartyGroupId=ko.observable();n.foodBaseId=ko.observable();n.isThirdParty=ko.observable();n.allChoiceOptions=ko.observable("");n.dataAllChoiceOption=ko.observableArray([]);n.dataAllChoice=ko.observableArray([]);n.dataRevenueClass=ko.observableArray([]);n.listFood=ko.observableArray([]);n.listFoodChoiceMap=ko.observableArray([]);n.dataCopyFood=ko.observableArray([]);n.valCopyFood=ko.observable();n.dataOptionFood=ko.observableArray([]);n.groupChoiceOptionId=ko.observableArray([]);n.cloneArrayProductTag=ko.observableArray([]);n.listProductTag=ko.observableArray([]);n.productTagSelect=ko.observable("");n.cloneArrayIcon=ko.observableArray([]);n.listIcon=ko.observableArray([]);n.listIconForDrag=ko.observableArray([]);n.showIconDrag=ko.observable(!1);n.showLimit=ko.observable(!1);n.qtyLimit=ko.observable(0);n.blurQtyLimit=function(){var t=$(event.target).val();$.isNumeric(t)||(t=0);n.qtyLimit(t)};n.isShowProductTags=ko.observable(!1);n.btnActive=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.active,onValueChanged:function(t){t.value==!0?(n.active(!0),$("#switchOutStock").removeClass("dx-state-disabled"),$("#switchIsFree").removeClass("dx-state-disabled"),$("#switchIsShow").removeClass("dx-state-disabled")):(n.active(!1),$("#switchOutStock").addClass("dx-state-disabled"),$("#switchIsFree").addClass("dx-state-disabled"),$("#switchIsShow").addClass("dx-state-disabled"))}});n.switchOutStock=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.isOutStock,disabled:!n.active,onValueChanged:function(t){t.value==!0?n.isOutStock(!0):n.isOutStock(!1)}});n.switchIsFree=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.isFree,disabled:!n.active,onValueChanged:function(t){t.value==!0?n.isFree(!0):n.isFree(!1)}});n.switchIsShow=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.isShow,disabled:!n.active,onValueChanged:function(t){t.value==!0?n.isShow(!0):n.isShow(!1)}});n.showSwitch=ko.observable(!1);n.popupSwitch=ko.observable({contentTemplate:"switchSetting",position:{my:"left",at:"left bottom",offset:"-200 80",of:$("#btnSwitch")},height:190,width:300,shading:!1,async:!1,model:!1,showTitle:!1,visible:n.showSwitch,dragEnabled:!1,closeOnOutsideClick:!0});n.popupSwitchThirdParty=ko.observable({contentTemplate:"switchSetting",position:{my:"left",at:"left bottom",offset:"-200 80",of:$("#btnSwitchThirdPart")},height:190,width:300,shading:!1,async:!1,model:!1,showTitle:!1,visible:n.showSwitch,dragEnabled:!1,closeOnOutsideClick:!0});n.selectTag=ko.observable({dataSource:n.cloneArrayProductTag,displayExpr:"productTagName",valueExpr:"productTagId",value:n.listProductTag,showDropDownButton:!0,searchEnabled:!0,onValueChanged:function(t){var i=t.value;n.productTagSelect(ko.toJSON(i))}});n.selectIcon=ko.observable({dataSource:n.cloneArrayIcon,displayExpr:"iconName",valueExpr:"iconId",value:n.listIcon,showDropDownButton:!0,searchEnabled:!0,showSelectionControls:!0,maxDisplayedTags:0,onOpened:function(){$(".dx-list-select-all").hide()},itemTemplate:function(n){return"<div class='custom-item'><img class='img-icon' src='"+n.iconImage()+"' /><div class='product-name'>"+n.iconName()+"<\/div><\/div>"},onValueChanged:function(n){var t=n.value,r=n.previousValue,e,i,c,u,f,o,s,l,a,h;t.length>r.length?(e=ko.utils.arrayFilter(vmViewIndex.menu.dataSetupFoodModal.cloneArrayIcon(),function(n){return n.iconId()==t[t.length-1]}),i=1,r.length==0?(u=ko.observableArray([]),u.push(new iconSortingModel(_.first(e),i)),f=new DevExpress.data.ArrayStore({key:"iconId",data:u()}),vmViewIndex.menu.dataSetupFoodModal.listIconForDrag(f)):vmViewIndex.menu.dataSetupFoodModal.listIconForDrag()._array.length>0&&(i=Math.max.apply(Math,vmViewIndex.menu.dataSetupFoodModal.listIconForDrag()._array.map(function(n){return n.sorting()})),i=i+1,c=new iconSortingModel(_.first(e),i),vmViewIndex.menu.dataSetupFoodModal.listIconForDrag()._array.push(c)),vmViewIndex.menu.dataSetupFoodModal.showIconDrag(vmViewIndex.menu.dataSetupFoodModal.listIconForDrag()._array.length>0?!0:!1)):t.length<r.length&&(t.length==0&&r.length>1?(u=ko.observableArray([]),f=new DevExpress.data.ArrayStore({key:"iconId",data:u()}),vmViewIndex.menu.dataSetupFoodModal.listIconForDrag(f)):(o="",ko.utils.arrayForEach(r,function(n){var i=ko.utils.arrayFilter(t,function(t){return t==n});i.length==0&&(o=n)}),s=_.findIndex(vmViewIndex.menu.dataSetupFoodModal.listIconForDrag()._array,function(n){return n.iconId()==o}),l=vmViewIndex.menu.dataSetupFoodModal.listIconForDrag()._array[s].sorting(),vmViewIndex.menu.dataSetupFoodModal.listIconForDrag()._array.splice(s,1),a=ko.utils.arrayFilter(vmViewIndex.menu.dataSetupFoodModal.listIconForDrag()._array,function(n){return n.sorting()>=l}),h=[],ko.utils.arrayForEach(a,function(n){h.push({iconId:n.iconId(),sorting:n.sorting()-1})}),ko.utils.arrayForEach(h,function(n){vmViewIndex.menu.dataSetupFoodModal.listIconForDrag().update(n.iconId,{sorting:n.sorting})}),refreshGrid("grid-icon")),vmViewIndex.menu.dataSetupFoodModal.showIconDrag(vmViewIndex.menu.dataSetupFoodModal.listIconForDrag()._array.length>0?!0:!1));refreshGrid("grid-icon")}});n.gridIconDrag=ko.observable({dataSource:{store:n.listIconForDrag,sort:"sorting"},showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,allowColumnReordering:!0,columnAutoWidth:!0,showColumnHeaders:!1,rowAlternationEnabled:!1,columns:[{dataField:"iconName",calculateSortValue:"sorting",cellTemplate:function(n,t){var r=ko.utils.arrayFilter(vmViewIndex.menu.dataSetupFoodModal.listIconForDrag()._array,function(n){return n.sorting()==t.rowIndex+1}),i=_.first(r);$("<div>").append($("<img>",{src:i.iconImage(),"class":"img-icon"})).append(i.iconName()).appendTo(n)}}],onRowPrepared:function(n){n.rowType=="data"&&n.rowElement.addClass("myRow myRow-hover").data("keyValue",n.key)},onContentReady:function(t){iconSortable(t.element,n.listIconForDrag());$("#grid-icon .dx-scrollable").dxScrollable({showScrollbar:"always"})}});n.btnCloseSetupFood=function(){n.clearSetupFood()};n.imageDesktopMenu=ko.observable("");n.imageDesktopFood=ko.observable("");n.imageMobileMenu=ko.observable("");n.imageMobileFood=ko.observable("");n.tempIdDesktopMenu=ko.observable("");n.tempIdDesktopFood=ko.observable("");n.tempIdMobileMenu=ko.observable("");n.tempIdMobileFood=ko.observable("");n.btnCustomImage=function(){cPathFileBase=cPathFileBase==""?cProtocal+"://img.smiledining.com/"+vmViewIndex.globalConfig.shopCode()+"/":cPathFileBase;var t=n.image().replace(cPathFileBase,""),i="?"+moment(new Date).format("YYYYMMDDHHmmss"),r=cPathFileBase+cDESKTOP+"/"+cMenuPath+"/"+t+i,u=cPathFileBase+cDESKTOP+"/"+cFoodPath+"/"+t+i,f=cPathFileBase+cMobile+"/"+cMenuPath+"/"+t+i,e=cPathFileBase+cMobile+"/"+cFoodPath+"/"+t+i;t!=""?(n.imageDesktopMenu(r),n.imageDesktopFood(u),n.imageMobileMenu(f),n.imageMobileFood(e),n.tempIdDesktopMenu(n.tempId()),n.tempIdDesktopFood(n.tempId()),n.tempIdMobileMenu(n.tempId()),n.tempIdMobileFood(n.tempId()),$("#modalSetUpFoodImage .image.image-desktop-menu").find("img").attr("src",r),$("#modalSetUpFoodImage .image.image-desktop-menu").find("img").attr("width","115"),$("#modalSetUpFoodImage .image.image-desktop-menu").find("img").attr("height","115"),$("#modalSetUpFoodImage .image.image-desktop-food").find("img").attr("src",u),$("#modalSetUpFoodImage .image.image-desktop-food").find("img").attr("width","115"),$("#modalSetUpFoodImage .image.image-desktop-food").find("img").attr("height","115"),$("#modalSetUpFoodImage .image.image-mobile-menu").find("img").attr("src",f),$("#modalSetUpFoodImage .image.image-mobile-menu").find("img").attr("width","115"),$("#modalSetUpFoodImage .image.image-mobile-menu").find("img").attr("height","115"),$("#modalSetUpFoodImage .image.image-mobile-food").find("img").attr("src",e),$("#modalSetUpFoodImage .image.image-mobile-food").find("img").attr("width","115"),$("#modalSetUpFoodImage .image.image-mobile-food").find("img").attr("height","115")):(n.imageDesktopMenu(""),n.imageDesktopFood(""),n.imageMobileMenu(""),n.imageMobileFood(""),$("#modalSetUpFoodImage .image").find("img").attr("src",""),$("#modalSetUpFoodImage .image").find("img").removeAttr("src"),$("#uploaderEdit"+n.tempIdDesktopMenu()).val(""),$("#uploaderEdit"+n.tempIdDesktopFood()).val(""),$("#uploaderEdit"+n.tempIdMobileMenu()).val(""),$("#uploaderEdit"+n.tempIdMobileFood()).val(""))};n.clearSetupFood=function(){n.foodName("");n.foodNameAlt("");n.foodDesc("");n.foodPrice("0.00");n.active(!0);n.revenueClassId();n.taxRateId();n.image("");n.imageThirdParty("");n.plu("");n.showLimit(!1);n.qtyLimit(0);n.arrProduct([]);n.productId("");n.isOutStock(!1);n.isFree(!1);n.isShow(!0);n.listProductTag([]);n.productTagSelect("");n.listIcon([]);n.listIconForDrag([]);n.showIconDrag(!1);n.isShowProductTags(!1);var t=$("#modalSetupFood .image");t.parent().removeClass("filled");t.find("i").show();t.find("br").show();t.find("small").show();t.find("img").remove();t.append("<img>");$("#uploaderEdit").val("");n.dataOptionFood([]);vmViewIndex.menu.choiceOptions([]);vmViewIndex.menu.choice([]);vmViewIndex.menu.optionSelectPickerChoiceOptionTemp([]);vmViewIndex.menu.listThirdPartyGroups("");vmViewIndex.menu.thirdPartyGroups([]);vmViewIndex.menu.listFoodInThirdPartyGroup("");vmViewIndex.menu.foodInThirdPartyGroup([]);vmViewIndex.menu.choiceOptionsInThirdPartyGroup([]);removeClassValidationError("#txtFoodSetUp_FoodPrice")}}function ConfigSetUpViewModel(){var n=this;n.choiceOption=new ChoiceOptionViewModel;n.choice=new ChoiceViewModel;n.choiceModify=new ChoiceViewModel;n.taxRate=new TaxRateViewModel;n.revenueClass=new RevenueClassViewModel;n.graguityCharge=new GraguityChargeViewModel;n.foodPrefix=new FoodPrefixViewModel;n.iconSetup=new IconViewModel;n.linkToFood=new LinkToFoodViewModel;n.chkDrag=ko.observable(!1);n.chkSave=ko.observable(!1);n.disableButtonSubmit=ko.observable(!1);n.setDisableButtonSubmit=function(){n.disableButtonSubmit(!0)};n.productTagStore=ko.observableArray([]);n.isClickTabChoice=ko.observable(!1);n.isClickTabChoiceOption=ko.observable(!1);n.isClickTabChoiceModify=ko.observable(!1);n.choice.choiceTypeId(cChoiceType.option);n.choiceModify.choiceTypeId(cChoiceType.modify)}function LinkToFoodViewModel(){var n=this;n.foodId=ko.observable("");n.tempId=ko.observable("");n.foodName=ko.observable("");n.foodSorting=ko.observable("");n.active=ko.observable(!0);n.foodSetId=ko.observable("");n.foodSetName=ko.observable("");n.foodCatId=ko.observable("");n.foodCatName=ko.observable("");n.listFood=ko.observableArray([]);n.listFoodChoiceMap=ko.observableArray([]);n.dataPrevValue=new SetUpChoiceViewModel;n.choiceId=ko.observable();n.choiceOptionId=ko.observable();n.selectedLinkToFood=ko.observable();n.gridLinkToFood=ko.observable("");n.btnCloseSetLinkToFood=function(){vmViewIndex.configSetUp.choice.showBtnLinkToFood(!1);vmViewIndex.configSetUp.choiceModify.showBtnLinkToFood(!1);var n=$("#gridLinkToFood").dxTreeList("instance");n.deselectAll()};n.productId=ko.observable("");n.isOutStock=ko.observable(!1);n.isFree=ko.observable(!1);n.isShow=ko.observable(!0)}function bindDataGridLinkToFood(n){vmViewIndex.showLoading(!0);var t=ko.observableArray([]);vmViewIndex.configSetUp.linkToFood.gridLinkToFood({dataSource:vmViewIndex.configSetUp.linkToFood.listFood,keyExpr:"foodId",scrolling:{mode:"standard"},showBorders:!0,showColumnHeaders:!0,showColumnLines:!0,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,height:"550px",paging:{enabled:!1},pager:{enabled:!1},selection:{mode:"multiple",showCheckBoxesMode:"always",allowSelectAll:!0},loadPanel:{enabled:!0,height:90,indicatorSrc:"",showIndicator:!0,showPane:!0,text:"Loading...",width:200},columns:[{dataField:"foodName",caption:"Food Name",alignment:"left"},{dataField:"foodCatName",caption:"Food Categories",alignment:"center",width:250,sortOrder:"asc"},{dataField:"foodSetName",caption:"Food Set",alignment:"center",width:250},{dataField:"active",caption:"Active",alignment:"center",width:100,sortOrder:"desc"}],onCellPrepared:function(i){var r=i.value,u="",f,e;isEmpty(r)||(u=r==!0&&typeof r=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":r==!1&&typeof r=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":r.value,i.cellElement.html(u));f=i.cellElement.parent().find(".dx-select-checkbox");i.data!=undefined&&(r=i.data.foodId(),e=i.rowIndex,ko.utils.arrayFilter(n,function(n){i.columnIndex==0&&r==n&&(t.push(e),f.addClass("dx-checkbox-checked"))}))},onContentReady:function(){var n=$("#gridLinkToFood").dxTreeList("instance");n.selectRowsByIndexes(t());t([]);vmViewIndex.showLoading(!1)}});$("#modalSetUpChoice").modal("hide");$("#modalSetUpChoiceModify").modal("hide");$("#modalSetLinkToFood").modal({keyboard:!1,backdrop:"static",show:!0})}function getDataTreeListLinkToFood(){var n=$("#gridLinkToFood").dxTreeList("instance");vmViewIndex.configSetUp.linkToFood.selectedLinkToFood(ko.toJSON(n.getSelectedRowsData()));vmViewIndex.configSetUp.linkToFood.choiceId=ko.observable(vmViewIndex.configSetUp.linkToFood.dataPrevValue.choiceId());vmViewIndex.configSetUp.linkToFood.choiceOptionId=ko.observable(vmViewIndex.configSetUp.linkToFood.dataPrevValue.choiceOptionId())}function ChoiceOptionViewModel(){var n=this;n.cloneDataArrayStore=ko.observableArray([]);n.dataArrayStore=ko.observableArray([]);n.dataSetUpModal=new SetUpChoiceOptionViewModel;n.tempDataDragging=ko.observableArray([]);n.tempItemDragging=ko.observableArray([]);n.chkBtnAdd=ko.observable(!1);n.chkBtnUpdate=ko.observable(!1);n.chkSearch=ko.observable(!1);n.pageSize=ko.observable(30);n.pageIndex=ko.observable(1);n.clickUnlockChoiceOptionDeliverect=function(){swalUnlockChoiceOptionAndChoiceDeliverect(!0)};n.dataGridChoiceOption=ko.observable({dataSource:{store:n.dataArrayStore,sort:"choiceSorting"},showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,allowColumnReordering:!0,columnAutoWidth:!0,rowAlternationEnabled:!1,columns:[{dataField:"choiceSorting",caption:"#",width:40,alignment:"center"},{dataField:"choiceOptionName",caption:"Name",width:200},{dataField:"choiceOptionNameAlt",caption:"Name Alt",width:200},{dataField:"choiceMulti",caption:"Multiple",alignment:"center",width:100},{dataField:"choiceRequire",caption:"Require",alignment:"center",width:100},{dataField:"choiceNewLine",caption:"New Line",alignment:"center",width:100},{dataField:"active",caption:"Active",alignment:"center",width:100}],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.column.dataField!=="choiceOptionName"||isEmpty(n.data.plu())||(i=`<img src='${cDeliverectLogo}' alt='logo-deliverect' class='float-right ml-2' width='19' height='19'/><span>${t}</span>`),n.cellElement.html(i))},onRowClick:function(t){if(vmViewIndex.configSetUp.chkDrag()==!1&&vmViewIndex.configSetUp.chkSave()==!1){var i=t.data,r=ko.mapping.toJSON(i);ko.mapping.fromJSON(r,{},n.dataSetUpModal);n.dataSetUpModal.cloneArrayProductTag(vmViewIndex.configSetUp.productTagStore.slice(0));vmViewIndex.configSetUp.disableButtonSubmit(!1);i.plu()!=""?($("#modalSetUpChoiceOption .switch-custom").dxSwitch({disabled:!0}),$("#modalSetUpChoiceOption #tagChoiceOption").dxTagBox({disabled:!0}),$("#modalSetUpChoiceOption #selectArrange, #modalSetUpChoiceOption #selectMaxChoice").dxSelectBox({disabled:!0}),$("#modalSetUpChoiceOption input").attr("disabled","disabled")):($("#modalSetUpChoiceOption .switch-custom").dxSwitch({disabled:!1}),$("#modalSetUpChoiceOption #tagChoiceOption").dxTagBox({disabled:!1}),$("#modalSetUpChoiceOption #selectArrange, #modalSetUpChoiceOption #selectMaxChoice").dxSelectBox({disabled:!1}),$("#modalSetUpChoiceOption input").removeAttr("disabled"));$("#modalSetUpChoiceOption").modal({keyboard:!1,backdrop:!1,show:!0});n.chkBtnUpdate(!0);n.chkBtnAdd(!1)}},onToolbarPreparing:function(t){var i=t.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){n.chkSearch()==!1?n.chkSearch(!0):n.chkSearch()==!0&&n.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.configSetUp.disableButtonSubmit(!1);n.dataSetUpModal.cloneArrayProductTag(vmViewIndex.configSetUp.productTagStore.slice(0));$("#modalSetUpChoiceOption").modal({keyboard:!1,backdrop:!1,show:!0});n.chkBtnAdd(!0);n.chkBtnUpdate(!1);$("#modalSetUpChoiceOption .switch-custom").dxSwitch({disabled:!1});$("#modalSetUpChoiceOption #tagChoiceOption").dxTagBox({disabled:!1});$("#modalSetUpChoiceOption #selectArrange, #modalSetUpChoiceOption #selectMaxChoice").dxSelectBox({disabled:!1});$("#modalSetUpChoiceOption input").removeAttr("disabled")}}},{widget:"dxButton",location:"after",options:{visible:vmViewIndex.configSetUp.chkDrag,icon:"fa fa-save",hint:"Save Changes",type:"success",useSubmitBehavior:!0,onClick:function(){var t=null;n.dataArrayStore().load().done(function(n){t=ko.mapping.fromJS(_.orderBy(ko.mapping.toJS(n),["choiceSorting"],["asc"]))()});swalConfirmSaveSortableChoice(cChoiceOptionUpDateSortable,t)}}},{widget:"dxButton",location:"after",options:{visible:vmViewIndex.configSetUp.chkDrag,icon:"fa fa-undo",hint:"Undo/Cancel",type:"danger",onClick:function(){var n=vmViewIndex.configSetUp.choiceOption;vmViewIndex.showLoading(!0);setTimeout(function(){undoDragging(n);refreshGrid("gridChoiceOption")},3e3);vmViewIndex.configSetUp.chkDrag(!1)}}})},searchPanel:{visible:n.chkSearch,placeholder:"Search...",highlightSearchText:!1},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],infoText:"Page {0} of {1}",showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowType=="data"&&n.rowElement.addClass("myRow myRow-hover").data("keyValue",n.key)},onContentReady:function(t){var i=t.element.find(".dx-page-size.dx-selection").html(),r=t.element.find(".dx-page.dx-selection").html();n.pageSize(Number(i));n.pageIndex(Number(r));choiceOptionSortable(t.element,n.dataArrayStore());n.tempDataDragging().length!=0&&n.tempItemDragging().length!=0&&vmViewIndex.configSetUp.chkDrag(!0);$("#gridChoiceOption .dx-scrollable").dxScrollable({showScrollbar:"always"})}})}function SetUpChoiceOptionViewModel(){var n=this;n.clickCheckChoiceMulti=function(){return n.choiceMulti()==!1&&n.maxChoice(0),!0};n.clickCheckChoiceRequire=function(){return!0};n.clickCheckChoiceNewLine=function(){return!0};n.active=ko.observable(!0);n.choiceOptionId=ko.observable("");n.choiceOptionName=ko.observable("");n.choiceOptionNameAlt=ko.observable("");n.choiceSorting=ko.observable("");n.choiceMulti=ko.observable(!1);n.choiceRequire=ko.observable(!1);n.choiceNewLine=ko.observable(!1);n.arrange=ko.observable(0);n.maxChoice=ko.observable(0);n.cloneArrayProductTag=ko.observableArray([]);n.listProductTag=ko.observableArray([]);n.productTagSelect=ko.observable("");n.plu=ko.observable("");n.btnActive=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.active,onValueChanged:function(t){t.value==!0?n.active(!0):n.active(!1)}});n.selectTag=ko.observable({dataSource:n.cloneArrayProductTag,displayExpr:"productTagName",valueExpr:"productTagId",value:n.listProductTag,showDropDownButton:!0,searchEnabled:!0,onValueChanged:function(t){var i=t.value;n.productTagSelect(ko.toJSON(i))}});n.itemMaxChoice=[{maxChoice:0,value:"-"},{maxChoice:1,value:1},{maxChoice:2,value:2},{maxChoice:3,value:3},{maxChoice:4,value:4},{maxChoice:5,value:5},{maxChoice:6,value:6},{maxChoice:7,value:7},{maxChoice:8,value:8},{maxChoice:9,value:9},{maxChoice:10,value:10}];n.selectMaxChoice=ko.observable({acceptCustomValue:!1,dataSource:n.itemMaxChoice,displayExpr:"value",value:n.maxChoice,valueExpr:"maxChoice",dropDownButtonTemplate:"dropDownButton",onItemClick:function(n){n.itemData.value!=null&&(n.itemData.value=="-"?vmViewIndex.configSetUp.choiceOption.dataSetUpModal.maxChoice(0):vmViewIndex.configSetUp.choiceOption.dataSetUpModal.maxChoice(n.itemData.value))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()}});n.itemArrange=[{arrange:0,value:"Default"},{arrange:1,value:"Left-to-Right"},{arrange:2,value:"Top-to-Down"}];n.selectArrange=ko.observable({acceptCustomValue:!1,dataSource:n.itemArrange,displayExpr:"value",value:n.arrange,valueExpr:"arrange",dropDownButtonTemplate:"dropDownButton",onItemClick:function(n){n.itemData.value!=null&&(n.itemData.value=="Default"?vmViewIndex.configSetUp.choiceOption.dataSetUpModal.arrange(0):n.itemData.value=="Left-to-Right"?vmViewIndex.configSetUp.choiceOption.dataSetUpModal.arrange(1):vmViewIndex.configSetUp.choiceOption.dataSetUpModal.arrange(2))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()}});n.btnCloseSetUpChoiceOption=function(){n.clearSetUpChoiceOption();vmViewIndex.configSetUp.choice.showBtnLinkToFood(!1);vmViewIndex.configSetUp.choiceModify.showBtnLinkToFood(!1)};n.clearSetUpChoiceOption=function(){n.active(!0);n.choiceOptionName("");n.choiceOptionNameAlt("");n.choiceMulti(!1);n.choiceRequire(!1);n.choiceNewLine(!1);n.arrange(0);n.maxChoice(0);n.listProductTag([]);n.productTagSelect("");n.plu("")}}function GetCopyChoice(){vmViewIndex.configSetUp.choice.jsonChoiceId(ko.toJSON(vmViewIndex.configSetUp.choice.listCopyChoice()))}function ChoiceViewModel(){var n=this;n.dataArrayStore=ko.observableArray([]);n.cloneDataArrayStore=ko.observableArray([]);n.tempDataDragging=ko.observableArray([]);n.tempItemDragging=ko.observableArray([]);n.dataChoice=ko.observableArray([]);n.dataChoiceOption=ko.observableArray([]);n.choiceOptionId=ko.observable();n.currentChoiceOptionSelect=ko.observable();n.dataSetUpModal=new SetUpChoiceViewModel;n.dataPrevValue=new SetUpChoiceViewModel;n.chkBtnAdd=ko.observable(!1);n.chkBtnUpdate=ko.observable(!1);n.chkSearch=ko.observable(!1);n.showBtnLinkToFood=ko.observable(!1);n.showBtnUnlockChoice=ko.observable(!1);n.clickUnlockChoiceDeliverect=function(){swalUnlockChoiceOptionAndChoiceDeliverect(!1)};n.visibleListCopyChoice=ko.observable(!1);n.listCopyChoice=ko.observableArray([]);n.jsonChoiceId=ko.observable("");n.clickDeleteInCart=ko.observable();n.popoverCopyChoice=ko.observable();n.choiceOptionCopy=ko.observable();n.pageSize=ko.observable(30);n.pageIndex=ko.observable(1);n.clickCopyChoice=function(){swalConfirmSaveCopyChoice(cfrmCopyChoice,n.listCopyChoice(),n.choiceOptionCopy())};n.clickDeleteInCart=function(t){var r=t.choiceGuid(),i="#copyChoice_"+r;n.listCopyChoice.remove(t);$(i).removeClass("copy-not-active");$(i).addClass("copy-active");UpdateCartCopyChoice()};isEmpty(n.currentChoiceOptionSelect)&&n.choiceOptionCopy(n.currentChoiceOptionSelect);n.choiceTypeId=ko.observable();n.clickCopyChoiceModify=function(){swalConfirmSaveCopyChoiceModify(cfrmCopyChoice,vmViewIndex.configSetUp.choice.listCopyChoice(),n.choiceOptionCopy())};n.clickDeleteInCartModify=ko.observable();n.clickDeleteInCartModify=function(t){var r=t.choiceGuid(),i="#copyChoiceModify_"+r;n.listCopyChoice.remove(t);$(i).removeClass("copy-not-active");$(i).addClass("copy-active");UpdateCartCopyChoiceModify()};n.operaterArray=ko.observableArray([{name:cOperater.mapName[cOperater.cAdd].name,symbol:cOperater.mapSymbol[cOperater.cAdd].symbol},{name:cOperater.mapName[cOperater.cMultiply].name,symbol:cOperater.mapSymbol[cOperater.cMultiply].symbol}]);n.operaterSelect=ko.observable({dataSource:new DevExpress.data.ArrayStore({data:n.operaterArray(),key:"symbol"}),displayExpr:"name",valueExpr:"symbol",value:n.dataSetUpModal.choiceOperator,placeholder:"Select Operater",onItemClick:function(t){var i=t.itemData.symbol;i==cOperater.mapSymbol[cOperater.cAdd].symbol?n.dataSetUpModal.choiceOperator(cOperater.mapSymbol[cOperater.cAdd].symbol):n.dataSetUpModal.choiceOperator(cOperater.mapSymbol[cOperater.cMultiply].symbol)}});n.choiceOptionSelect=ko.observable({dataSource:{store:n.dataChoiceOption,sort:"choiceSorting"},displayExpr:"choiceOptionName",valueExpr:"choiceOptionId",value:n.currentChoiceOptionSelect,dropDownButtonTemplate:"dropDownButton",searchEnabled:!0,onItemClick:function(t){if(t.itemData.choiceOptionId!=null){var i=ko.utils.arrayFilter(n.dataChoice(),function(n){return n.choiceOptionId()==t.itemData.choiceOptionId});n.dataArrayStore()._array=i;n.cloneDataArrayStore(ko.mapping.toJS(i));n.choiceOptionId(t.itemData.choiceOptionId);n.choiceOptionCopy(t.itemData.choiceOptionId);refreshGrid("gridChoice");refreshGrid("gridChoiceModify")}vmViewIndex.configSetUp.chkDrag(!1)},onOpened:function(n){n.component._popup.option("closeOnTargetScroll",!1)}});n.dataGridChoice=ko.observable({dataSource:{store:n.dataArrayStore,sort:"choiceSorting"},showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,rowAlternationEnabled:!1,columns:[{dataField:"choiceSorting",caption:"#",alignment:"center",width:40},{dataField:"choiceName",caption:"Name",width:180},{dataField:"choiceNameAlt",caption:"Name Alt",width:150},{dataField:"choicePrice",caption:"Price",dataType:"number",alignment:"center",format:"currency",precision:2,width:110},{dataField:"choiceWeight",caption:"Weight",dataType:"number",alignment:"center",format:"fixedPoint",precision:2,width:110},{dataField:"active",caption:"Active",alignment:"center",width:100}],onCellHoverChanged:function(t){if(!isEmpty(t.value)&&isEmpty(t.data.plu())){var i=$("#popoverCopyChoice").dxPopover({width:50,height:50,hoverStateEnabled:!0,position:"left",animation:{show:{type:"pop",from:{scale:0},to:{scale:1}},hide:{type:"fade",from:1,to:0}}}).dxPopover("instance");t.eventType=="mouseover"&&t.rowType=="data"&&(i.option("contentTemplate",function(r){$("<a>").attr("id","copyChoice_"+t.data.choiceGuid()).attr("href","#/").attr("title","Copy Choice Option").addClass("fa fa-file fa-2x link-copy-food copy-active").on("dxclick",function(){n.visibleListCopyChoice(!0);$(event.target).closest(".link-copy-food").removeClass("copy-active");$(event.target).closest(".link-copy-food").addClass("copy-not-active");vmViewIndex.configSetUp.choice.listCopyChoice.push(new CopyChoice(t.data.choiceId(),t.data.choiceName(),t.data.choiceGuid()));UpdateCartCopyChoice();i.hide()}).appendTo(r)}),i.option("target",t.cellElement),i.show())}},onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.column.dataField!=="choiceName"||isEmpty(n.data.plu())||(i=`<img src='${cDeliverectLogo}' alt='logo-deliverect' class='float-right ml-2' width='19' height='19'/><span>${t}</span>`),n.cellElement.html(i))},onRowClick:function(t){if(vmViewIndex.configSetUp.chkDrag()==!1&&vmViewIndex.configSetUp.chkSave()==!1){var r=t.data,i=ko.mapping.toJSON(r);ko.mapping.fromJSON(i,{},n.dataSetUpModal);ko.mapping.fromJSON(i,{},n.dataPrevValue);ko.mapping.fromJSON(i,{},vmViewIndex.configSetUp.linkToFood.dataPrevValue);n.dataSetUpModal.cloneArrayProductTag(vmViewIndex.configSetUp.productTagStore.slice(0));vmViewIndex.configSetUp.disableButtonSubmit(!1);r.plu()!=""?($("#modalSetUpChoice .switch-custom").dxSwitch({disabled:!0}),$("#modalSetUpChoice #tagChoice").dxTagBox({disabled:!0}),$("#modalSetUpChoice #txtChoiceSetUp_ChoiceOptionID").dxSelectBox({disabled:!0}),$("#modalSetUpChoice input").attr("disabled","disabled")):($("#modalSetUpChoice .switch-custom").dxSwitch({disabled:!1}),$("#modalSetUpChoice #tagChoice").dxTagBox({disabled:!1}),$("#modalSetUpChoice #txtChoiceSetUp_ChoiceOptionID").dxSelectBox({disabled:!1}),$("#modalSetUpChoice input").removeAttr("disabled"));$("#modalSetUpChoice").modal({keyboard:!1,show:!0,backdrop:!1});n.chkBtnAdd(!1);n.chkBtnUpdate(!0);n.showBtnLinkToFood(!0);n.showBtnUnlockChoice(!0)}},onToolbarPreparing:function(t){var i=t.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){n.chkSearch()==!1?n.chkSearch(!0):n.chkSearch()==!0&&n.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",onClick:function(){vmViewIndex.configSetUp.disableButtonSubmit(!1);n.dataSetUpModal.cloneArrayProductTag(vmViewIndex.configSetUp.productTagStore.slice(0));$("#modalSetUpChoice").modal({keyboard:!1,backdrop:!1,show:!0});n.chkBtnAdd(!0);n.chkBtnUpdate(!1);n.showBtnUnlockChoice(!1);$("#modalSetUpChoice .switch-custom").dxSwitch({disabled:!1});$("#modalSetUpChoice #tagChoice").dxTagBox({disabled:!1});$("#modalSetUpChoice #txtChoiceSetUp_ChoiceOptionID").dxSelectBox({disabled:!1});$("#modalSetUpChoice input").removeAttr("disabled")}}},{widget:"dxButton",location:"after",options:{visible:vmViewIndex.configSetUp.chkDrag,icon:"fa fa-save",hint:"Save Changes",type:"success",useSubmitBehavior:!0,onClick:function(){var t=null;n.dataArrayStore().load().done(function(n){t=ko.mapping.fromJS(_.orderBy(ko.mapping.toJS(n),["choiceSorting"],["asc"]))()});swalConfirmSaveSortableChoice(cChoiceUpDateSortable,t)}}},{widget:"dxButton",location:"after",options:{visible:vmViewIndex.configSetUp.chkDrag,icon:"fa fa-undo",hint:"Undo/Cancel",type:"danger",onClick:function(){var n=vmViewIndex.configSetUp.choice;vmViewIndex.showLoading(!0);setTimeout(function(){undoDragging(n);refreshGrid("gridChoice")},3e3);vmViewIndex.configSetUp.chkDrag(!1)}}},{widget:"dxSelectBox",location:"before",options:n.choiceOptionSelect})},searchPanel:{visible:n.chkSearch,placeholder:"Search...",highlightSearchText:!1},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowType=="data"&&n.rowElement.addClass("myRow myRow-hover").data("keyValue",n.key)},onContentReady:function(t){var i=t.element.find(".dx-page-size.dx-selection").html(),r=t.element.find(".dx-page.dx-selection").html();n.pageSize(Number(i));n.pageIndex(Number(r));choiceSortable(t.element,n.dataArrayStore());n.tempDataDragging().length!=0&&n.tempItemDragging().length!=0&&vmViewIndex.configSetUp.chkDrag(!0);$("#gridChoice .dx-scrollable").dxScrollable({showScrollbar:"always"})}});n.dataGridChoiceModify=ko.observable({dataSource:{store:n.dataArrayStore,sort:"choiceSorting"},showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,rowAlternationEnabled:!1,columns:[{dataField:"choiceSorting",caption:"#",alignment:"center",width:40},{dataField:"choiceName",caption:"Name",width:180},{dataField:"choiceNameAlt",caption:"Name Alt",width:150},{dataField:"choicePrice",caption:"Price",dataType:"number",alignment:"center",format:"currency",precision:2,width:110},{dataField:"choiceWeight",caption:"Weight",dataType:"number",alignment:"center",format:"fixedPoint",precision:2,width:110},{dataField:"active",caption:"Active",alignment:"center",width:100}],onCellHoverChanged:function(n){var t=$("#popoverCopyChoice").dxPopover({width:50,height:50,hoverStateEnabled:!0,position:"left",animation:{show:{type:"pop",from:{scale:0},to:{scale:1}},hide:{type:"fade",from:1,to:0}}}).dxPopover("instance");n.eventType=="mouseover"&&n.rowType=="data"&&(t.option("contentTemplate",function(i){$("<a>").attr("id","copyChoiceModify_"+n.data.choiceGuid()).attr("href","#/").attr("title","Copy Choice Modify").addClass("fa fa-file fa-2x link-copy-food copy-active").on("dxclick",function(){$(event.target).closest(".link-copy-food").removeClass("copy-active");$(event.target).closest(".link-copy-food").addClass("copy-not-active");vmViewIndex.configSetUp.choice.listCopyChoice.push(new CopyChoice(n.data.choiceId(),n.data.choiceName(),n.data.choiceGuid()));vmViewIndex.configSetUp.choice.visibleListCopyChoice(!0);UpdateCartCopyChoiceModify();t.hide()}).appendTo(i)}),t.option("target",n.cellElement),t.show())},onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(t){if(vmViewIndex.configSetUp.chkDrag()==!1&&vmViewIndex.configSetUp.chkSave()==!1){var r=t.data,i=ko.mapping.toJSON(r);ko.mapping.fromJSON(i,{},n.dataSetUpModal);ko.mapping.fromJSON(i,{},n.dataPrevValue);ko.mapping.fromJSON(i,{},vmViewIndex.configSetUp.linkToFood.dataPrevValue);n.dataSetUpModal.cloneArrayProductTag(vmViewIndex.configSetUp.productTagStore.slice(0));vmViewIndex.configSetUp.disableButtonSubmit(!1);$("#modalSetUpChoiceModify").modal({keyboard:!1,show:!0,backdrop:!1});n.chkBtnAdd(!1);n.chkBtnUpdate(!0);n.showBtnLinkToFood(!0)}},onToolbarPreparing:function(t){var i=t.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){n.chkSearch()==!1?n.chkSearch(!0):n.chkSearch()==!0&&n.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",onClick:function(){vmViewIndex.configSetUp.disableButtonSubmit(!1);n.dataSetUpModal.cloneArrayProductTag(vmViewIndex.configSetUp.productTagStore.slice(0));$("#modalSetUpChoiceModify").modal({keyboard:!1,backdrop:!1,show:!0});n.chkBtnAdd(!0);n.chkBtnUpdate(!1)}}},{widget:"dxButton",location:"after",options:{visible:vmViewIndex.configSetUp.chkDrag,icon:"fa fa-save",hint:"Save Changes",type:"success",useSubmitBehavior:!0,onClick:function(){var t=null;n.dataArrayStore().load().done(function(n){t=ko.mapping.fromJS(_.orderBy(ko.mapping.toJS(n),["choiceSorting"],["asc"]))()});swalConfirmSaveSortableChoice(cChoiceModifyUpDateSortable,t)}}},{widget:"dxButton",location:"after",options:{visible:vmViewIndex.configSetUp.chkDrag,icon:"fa fa-undo",hint:"Undo/Cancel",type:"danger",onClick:function(){var n=vmViewIndex.configSetUp.choiceModify;vmViewIndex.showLoading(!0);setTimeout(function(){undoDragging(n);refreshGrid("gridChoiceModify")},3e3);vmViewIndex.configSetUp.chkDrag(!1)}}},{widget:"dxSelectBox",location:"before",options:n.choiceOptionSelect})},searchPanel:{visible:n.chkSearch,placeholder:"Search...",highlightSearchText:!1},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowType=="data"&&n.rowElement.addClass("myRow myRow-hover").data("keyValue",n.key)},onContentReady:function(t){var i=t.element.find(".dx-page-size.dx-selection").html(),r=t.element.find(".dx-page.dx-selection").html();n.pageSize(Number(i));n.pageIndex(Number(r));choiceModifySortable(t.element,n.dataArrayStore());n.tempDataDragging().length!=0&&n.tempItemDragging().length!=0&&vmViewIndex.configSetUp.chkDrag(!0);$("#gridChoiceModify .dx-scrollable").dxScrollable({showScrollbar:"always"})}})}function SetUpChoiceViewModel(){var n=this;n.active=ko.observable(!0);n.choiceId=ko.observable("");n.choiceName=ko.observable("");n.choiceNameAlt=ko.observable("");n.choiceOptionId=ko.observable("");n.choiceSorting=ko.observable("");n.choicePrice=ko.observable(0).extend({numeric:2});n.choiceWeight=ko.observable(0).extend({numeric:2});n.choiceOperator=ko.observable(cOperater.mapSymbol[cOperater.cAdd].symbol);n.cloneArrayProductTag=ko.observableArray([]);n.listProductTag=ko.observableArray([]);n.productTagSelect=ko.observable("");n.plu=ko.observable("");n.btnCloseSetUpChoice=function(){n.clearSetUpChoice(vmViewIndex.configSetUp.choice.dataSetUpModal);vmViewIndex.configSetUp.choice.currentChoiceOptionSelect(n.choiceOptionId());vmViewIndex.configSetUp.choice.showBtnLinkToFood(!1);vmViewIndex.configSetUp.choice.showBtnUnlockChoice(!1)};n.btnActive=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.active,onValueChanged:function(t){t.value==!0?n.active(!0):n.active(!1)}});n.selectTag=ko.observable({dataSource:n.cloneArrayProductTag,displayExpr:"productTagName",valueExpr:"productTagId",value:n.listProductTag,showDropDownButton:!0,searchEnabled:!0,onValueChanged:function(t){var i=t.value;n.productTagSelect(ko.toJSON(i))}});n.clearSetUpChoice=function(){n.active(!0);n.choiceName("");n.choiceNameAlt("");n.choicePrice("0.00");n.choiceWeight("0.00");removeClassValidationError("#txtChoiceSetUp_ChoicePrice");removeClassValidationError("#txtChoiceSetUp_ChoiceWeight");n.listProductTag([]);n.productTagSelect("");n.plu("")};n.btnCloseSetUpChoiceModify=function(){n.clearSetUpChoiceModify(vmViewIndex.configSetUp.choiceModify.dataSetUpModal);vmViewIndex.configSetUp.choiceModify.currentChoiceOptionSelect(vmViewIndex.configSetUp.choiceModify.choiceOptionId());vmViewIndex.configSetUp.choiceModify.showBtnLinkToFood(!1)};n.clearSetUpChoiceModify=function(n){n.active(!0);n.choiceName("");n.choiceNameAlt("");n.choicePrice("0.00");n.choiceWeight("0.00");n.choiceOperator(cOperater.mapSymbol[cOperater.cAdd].symbol);removeClassValidationError("#txtChoiceSetUp_ChoicePrice");removeClassValidationError("#txtChoiceSetUp_ChoiceWeight");n.listProductTag([]);n.productTagSelect("")}}function TaxRateViewModel(){var n=this,t;n.data=ko.observableArray([]);n.dataSetUpModal=new SetUpTaxRateViewModel;n.chkBtnAdd=ko.observable(!1);n.chkBtnUpdate=ko.observable(!1);n.chkSearch=ko.observable(!1);n.dataGridTaxRate=ko.observable({dataSource:n.data,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,rowAlternationEnabled:!1,onInitialized:function(n){t=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,i){n.text(t.pageIndex()*t.pageSize()+i.rowIndex+1)}},{dataField:"taxRateName",caption:"Name",width:250},{dataField:"taxRatePercentage",caption:"Percentage",dataType:"number",alignment:"center",format:"fixedPoint",precision:2,width:120},{dataField:"markChar",caption:"MarkChar",width:110},{dataField:"markLegend",caption:"MarkLegend",width:110},{dataField:"active",caption:"Active",alignment:"center",width:100}],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(t){var i=t.data,r=ko.mapping.toJSON(i);ko.mapping.fromJSON(r,{},n.dataSetUpModal);vmViewIndex.configSetUp.disableButtonSubmit(!1);$("#modalSetUpTaxRate").modal({keyboard:!1,show:!0,backdrop:!1});n.chkBtnAdd(!1);n.chkBtnUpdate(!0)},onToolbarPreparing:function(t){var i=t.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){n.chkSearch()==!1?n.chkSearch(!0):n.chkSearch()==!0&&n.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",onClick:function(){vmViewIndex.configSetUp.disableButtonSubmit(!1);$("#modalSetUpTaxRate").modal({keyboard:!1,backdrop:!1,show:!0});n.chkBtnAdd(!0);n.chkBtnUpdate(!1)}}})},searchPanel:{visible:n.chkSearch,placeholder:"Search...",highlightSearchText:!1},pager:{allowPageSize:"auto",infoText:"Page {0} of {1}",showInfo:!1,visible:"auto"},paging:{enabled:!0,pageIndex:0,pageSize:10},onRowPrepared:function(n){n.rowElement.addClass("myRow myRow-hover")},onContentReady:function(){$("#gridTaxRate .dx-scrollable").dxScrollable({showScrollbar:"always"})}})}function SetUpTaxRateViewModel(){var n=this;n.active=ko.observable(!0);n.taxRateId=ko.observable("");n.taxRateName=ko.observable("");n.taxRatePercentage=ko.observable(0).extend({numeric:2});n.markChar=ko.observable("");n.markLegend=ko.observable("");n.btnActive=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.active,onValueChanged:function(t){t.value==!0?n.active(!0):n.active(!1)}});n.btnCloseSetUpTaxRate=function(){n.clearSetUpTaxRate()};n.clearSetUpTaxRate=function(){n.active(!0);n.taxRateName("");n.taxRatePercentage("0.0");n.markChar("");n.markLegend("");removeClassValidationError("#txtTaxRateSetUp_TaxRatePercentage")}}function GraguityChargeViewModel(){var n=this,t;n.data=ko.observableArray([]);n.dataSetUpModal=new SetUpGraguityChargeViewModel;n.chkBtnAdd=ko.observable(!1);n.chkBtnUpdate=ko.observable(!1);n.chkSearch=ko.observable(!1);n.dataGridGraguityCharge=ko.observable({dataSource:n.data,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,rowAlternationEnabled:!1,onInitialized:function(n){t=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,i){n.text(t.pageIndex()*t.pageSize()+i.rowIndex+1)}},{dataField:"graguityName",caption:"Name",width:320},{dataField:"graguityPercentage",caption:"Percentage",dataType:"number",alignment:"center",format:"fixedPoint",precision:2,width:185},{dataField:"active",caption:"Active",alignment:"center",width:185}],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(t){var i=t.data,r=ko.mapping.toJSON(i);ko.mapping.fromJSON(r,{},n.dataSetUpModal);vmViewIndex.configSetUp.disableButtonSubmit(!1);$("#modalSetUpGraguityCharge").modal({keyboard:!1,show:!0,backdrop:!1});n.chkBtnAdd(!1);n.chkBtnUpdate(!0)},onToolbarPreparing:function(t){var i=t.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){n.chkSearch()==!1?n.chkSearch(!0):n.chkSearch()==!0&&n.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",onClick:function(){vmViewIndex.configSetUp.disableButtonSubmit(!1);$("#modalSetUpGraguityCharge").modal({keyboard:!1,backdrop:!1,show:!0});n.chkBtnAdd(!0);n.chkBtnUpdate(!1)}}})},searchPanel:{visible:n.chkSearch,placeholder:"Search...",highlightSearchText:!1},pager:{allowPageSize:"auto",infoText:"Page {0} of {1}",showInfo:!1,visible:"auto"},paging:{enabled:!0,pageIndex:0,pageSize:10},onRowPrepared:function(n){n.rowElement.addClass("myRow myRow-hover")},onContentReady:function(){$("#gridGraguityCharge .dx-scrollable").dxScrollable({showScrollbar:"always"})}})}function SetUpGraguityChargeViewModel(){var n=this;n.active=ko.observable(!0);n.graguityId=ko.observable("");n.graguityName=ko.observable("");n.graguityPercentage=ko.observable(0).extend({numeric:2});n.btnActive=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.active,onValueChanged:function(t){t.value==!0?n.active(!0):n.active(!1)}});n.btnCloseSetUpGraguityCharge=function(){n.clearSetUpGraguityCharge()};n.clearSetUpGraguityCharge=function(){n.active(!0);n.graguityName("");n.graguityPercentage("0.0");removeClassValidationError("#txtGraguityChargeSetUp_GraguityPercentage")}}function FoodPrefixViewModel(){var n=this;n.cloneDataArrayStore=ko.observableArray([]);n.dataArrayStore=ko.observableArray([]);n.dataSetUpModal=new SetUpFoodPrefixViewModel;n.tempDataDragging=ko.observableArray([]);n.tempItemDragging=ko.observableArray([]);n.chkBtnAdd=ko.observable(!1);n.chkBtnUpdate=ko.observable(!1);n.chkSearch=ko.observable(!1);n.pageSize=ko.observable(30);n.pageIndex=ko.observable(1);n.dataGridFoodPrefix=ko.observable({dataSource:{store:n.dataArrayStore,sort:"prefixSorting"},showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,allowColumnReordering:!0,columnAutoWidth:!0,rowAlternationEnabled:!1,columns:[{dataField:"prefixSorting",caption:"#",width:40,alignment:"center"},{dataField:"prefixName",caption:"Name",width:200},{dataField:"prefixDesc",caption:"Description",width:200},{dataField:"isPrefixCal",caption:"Cal",alignment:"center",width:95},{dataField:"prefixColorRed",caption:"Color Red",alignment:"center",width:95},{dataField:"active",caption:"Status",alignment:"center",width:100}],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(t){if(vmViewIndex.configSetUp.chkDrag()==!1&&vmViewIndex.configSetUp.chkSave()==!1){var i=t.data,r=ko.mapping.toJSON(i);ko.mapping.fromJSON(r,{},n.dataSetUpModal);vmViewIndex.configSetUp.disableButtonSubmit(!1);$("#modalSetUpFoodPrefix").modal({keyboard:!1,backdrop:!1,show:!0});n.chkBtnUpdate(!0);n.chkBtnAdd(!1)}},onToolbarPreparing:function(t){var i=t.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){n.chkSearch()==!1?n.chkSearch(!0):n.chkSearch()==!0&&n.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.configSetUp.disableButtonSubmit(!1);$("#modalSetUpFoodPrefix").modal({keyboard:!1,backdrop:!1,show:!0});n.chkBtnAdd(!0);n.chkBtnUpdate(!1)}}},{widget:"dxButton",location:"after",options:{visible:vmViewIndex.configSetUp.chkDrag,icon:"fa fa-save",hint:"Save Changes",type:"success",useSubmitBehavior:!0,onClick:function(){var t=null;n.dataArrayStore().load().done(function(n){t=ko.mapping.fromJS(_.orderBy(ko.mapping.toJS(n),["prefixSorting"],["asc"]))()});swalConfirmSaveSortableChoice(cFoodPrefixUpDateSortable,t)}}},{widget:"dxButton",location:"after",options:{visible:vmViewIndex.configSetUp.chkDrag,icon:"fa fa-undo",hint:"Undo/Cancel",type:"danger",onClick:function(){var n=vmViewIndex.configSetUp.foodPrefix;vmViewIndex.showLoading(!0);setTimeout(function(){undoDragging(n);refreshGrid("gridFoodPrefix")},3e3);vmViewIndex.configSetUp.chkDrag(!1)}}})},searchPanel:{visible:n.chkSearch,placeholder:"Search...",highlightSearchText:!1},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],infoText:"Page {0} of {1}",showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowType=="data"&&n.rowElement.addClass("myRow myRow-hover").data("keyValue",n.key)},onContentReady:function(t){var i=t.element.find(".dx-page-size.dx-selection").html(),r=t.element.find(".dx-page.dx-selection").html();n.pageSize(Number(i));n.pageIndex(Number(r));foodPrefixSortable(t.element,n.dataArrayStore());n.tempDataDragging().length!=0&&n.tempItemDragging().length!=0&&vmViewIndex.configSetUp.chkDrag(!0);$("#gridFoodPrefix .dx-scrollable").dxScrollable({showScrollbar:"always"})}})}function SetUpFoodPrefixViewModel(){var n=this;n.prefixId=ko.observable("");n.prefixName=ko.observable("");n.prefixDesc=ko.observable("");n.prefixCal=ko.observable("");n.prefixColorRed=ko.observable(!1);n.prefixStatus=ko.observable("A");n.prefixSorting=ko.observable("");n.isPrefixCal=ko.observable(!1);n.active=ko.observable(!0);n.btnStatus=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.active,onValueChanged:function(t){t.value==!0?(n.active(!0),n.prefixStatus("A")):(n.active(!1),n.prefixStatus("B"))}});n.clickIsPrefixCal=function(t){var i=t.configSetUp.foodPrefix.dataSetUpModal.isPrefixCal();return i?(n.isPrefixCal(!0),n.prefixCal(1)):(n.isPrefixCal(!1),n.prefixCal(0)),!0};n.clickPrefixColorRed=function(t){var i=t.configSetUp.foodPrefix.dataSetUpModal.prefixColorRed();return i?n.prefixColorRed(!0):n.prefixColorRed(!1),!0};n.btnCloseSetUpFoodPrefix=function(){n.clearSetUpFoodPrefix()};n.clearSetUpFoodPrefix=function(){n.prefixName("");n.prefixDesc("");n.prefixCal("");n.prefixColorRed(!1);n.prefixStatus("");n.prefixSorting("");n.isPrefixCal(!1);n.active(!0);removeClassValidationError("#txtFoodPrefixSetUp_PrefixName")}}function RevenueClassViewModel(){var n=this,t;n.data=ko.observableArray([]);n.dataRevenueClass=ko.observableArray([]);n.dataTaxRate=ko.observableArray([]);n.taxRateId=ko.observable("");n.currentTaxRateSelect=ko.observable("");n.dataSetUpModal=new SetUpRevenueClassViewModel;n.dataPrevValue=new SetUpRevenueClassViewModel;n.chkBtnAdd=ko.observable(!1);n.chkBtnUpdate=ko.observable(!1);n.chkSearch=ko.observable(!1);n.taxRateSelect=ko.observable({dataSource:n.dataTaxRate,displayExpr:"taxRateName",valueExpr:"taxRateId",value:n.currentTaxRateSelect,dropDownButtonTemplate:"dropDownButton",onValueChanged:function(t){if(t.value!=null){var i=ko.utils.arrayFilter(n.dataRevenueClass(),function(n){return n.taxRateId()==t.value});ko.mapping.fromJSON(ko.mapping.toJSON(i),{},n.data);n.taxRateId(t.value)}}});n.dataGridRevenueClass=ko.observable({dataSource:n.data,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,rowAlternationEnabled:!1,onInitialized:function(n){t=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,i){n.text(t.pageIndex()*t.pageSize()+i.rowIndex+1)}},{dataField:"revenueClassName",caption:"Name",width:320},{dataField:"isLiquor",caption:"IsLiquor",alignment:"center",width:185},{dataField:"active",caption:"Active",alignment:"center",width:185}],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(t){var r=t.data,i=ko.mapping.toJSON(r);ko.mapping.fromJSON(i,{},n.dataSetUpModal);ko.mapping.fromJSON(i,{},n.dataPrevValue);vmViewIndex.configSetUp.disableButtonSubmit(!1);$("#modalSetUpRevenueClass").modal({keyboard:!1,show:!0,backdrop:!1});n.chkBtnAdd(!1);n.chkBtnUpdate(!0)},onToolbarPreparing:function(t){var i=t.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){n.chkSearch()==!1?n.chkSearch(!0):n.chkSearch()==!0&&n.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",onClick:function(){vmViewIndex.configSetUp.disableButtonSubmit(!1);$("#modalSetUpRevenueClass").modal({keyboard:!1,backdrop:!1,show:!0});n.chkBtnAdd(!0);n.chkBtnUpdate(!1)}}},{widget:"dxSelectBox",location:"before",options:n.taxRateSelect})},searchPanel:{visible:n.chkSearch,placeholder:"Search...",highlightSearchText:!1},pager:{allowPageSize:"auto",infoText:"Page {0} of {1}",showInfo:!1,visible:"auto"},paging:{enabled:!0,pageIndex:0,pageSize:10},onRowPrepared:function(n){n.rowElement.addClass("myRow myRow-hover")},onContentReady:function(){$("#gridRevenueClass .dx-scrollable").dxScrollable({showScrollbar:"always"})}})}function SetUpRevenueClassViewModel(){var n=this;n.active=ko.observable(!0);n.revenueClassId=ko.observable("");n.revenueClassName=ko.observable("");n.isLiquor=ko.observable(!1);n.clickIsLiquor=function(){return!0};n.taxRateId=ko.observable("");n.btnCloseSetUpRevenueClass=function(){n.clearSetUpRevenueClass()};n.clearSetUpRevenueClass=function(){n.active(!0);n.revenueClassName("");n.isLiquor(!1)};n.btnActive=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.active,onValueChanged:function(t){t.value==!0?n.active(!0):n.active(!1)}})}function IconViewModel(){var n=this;n.dataArrayStore=ko.observableArray([]);n.dataSetUpModal=new SetUpIconViewModel;n.chkBtnAdd=ko.observable(!1);n.chkBtnUpdate=ko.observable(!1);n.chkSearch=ko.observable(!1);n.pageSize=ko.observable(30);n.pageIndex=ko.observable(1);n.dataGridIcon=ko.observable({dataSource:n.dataArrayStore,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,rowAlternationEnabled:!1,columns:[{caption:"#",width:80,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.rowIndex+1)}},{dataField:"iconName",caption:"Name",width:220},{dataField:"active",caption:"Active",width:150},{dataField:"isShowText",caption:"Show Text",alignment:"center",width:150},{dataField:"isFocus",caption:"Show Top",alignment:"center",width:150}],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":t.value,n.cellElement.html(i))},onRowClick:function(t){var r,u,i;vmViewIndex.configSetUp.chkDrag()==!1&&vmViewIndex.configSetUp.chkSave()==!1&&(r=t.data,u=ko.mapping.toJSON(r),ko.mapping.fromJSON(u,{},n.dataSetUpModal),vmViewIndex.configSetUp.disableButtonSubmit(!1),i=n.dataSetUpModal.iconImage(),typeof i!="undefined"?i.trim().length>0?($("#modalSetUpIcon").find("img").attr("src",i),$("#modalSetUpIcon").find("img").attr("width",$("#modalSetUpIcon").find("img").width()),$("#modalSetUpIcon").find("img").attr("height",$("#modalSetUpIcon").find("img").height())):(n.dataSetUpModal.iconImage(""),$("#modalSetUpIcon").find("img").attr("src",""),$("#modalSetUpIcon").find("img").removeAttr("src")):(n.dataSetUpModal.iconImage(""),$("#modalSetUpIcon").find("img").attr("src",""),$("#modalSetUpIcon").find("img").removeAttr("src")),$("#modalSetUpIcon").modal({keyboard:!1,backdrop:!1,show:!0}),n.chkBtnUpdate(!0),n.chkBtnAdd(!1))},onToolbarPreparing:function(t){var i=t.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){n.chkSearch()==!1?n.chkSearch(!0):n.chkSearch()==!0&&n.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){vmViewIndex.configSetUp.disableButtonSubmit(!1);$("#modalSetUpIcon").modal({keyboard:!1,backdrop:!1,show:!0});n.chkBtnAdd(!0);n.chkBtnUpdate(!1)}}})},searchPanel:{visible:n.chkSearch,placeholder:"Search...",highlightSearchText:!1},pager:{allowPageSize:"auto",infoText:"Page {0} of {1}",showInfo:!1,visible:"auto"},paging:{enabled:!0,pageIndex:0,pageSize:10},onRowPrepared:function(n){n.rowElement.addClass("myRow myRow-hover")},onContentReady:function(){$("#gridIcon .dx-scrollable").dxScrollable({showScrollbar:"always"})}});n.dropImage=function(n,t){var i=_.first(t.dataTransfer.files).name,r=i.split(".").pop().toUpperCase();r!="PNG"||_.first($(t.target).parent().parent().parent().parent().parent().parent()).id==cfrmFoodSetup&&n.configSetUp.iconSetup.dataSetUpModal.iconImage(_.first(t.dataTransfer.files))};n.changeImage=function(n,t){var f=$(t.target).attr("class"),i,r,u;f=="display-uploader"?typeof t.target.files!="undefined"&&(i=t.target.files.length,i>0&&(r=_.first(t.target.files).name,u=r.split(".").pop().toUpperCase(),u!="PNG"||n.configSetUp.iconSetup.dataSetUpModal.iconImage(_.first(t.target.files)))):(n.configSetUp.iconSetup.dataSetUpModal.iconImage(""),$(t.target).parent().parent().find(".display-uploader").val(""),$(t.target).parent().parent().find(".image img").attr("src",""),$(t.target).parent().parent().find(".image img").removeAttr("src"))}}function SetUpIconViewModel(){var n=this;n.iconId=ko.observable("");n.iconName=ko.observable("");n.iconImage=ko.observable("");n.hexColor=ko.observable(cColorBlack);n.isFocus=ko.observable(!1);n.active=ko.observable(!0);n.isShowText=ko.observable(!1);n.btnActive=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.active,onValueChanged:function(t){t.value==!0?n.active(!0):n.active(!1)}});n.btnIsFocus=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.isFocus,onValueChanged:function(t){t.value==!0?n.isFocus(!0):n.isFocus(!1)}});n.btnIsShowText=ko.observable({offText:"NO",onText:"YES",width:switchActiveWidth60px,value:n.isShowText,onValueChanged:function(t){t.value==!0?n.isShowText(!0):n.isShowText(!1)}});n.btnCloseSetUpIcon=function(){n.clearSetUpIcon()};n.clearSetUpIcon=function(){n.iconName("");n.iconImage("");n.hexColor(cColorBlack);n.isFocus(!1);n.active(!0);n.isShowText(!1);removeClassValidationError("#txtIconSetUp_IconName")}}function ReportViewModel(){var n=this;n.chart=new ChartViewModel;n.saleMadeDetail=new SaleMadeDetailViewModel}function ChartViewModel(){var n=this;n.dataSaleMade=ko.observableArray([]);n.dataOrderMade=ko.observableArray([]);n.fromDate=ko.observable();n.endDate=ko.observable();n.fromDateCompare=ko.observable();n.endDateCompare=ko.observable();n.showCompare=ko.observable(!1);n.updateChart=ko.observable(!1);n.chartMade=ko.observable(!0);n.swipeChart=ko.observable({offText:"Orders Made",onText:"Sale Made",value:n.chartMade(),width:"110px",onValueChanged:function(t){t.value?(n.chartMade(!0),chkShowHideChart()):(n.chartMade(!1),chkShowHideChart())}});n.clickCompare=function(){n.showCompare()==!1?n.showCompare(!0):n.showCompare()==!0&&n.showCompare(!1)};n.dateFromDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.fromDate,width:150,invalidDateMessage:"Value must be a date",onValueChanged:function(t){t.value!=""&&t.value!=undefined?n.fromDate(moment(t.value).format("L")):n.fromDate(moment(new Date).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.dateEndDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.endDate,width:150,invalidDateMessage:"Value must be a date",onValueChanged:function(t){t.value!=""&&t.value!=undefined?n.endDate(moment(t.value).format("L")):n.endDate(moment(new Date).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.dateFromDateBoxCompare=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.fromDateCompare,width:150,visible:n.showCompare,invalidDateMessage:"Value must be a date",onValueChanged:function(t){t.value!=""&&t.value!=undefined?n.fromDateCompare(moment(t.value).format("L")):n.fromDateCompare(moment(new Date).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.dateEndDateBoxCompare=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.endDateCompare,width:150,visible:n.showCompare,invalidDateMessage:"Value must be a date",onValueChanged:function(t){t.value!=""&&t.value!=undefined?n.endDateCompare(moment(t.value).format("L")):n.endDateCompare(moment(new Date).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}})}function SaleMadeDetailViewModel(){var n=this,t;n.data=ko.observableArray([]);n.chkSearch=ko.observable(!1);n.dataGridSaleMadeDetail=ko.observable({dataSource:n.data,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,onInitialized:function(n){t=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,i){n.text(t.pageIndex()*t.pageSize()+i.rowIndex+1)}},{dataField:"imageName",caption:"",allowFiltering:!1,allowSorting:!1,width:"auto",cellTemplate:"cellTemplate"},{dataField:"foodName",caption:"Food Name",width:200},{dataField:"foodPrice",caption:"Price",dataType:"number",cssClass:"right",format:"currency",precision:2},{dataField:"quantity",caption:"Sold",dataType:"number",width:90},{dataField:"orderChoiceAmount",caption:"Extra",dataType:"number",cssClass:"right",format:"currency",precision:2},{dataField:"sumPrice",caption:"Total",dataType:"number",cssClass:"right",format:"currency",precision:2}],pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},searchPanel:{visible:!0,placeholder:"Search...",highlightSearchText:!1},onContentReady:function(){$("#gridReport .dx-scrollable").dxScrollable({showScrollbar:"always"})}})}function BalanceViewModel(){var n=this;n.summary=ko.observableArray([]);n.ticket=ko.observableArray([]);n.fromDate=ko.observable();n.endDate=ko.observable();n.dateFromDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.fromDate,width:150,invalidDateMessage:"Value must be a date",onValueChanged:function(t){t.value!=""&&t.value!=undefined?n.fromDate(moment(t.value).format("L")):n.fromDate(moment(new Date).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.dateEndDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.endDate,width:150,invalidDateMessage:"Value must be a date",onValueChanged:function(t){t.value!=""&&t.value!=undefined?n.endDate(moment(t.value).format("L")):n.endDate(moment(new Date).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.fullDate=ko.computed(function(){return moment(n.fromDate()).format("L")+" - "+moment(n.endDate()).format("L")});n.showFoodDetail=function(n,t){var i=$(t.target).parent().parent().parent().parent().parent().parent().parent().parent();i.find(".front").rotateY(180);i.find(".back").rotateY(0)};n.showTicket=function(n,t){var i=$(t.target).parent().parent().parent().parent().parent().parent().parent().parent();i.find(".front").rotateY(0);i.find(".back").rotateY(180)}}function StatementViewModel(){var n=this,t;n.summary=ko.observableArray([]);n.statementHeader=new DataStatementHeaderViewModel;n.statementDetail=ko.observableArray([]);n.shopName=ko.observable();n.shopStreet=ko.observable();n.shopCity=ko.observable();n.shopState=ko.observable();n.shopPostal=ko.observable();n.fromDate=ko.observable();n.endDate=ko.observable();n.currentDate=ko.observable(moment().format(moment_date_format_mmddyyyyhhmmssa2));n.fullDate=ko.computed(function(){return moment(n.fromDate()).format("L")+" - "+moment(n.endDate()).format("L")});n.dataGridStatement=ko.observable({dataSource:n.statementDetail,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,onInitialized:function(n){t=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,i){n.text(t.pageIndex()*t.pageSize()+i.rowIndex+1)}},{dataField:"ticketId",caption:"#",alignment:"center",width:"110px"},{dataField:"subTotal",caption:"Sub Total",dataType:"number",alignment:"center",cssClass:"right",format:"currency",precision:2,width:"90px"},{dataField:"discount",caption:"Discount",dataType:"number",alignment:"center",cssClass:"right",format:"currency",precision:2,width:"90px"},{dataField:"deliveryCharge",caption:"DC",dataType:"number",alignment:"center",cssClass:"right",format:"currency",precision:2,width:"70px"},{dataField:"deliveryChargeTax",caption:"DC Tax",dataType:"number",alignment:"center",cssClass:"right",format:"currency",precision:2,width:"70px"},{dataField:"autoCharge",caption:"AC",dataType:"number",alignment:"center",cssClass:"right",format:"currency",precision:2,width:"70px"},{dataField:"autoChargeTax",caption:"AC Tax",dataType:"number",alignment:"center",cssClass:"right",format:"currency",precision:2,width:"70px"},{dataField:"tax",caption:"Tax",dataType:"number",cssClass:"right",alignment:"center",format:"currency",precision:2,width:"70px"},{dataField:"tip",caption:"Tip",dataType:"number",cssClass:"right",alignment:"center",format:"currency",precision:2,width:"70px"},{dataField:"total",caption:"Total",dataType:"number",cssClass:"right",alignment:"center",format:"currency",precision:2,width:"70px"}],pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},loadPanel:{enabled:!0,showPane:!1,text:""},onContentReady:function(){$("#gridStatement .dx-scrollable").dxScrollable({showScrollbar:"always"})}})}function MarketingViewModel(){var n=this;n.recordRowArr=ko.observableArray([]);n.valueRow=ko.observable("");n.defaultRow=ko.pureComputed(function(){return n.recordRowArr()[0]==undefined||isEmpty(n.recordRowArr())?"":n.recordRowArr()[0]});n.rowSelectBox=ko.observable({dataSource:n.recordRowArr,value:n.defaultRow,onValueChanged:function(t){n.valueRow(t.value)}})}function ProductViewModel(n,t){var i=this;i.valueArrProduct=ko.observable();i.arrProductFilter=ko.observableArray([]);i.selectProduct=ko.observable();i.selectItem=ko.observableArray([]);t==cfrmMenuSetup?(i.valueArrProduct(products.cAllProduct),i.arrProductFilter([{name:products.mapName[products.cAllProduct].name,id:products.cAllProduct},{name:products.mapName[products.cSmileDining].name,id:products.cSmileDining},{name:products.mapName[products.cSmileContactless].name,id:products.cSmileContactless}]),i.selectProduct({dataSource:new DevExpress.data.ArrayStore({data:i.arrProductFilter(),key:"id"}),displayExpr:"name",valueExpr:"id",value:i.valueArrProduct,placeholder:"Select Product",onItemClick:function(t){var i=t.itemData.id;n.valueProduct(i);vmViewIndex.showLoading(!0);setTimeout(function(){MapDataMenu(n.foodSetJs(),n.foodCategoryJs(),n.foodJs(),n.foodSetTimeMapJs(),n.valueFilterMenuFoodSet(),n.valueFilterMenuFoodCat(),n.valueFilterMenuFood(),i);vmViewIndex.showLoading(!1);foodSetClick()},3e3)}})):t==cfrmMySetting&&(i.valueArrProduct(products.cSmileDining),i.arrProductFilter([{name:products.mapName[products.cSmileDining].name,id:products.cSmileDining},{name:products.mapName[products.cSmileContactless].name,id:products.cSmileContactless}]),i.selectProduct({dataSource:new DevExpress.data.ArrayStore({data:i.arrProductFilter(),key:"id"}),displayExpr:"name",valueExpr:"id",value:i.valueArrProduct,placeholder:"Select Product",onItemClick:function(t){var f=t.itemData.id,e=n.selectProduct(),u,o,c,g,rt;if(e==undefined&&(e=products.cSmileDining),u=f==products.cSmileDining?!0:!1,o=!1,f!=e){c=u?jsonParseObj(cJsonGetGlobalConfig,products.cSmileContactless):jsonParseObj(cJsonGetGlobalConfig,products.cSmileDining);var r=u?jsonParseObj(cJsonGetAllDataSetting,products.cSmileDining):jsonParseObj(cJsonGetAllDataSetting,products.cSmileContactless),s=r.globalConfig,l=r.dataTime,a=r.dataHoliday,v=r.dataAutoCharge,y=r.dataDiscount,p=r.dataDiscountType,h=r.dataMap,w=r.dataGraguity,b=r.dataPromotion,k=r.dataShopClose,d=r.dataDiscountOneTimeUse;if(u){var nt=jsonParseObj(cJsonGetCouponDelivery,""),tt=_.head(nt),it=_.head(h.listDeliveryFreeTime);it!=undefined&&it.shopMapCode=="noTable"&&vmViewIndex.allMapZone.hasDeliveryFreeTime(!1);tt!=undefined&&tt.couponDeliveryName=="noTable"&&vmViewIndex.allSetting.hasCouponDelivery(!1);DataCouponDeliveryViewModel(nt);DataAllMapViewModel(h)}else g=ko.observableArray([{globalConfigKey:"smileContactless",globalConfigValue:!0,globalConfigDesc:null}]),s.push(g()[0]),o=checkMap(h,vmViewIndex.allMapZone);rt=checkShopUpdate(c,vmViewIndex.globalConfig);rt||o?swal(setupAlert).then(function(){vmViewIndex.showLoading(!0);setTimeout(function(){updateData(s,l,a,v,y,p,w,b,k,d);vmViewIndex.allSetting.isSmileDining(u);resetTipsAuto();vmViewIndex.showLoading(!1)},3e3);vmViewIndex.allSetting.selectProduct(f);vmViewIndex.showMySetting(!0);u?showTab(!0):showTab(!1)},function(n){n==="cancel"&&(u?(i.valueArrProduct(products.cSmileContactless),showTab(!1)):(i.valueArrProduct(products.cSmileDining),showTab(!0)))}):(vmViewIndex.showLoading(!0),setTimeout(function(){updateData(s,l,a,v,y,p,w,b,k,d);vmViewIndex.allSetting.isSmileDining(u);resetTipsAuto();vmViewIndex.showLoading(!1)},3e3),vmViewIndex.allSetting.selectProduct(f),vmViewIndex.showMySetting(!0),u?showTab(!0):showTab(!1),$("#txt_ShopCloseStart").removeClass("dx-invalid"),$("#txt_ShopCloseEnd").removeClass("dx-invalid"))}}}))}function jsonParseObj(n,t){return JSON.parse(getObjFormAjax(n,t))}function updateData(n,t,i,r,u,f,e,o,s,h){DataGlobalConfigViewModel(n);AllTimeViewModel(t);DataSettingViewModel(n);DataHolidaySetUpViewModel(i);DataAutoChargeSetUpViewModel(r);DataDiscountViewModel(u,f);DataGraguityViewModel(n,e);DataPromotionSetUpViewModel(o);DataShopCloseSetUpViewModel(s);DataDiscountOneTimeUseViewModel(h,f)}function showTab(n){var t=vmViewIndex.allSetting.tabSettingIndexClick();n?$("#tabMapLabel").show():(t!=4&&t!=5&&t!=6&&$("#tabRestaurant").click(),$("#tabMapLabel").hide())}function checkMap(n,t){function a(n,t,i,r,u){n!=t&&i.push(r);for(var f=0;f<r.length;f++)r[f]!=u[f]&&i.push(r)}for(var e,o,y=this,v=!1,s=[],i=[],h=[],r="",u="",f="",l=vmViewIndex.allMapZone.mapZone(),c=0;c<2;c++)i=n.listMapZoneMile[c],h=t.listMapZoneMile()[c],(h.mapZoneId()!=i.mapZoneId||h.startMile()!=i.startMile||h.endMile()!=i.endMile||h.price()!=i.price)&&s.push(i);return r=n.settingDictionaryMapZone[1].trim(),u=n.settingDictionaryMapZonePrice[1],f=t.mapZone()[0].MapZonePrice(),e=generateZoneData(r),o=generateZoneData(l[0].MapZoneValue()),a(u,f,s,e,o),r=n.settingDictionaryMapZone[2].trim(),u=n.settingDictionaryMapZonePrice[2],f=t.mapZone()[1].MapZonePrice(),e=generateZoneData(r),o=generateZoneData(l[1].MapZoneValue()),a(u,f,s,e,o),r=n.settingDictionaryMapZone[3].trim(),u=n.settingDictionaryMapZonePrice[3],f=t.mapZone()[2].MapZonePrice(),e=generateZoneData(r),o=generateZoneData(l[2].MapZoneValue()),a(u,f,s,e,o),s.length!=0&&(v=!0),v}function generateZoneData(n){var i=n.split(" "),t=[];return ko.utils.arrayForEach(i,function(n){var r=n.split(" "),i=r[0].split(","),u=i[0],f=i[1];t.push(convertStringToNumber(u).toFixed(6));t.push(convertStringToNumber(f).toFixed(6))}),t}function GiftCardViewModel(n){var t=this,i=filterGlobalConfig(n,"currentDateTime"),r=moment(i).format("MM/DD/YYYY");t.giftCardShopDate=ko.observable(r);t.giftCardImageStorage=ko.observableArray([]);t.giftCardValueStorage=ko.observableArray([]);t.customDiscountStorage=ko.observableArray([]);t.giftCardValueSorting=ko.observableArray([]);t.addGiftCard=new AddGiftCard(t);t.showGuideLine=new ShowGuideLine(t);t.guideLine=ko.observable(!0);t.giftCardView=new GiftCardView;t.showPurchaseGiftCard=ko.observable(filterGlobalConfig(n,"smiledining-show-giftcard"));t.isShowPurchaseGiftCard=ko.observable(t.showPurchaseGiftCard()=="1"?!0:!1);t.btnActive=ko.observable({offText:"NO",onText:"YES",value:t.isShowPurchaseGiftCard,width:switchActiveWidth55px,onValueChanged:function(n){n.value==!0?t.isShowPurchaseGiftCard(!0):t.isShowPurchaseGiftCard(!1)}})}function GiftCardView(){var n=this;n.fromDate=ko.observable();n.endDate=ko.observable();n.dataGiftCardView=ko.observableArray([]);n.dataGridGiftCardView=ko.observable({onInitialized:function(n){dataGrid=n.component},dataSource:n.dataGiftCardView,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{caption:"#",width:60,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.rowIndex+1)}},{dataField:"fromEmail",caption:"From",alignment:"center",width:"200"},{dataField:"toEmail",caption:"To Email",alignment:"center",width:"200"},{dataField:"toPhone",caption:"To Phone",alignment:"center",width:"100"},{dataField:"deliveryDate",caption:"Delivery Date",alignment:"center",width:"110"},{dataField:"giftCode",caption:"Card Number",alignment:"center",width:"130"},{dataField:"payAmount",caption:"Pay",alignment:"center",format:"currency",precision:"2",width:"100"},{dataField:"getAmount",caption:"Value",alignment:"center",format:"currency",precision:"2",width:"100"},],onRowClick:function(n){var t=n.data},summary:{totalItems:[{column:"payAmount",summaryType:"sum",valueFormat:"currency",precision:"2"},{column:"getAmount",summaryType:"sum",valueFormat:"currency",precision:"2"}]}});n.dateFromDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.fromDate,width:150,invalidDateMessage:"Value must be a date",onValueChanged:function(t){t.value!=""&&t.value!=undefined?n.fromDate(moment(t.value).format("L")):n.fromDate(moment(new Date).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.dateEndDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.endDate,width:150,invalidDateMessage:"Value must be a date",onValueChanged:function(t){t.value!=""&&t.value!=undefined?n.endDate(moment(t.value).format("L")):n.endDate(moment(new Date).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}})}function ShowGuideLine(n){function r(){var i,n;t.getAmount()>0&&(t.enableSubmitGiftCardValue(!0),t.isDiscountAmount()?(t.discountAmount()<0&&t.discountAmount(0),n=t.getAmount()-t.discountAmount(),t.payAmount(n)):(t.discountPercent()<0&&t.discountPercent(0),i=t.getAmount()*t.discountPercent()/100,n=t.getAmount()-i,t.payAmount(n)))}function u(){t.enableSubmitCustomDiscount(!0);var n=_.orderBy(t.customDiscountData(),function(n){return n.min()}),i=_.filter(n,function(n){return _.inRange(parseFloat(t.min()),parseFloat(n.min()),parseFloat(n.max())+.01)}),r=_.filter(n,function(n){return _.inRange(parseFloat(t.max()),parseFloat(n.min()),parseFloat(n.max())+.01)}),e=_.findIndex(i,function(n){return n.giftCerCustomDiscountId()!=t.giftCerCustomDiscountId()}),o=_.findIndex(r,function(n){return n.giftCerCustomDiscountId()!=t.giftCerCustomDiscountId()});if(i.length>0&&e>=0)t.enableSubmitCustomDiscount(!1),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+i[e].discountName()+'" ',!1);else if(r.length>0&&o>=0)t.enableSubmitCustomDiscount(!1),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+r[o].discountName()+'" ',!1);else if(Number(t.min())<Number(t.max())){var u=_.filter(n,function(n){return _.inRange(n.min(),t.min(),t.max()+1)}),f=_.filter(n,function(n){return _.inRange(n.max(),t.min(),t.max()+1)}),s=_.findIndex(u,function(n){return n.giftCerCustomDiscountId()!=t.giftCerCustomDiscountId()}),h=_.findIndex(f,function(n){return n.giftCerCustomDiscountId()!=t.giftCerCustomDiscountId()});u.length>0&&s>=0?(t.enableSubmitCustomDiscount(!1),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+u[s].discountName()+'" ',!1)):f.length>0&&h>=0&&(t.enableSubmitCustomDiscount(!1),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+f[h].discountName()+'" ',!1))}}var n=n,t=this;t.giftCardImageData=ko.observableArray([]);t.giftCardValueData=ko.observableArray([]);t.customDiscountData=ko.observableArray([]);t.giftCardValueDataSorting=ko.observableArray([]);t.dataGridGiftCardValueData=ko.observableArray([]);t.activeTab=ko.observable("upload-image");t.isNormalDiscountGroup=ko.observable(!0);t.isCustomDiscountGroup=ko.observable(!1);t.giftCerActive=ko.observable(!0);t.giftCerValueId=ko.observable("");t.giftCerValueName=ko.observable("");t.getAmount=ko.observable(0).extend({numeric:2});t.blurGetAmount=function(n,i){var u=$(i.target).val();u=$.isNumeric(u)?rountTwo(u):0;u<0&&(u=0);u>1e4&&(u=1e4);t.getAmount(u);t.payAmount(u);r()};t.payAmount=ko.observable(0).extend({numeric:2});t.isDiscountAmount=ko.observable(!0);t.isDiscountPercent=ko.observable(!1);t.getAsPay=ko.observable(!1);t.activateOnly=ko.observable(!0);t.discountAmount=ko.observable(0).extend({numeric:2});t.blurDiscountAmount=function(n,i){var u=$(i.target).val();u=$.isNumeric(u)?rountTwo(u):0;u<0&&(u=0);u>1e4&&(u=1e4);t.discountAmount(u);u>t.getAmount()&&t.discountAmount(t.getAmount());r()};t.discountPercent=ko.observable(0).extend({numeric:2});t.blurDiscountPercent=function(n,i){var u=$(i.target).val();u=$.isNumeric(u)?rountTwo(u):0;u<0&&(u=0);u>100&&(u=0);t.discountPercent(u);r()};t.lastGetAmount=ko.observable(0).extend({numeric:2});t.sorting=ko.observable(0);t.lastSorting=ko.observable(0);t.discountActive=ko.observable(!0);t.refGiftCardValueId=ko.observable("");t.giftCerCustomDiscountId=ko.observable(null);t.discountValueName=ko.observable("Custom");t.discountName=ko.observable("");t.discountDesc=ko.observable("");t.min=ko.observable(0).extend({numeric:2});t.blurMin=function(n,i){var r=$(i.target).val();r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);r>1e4&&(r=1e4);t.min(r);u()};t.max=ko.observable(0).extend({numeric:2});t.blurMax=function(n,i){var r=$(i.target).val();r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);r>1e4&&(r=1e4);t.max(r);u()};t.isCustomDiscountAmount=ko.observable(!0);t.isCustomDiscountPercent=ko.observable(!1);t.amountOff=ko.observable(0).extend({numeric:2});t.blurAmountOff=function(n,i){var r=$(i.target).val();r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);r>1e4&&(r=1e4);t.amountOff(r);r>t.min()&&t.amountOff(0)};t.percentOff=ko.observable(0).extend({numeric:2});t.blurPercentOff=function(n,i){var r=$(i.target).val();r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);r>100&&(r=0);t.percentOff(r)};t.allDate=ko.observable(!0);t.startDate=ko.observable(moment(new Date).format("L"));t.endDate=ko.observable(moment(new Date).format("L"));t.allTime=ko.observable(!0);t.startTime=ko.observable(moment(time_start_24h,moment_time_format_hhmmss));t.endTime=ko.observable(moment(time_end_24h,moment_time_format_hhmmss));t.haveDiscountData=ko.observable(!1);t.enableSubmitGiftCardValue=ko.observable(!0);t.enableSubmitCustomDiscount=ko.observable(!0);t.jsonGiftCardImageData=ko.observable("");t.jsonGiftCardValueData=ko.observable("");t.jsonCustomDiscountData=ko.observable("");t.showGiftCardValueDetail=ko.observable(!1);t.showCustomDiscountDetail=ko.observable(!1);t.enableEditCustomDiscountDetail=ko.observable(!1);t.showDiscount=ko.observable(0);t.txtAdd=ko.observable("Add");t.calShowDiscount=function(){t.isDiscountAmount()?t.showDiscount("$"+t.discountAmount()):t.isDiscountPercent()?t.showDiscount(t.discountPercent()+"%"):t.showDiscount("0.00")};t.clickImageActive=function(n){n.active()&&!n.isDefault()?n.active(!1):n.active(!0)};t.clickImageDefault=function(n){if(n.active())if(n.isDefault())n.isDefault(!1);else{var i=_.findIndex(t.giftCardImageData(),function(n){return n.isDefault()==!0});i>=0&&t.giftCardImageData()[i].isDefault(!1);n.isDefault(!0)}};t.clickDiscountAmount=function(){return t.isDiscountAmount(!0),t.isDiscountPercent(!1),t.discountPercent(0),removeClassValidationError(cfrmTxtDiscountAmount),removeClassValidationError(cfrmTxtDiscountPercent),t.computePayAmount()};t.clickDiscountPercent=function(){return t.isDiscountPercent(!0),t.isDiscountAmount(!1),t.discountAmount(0),removeClassValidationError(cfrmTxtDiscountAmount),removeClassValidationError(cfrmTxtDiscountPercent),t.computePayAmount()};t.computePayAmount=function(){return r(),!0};t.setupGiftCardValue=new SetupGiftCardValue;t.btnActive=ko.observable({offText:"NO",onText:"YES",value:t.giftCerActive,width:switchActiveWidth55px,onValueChanged:function(n){n.value==!0?t.giftCerActive(!0):t.giftCerActive(!1)}});t.checkAddButton=function(){return t.txtAdd()=="Add"?!0:!1};t.clickNormalDiscountGroup=function(){return t.isNormalDiscountGroup(!0),t.isCustomDiscountGroup(!1),t.clearCustom(),$(cfrmPanelCustomDiscount).hide("slide",{direction:"up"},function(){$(cfrmPanelNormalDiscount).show("slide",{direction:"down"})}),!0};t.clickCustomDiscountGroup=function(){return t.isNormalDiscountGroup(!1),t.isCustomDiscountGroup(!0),t.clearValue(),$(cfrmPanelNormalDiscount).hide("slide",{direction:"up"},function(){$(cfrmPanelCustomDiscount).show("slide",{direction:"down"})}),!0};t.saveNormalDiscount=function(){var n,u,r,f,e,o,i;if(isEmpty(t.giftCerValueName()))return alerMessage(cError_GiftCerValueName_Empty,!1),!0;if(Number(t.getAmount()<=0))return alerMessage(cError_GiftCerGetAmount,!1),!0;if(t.isDiscountAmount()&&Number(t.discountAmount())>Number(t.getAmount()))return alerMessage(cError_GiftCerValueDiscountAmount_GreaterGetAmount,!1),!0;if(t.isDiscountPercent()&&Number(t.discountPercent())>100)return alerMessage(cError_GiftCerValueDiscountPercent_Greater100,!1),!0;if(!(t.isDiscountAmount()||t.isDiscountPercent()))return alerMessage(cError_GiftCerDiscountType,!1),!0;t.checkAddButton()?(t.lastSorting()>0?t.sorting(t.lastSorting()+1):t.sorting(1),t.lastSorting(t.sorting()),n=new DataGiftCardValueViewModel({giftCerValueId:Math.floor(Math.random()*1e4+1),giftCerValueName:t.giftCerValueName(),getAmount:t.getAmount(),payAmount:t.payAmount(),isDiscountAmount:t.isDiscountAmount(),isDiscountPercent:t.isDiscountPercent(),discountAmount:t.discountAmount(),discountPercent:t.discountPercent(),getAsPay:!1,activateOnly:!0,sorting:t.sorting(),active:t.giftCerActive()}),t.giftCardValueData.push(n),t.giftCardValueDataSorting.push({giftCerValueId:n.giftCerValueId(),sorting:n.sorting()}),u=new DataGridGiftCardValueViewModel(n),t.dataGridGiftCardValueData.push(u),i={msgType:"success",msgTitle:"Normal price has been added"},swalMessage(i,function(){t.clearValue()})):(r=new DataGiftCardValueViewModel({giftCerValueId:t.giftCerValueId(),giftCerValueName:t.giftCerValueName(),getAmount:t.getAmount(),payAmount:t.payAmount(),isDiscountAmount:t.isDiscountAmount(),isDiscountPercent:t.isDiscountPercent(),discountAmount:t.discountAmount(),discountPercent:t.discountPercent(),getAsPay:!1,activateOnly:!0,sorting:t.sorting(),active:t.giftCerActive()}),f=ko.utils.arrayFilter(t.giftCardValueData(),function(n){return n.giftCerValueId()==t.giftCerValueId()}),t.giftCardValueData.replace(_.first(f),r),e=new DataGridGiftCardValueViewModel(r),o=ko.utils.arrayFilter(t.dataGridGiftCardValueData(),function(n){return n.valueId()==t.giftCerValueId()}),t.dataGridGiftCardValueData.replace(_.first(o),e),i={msgType:"success",msgTitle:"Normal discount has been updated"},swalMessage(i,function(){t.clearValue()}))};t.deleteNormalDiscount=function(){var u=ko.utils.arrayFilter(t.giftCardValueDataSorting(),function(n){return n.giftCerValueId==t.giftCerValueId()}),n,i,r;t.giftCardValueDataSorting.removeAll(u);n=ko.utils.arrayFilter(t.giftCardValueData(),function(n){return n.giftCerValueId()==t.giftCerValueId()});t.giftCardValueData.removeAll(n);i=ko.utils.arrayFilter(t.dataGridGiftCardValueData(),function(n){return n.valueId()==t.giftCerValueId()});t.dataGridGiftCardValueData.removeAll(i);r={msgType:"success",msgTitle:"Normal price was delete"};swalMessage(r,function(){t.clearValue()})};t.cancelUpdateNormalDiscount=function(){t.clearValue()};t.saveCustomDiscount=function(){var i,f,e,s,r,o,n,u;if(isEmpty(t.discountName()))return alerMessage(cError_GiftCerCustomDiscountName,!1),!0;if(isNaN(t.min())||isNaN(t.max()))return alerMessage(cError_GiftCerCustomDiscountMinMax_Empty,!1),!0;if(t.min()<=0||t.max()<=0)return alerMessage(cError_GiftCerCustomDiscountMinMax_NotZero,!1),!0;if(Number(t.min())>=Number(t.max()))return alerMessage(cError_GiftCerCustomDiscountMin_LessMax,!1),!0;if(t.isCustomDiscountAmount()||t.isCustomDiscountPercent()){if(t.isCustomDiscountAmount()&&isNaN(t.amountOff()))return alerMessage(cError_GiftCerCustomDiscountAmount_Empty,!1),!0;if(t.isCustomDiscountPercent()&&isNaN(t.percentOff()))return alerMessage(cError_GiftCerCustomDiscountPercent_Empty,!1),!0;if(t.isCustomDiscountPercent()&&Number(t.percentOff())>100)return alerMessage(cError_GiftCerCustomDiscountPercent_Greater100,!1),!0;if(!t.allDate()&&(isEmpty(t.startDate())||isEmpty(t.endDate())))return alerMessage(cError_GiftCerCustomDiscountDay_Empty,!1),!0;if(!t.allTime()&&(isEmpty(t.startTime())||isEmpty(t.endTime())))return alerMessage(cError_GiftCerCustomDiscountTime_Empty,!1),!0}else return alerMessage(cError_GiftCerCustomDiscountType,!1),!0;t.haveDiscountData()||(t.refGiftCardValueId(Math.floor(Math.random()*1e4+1)),t.lastSorting()>0?t.sorting(t.lastSorting()+1):t.sorting(1),t.lastSorting(t.sorting()),i=new DataGiftCardValueViewModel({giftCerValueId:t.refGiftCardValueId(),giftCerValueName:t.discountValueName(),getAmount:0,payAmount:0,isDiscountAmount:!1,isDiscountPercent:!1,discountAmount:0,discountPercent:0,getAsPay:!0,activateOnly:!0,sorting:t.sorting(),active:t.discountActive()}),t.giftCardValueData.push(i),t.giftCardValueDataSorting.push({giftCerValueId:i.giftCerValueId(),sorting:i.sorting()}));t.checkAddButton()?(f=new DataCustomDiscountViewModel({refGiftCardValueId:t.refGiftCardValueId(),giftCerCustomDiscountId:Math.floor(Math.random()*1e4+1),discountValueName:t.discountValueName(),discountName:t.discountName(),discountDesc:t.discountDesc(),min:t.min(),max:t.max(),allDate:t.allDate(),startDate:t.startDate(),endDate:t.endDate(),allTime:t.allTime(),startTime:t.startTime(),endTime:t.endTime(),isCustomDiscountAmount:t.isCustomDiscountAmount(),isCustomDiscountPercent:t.isCustomDiscountPercent(),amountOff:t.amountOff(),percentOff:t.percentOff(),active:t.discountActive()}),t.customDiscountData.push(f),DataCustomDiscountToGiftCardValue(t,ko.toJS(f)),t.haveDiscountData(!0),r={msgType:"success",msgTitle:"Custom price has been added"},swalMessage(r,function(){t.clearCustom()})):(e=new DataCustomDiscountViewModel({refGiftCardValueId:t.refGiftCardValueId(),giftCerCustomDiscountId:t.giftCerCustomDiscountId(),discountValueName:t.discountValueName(),discountName:t.discountName(),discountDesc:t.discountDesc(),min:t.min(),max:t.max(),allDate:t.allDate(),startDate:t.startDate(),endDate:t.endDate(),allTime:t.allTime(),startTime:t.startTime(),endTime:t.endTime(),isCustomDiscountAmount:t.isCustomDiscountAmount(),isCustomDiscountPercent:t.isCustomDiscountPercent(),amountOff:t.amountOff(),percentOff:t.percentOff(),active:t.discountActive()}),s=ko.utils.arrayFilter(t.customDiscountData(),function(n){return n.giftCerCustomDiscountId()==t.giftCerCustomDiscountId()}),t.customDiscountData.replace(_.first(s),e),DataUpdateCustomDiscountToGiftCardValue(t,ko.toJS(e)),r={msgType:"success",msgTitle:"Custom discount has been update"},swalMessage(r,function(){t.clearCustom()}));o=ko.utils.arrayFilter(t.customDiscountData(),function(n){return n.active()==!0});n=ko.utils.arrayFilter(t.giftCardValueData(),function(n){return n.giftCerValueId()==t.refGiftCardValueId()});o.length==0?(u=new DataGiftCardValueViewModel({giftCerValueId:t.refGiftCardValueId(),giftCerValueName:t.discountValueName(),getAmount:0,payAmount:0,isDiscountAmount:!1,isDiscountPercent:!1,discountAmount:0,discountPercent:0,getAsPay:!0,activateOnly:!0,sorting:_.first(n).sorting(),active:!1}),t.giftCardValueData.replace(_.first(n),u)):o.length==1&&(u=new DataGiftCardValueViewModel({giftCerValueId:t.refGiftCardValueId(),giftCerValueName:t.discountValueName(),getAmount:0,payAmount:0,isDiscountAmount:!1,isDiscountPercent:!1,discountAmount:0,discountPercent:0,getAsPay:!0,activateOnly:!0,sorting:_.first(n).sorting(),active:!0}),t.giftCardValueData.replace(_.first(n),u))};t.deleteCustomDiscount=function(){var u=ko.utils.arrayFilter(t.customDiscountData(),function(n){return n.giftCerCustomDiscountId()==t.giftCerCustomDiscountId()}),n,i,r;t.customDiscountData.removeAll(u);n=ko.utils.arrayFilter(t.dataGridGiftCardValueData(),function(n){return n.valueId()==t.giftCerCustomDiscountId()});t.dataGridGiftCardValueData.removeAll(n);t.customDiscountData().length<=0&&(i=ko.utils.arrayFilter(t.giftCardValueData(),function(n){return n.giftCerValueId()==t.refGiftCardValueId()}),t.giftCardValueData.removeAll(i),t.refGiftCardValueId(""),t.haveDiscountData(!1));r={msgType:"success",msgTitle:"Custom price was deleted"};swalMessage(r,function(){t.clearCustom()})};t.btnCustomDiscountActive=ko.observable({offText:"NO",onText:"YES",value:t.discountActive,width:switchActiveWidth55px,onValueChanged:function(n){n.value==!0?t.discountActive(!0):t.discountActive(!1)}});t.clickCustomDiscountAmount=function(){return t.isCustomDiscountAmount(!0),t.isCustomDiscountPercent(!1),t.percentOff(0),removeClassValidationError(cfrmTxtCustomDiscountAmount),removeClassValidationError(cfrmTxtCustomDiscountPercent),!0};t.clickCustomDiscountPercent=function(){return t.isCustomDiscountPercent(!0),t.isCustomDiscountAmount(!1),t.amountOff(0),removeClassValidationError(cfrmTxtCustomDiscountAmount),removeClassValidationError(cfrmTxtCustomDiscountPercent),!0};t.checkCustomDiscountValue=function(){return t.isCustomDiscountAmount()?Number(t.amountOff())<0&&t.amountOff(0):Number(t.percentOff())<0&&t.percentOff(0),!0};t.dxCustomDiscountStartDate=ko.observable({acceptCustomValue:!1,width:"auto",pickerType:"calendar",type:"date",min:t.currentDate,value:t.startDate,disabled:t.allDate,onValueChanged:function(n){(n.value===""||n.value===null||n.value===undefined)&&n.component.option("isValid",!1);t.startDate(moment(new Date(n.value)).format("MM/DD/YYYY"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});t.dxCustomDiscountEndDate=ko.observable({acceptCustomValue:!1,width:"auto",min:t.startDate,pickerType:"calendar",type:"date",value:t.endDate,disabled:t.allDate,onValueChanged:function(n){(n.value===""||n.value===null||n.value===undefined)&&n.component.option("isValid",!1);t.endDate(moment(new Date(n.value)).format("MM/DD/YYYY"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});t.dxCustomDiscountStartTime=ko.observable({max:t.endTime,pickerType:"list",type:"time",value:t.startTime,disabled:t.allTime,onValueChanged:function(n){n.value===""||n.value===null||n.value===undefined?n.component.option("isValid",!1):t.startTime(moment(n.value,moment_time_format_hhmmss))},onChange:function(n){n.component._options.validationError!=null}});t.dxCustomDiscountEndTime=ko.observable({min:t.startTime,pickerType:"list",type:"time",value:t.endTime,disabled:t.allTime,onValueChanged:function(n){n.value===""||n.value===null||n.value===undefined?n.component.option("isValid",!1):t.endTime(moment(n.value,moment_time_format_hhmmss))},onChange:function(n){n.component._options.validationError!=null}});t.clearValue=function(){t.giftCerValueName("");t.getAmount(0);t.payAmount(0);t.isDiscountPercent(!1);t.discountAmount(0);t.discountPercent(0);t.giftCerActive(!0);t.lastGetAmount(0);t.enableSubmitGiftCardValue(!0);t.txtAdd("Add")};t.clearCustom=function(){t.discountName("");t.discountDesc("");t.min("0.00");t.max("0.00");t.allDate(!0);t.startDate(moment(new Date).format("L"));t.endDate(moment(new Date).format("L"));t.allTime(!0);t.startTime(moment(time_start_24h,moment_time_format_hhmmss));t.endTime(moment(time_end_24h,moment_time_format_hhmmss));t.isCustomDiscountAmount(!0);t.isCustomDiscountPercent(!1);t.amountOff("0.00");t.percentOff("0");t.discountActive(!0);t.enableSubmitCustomDiscount(!0);t.txtAdd("Add")};t.clickSubmitGiftCard=function(){swalConfirmSubmitGifCard(cfrmGiftCard,cMessage_SubmitGiftCard)};t.prepareGiftCardData=function(){var f=ko.toJS(t.giftCardImageData()),e=ko.toJSON(f),n,i,r,u;t.jsonGiftCardImageData(e);_.forEach(t.giftCardValueDataSorting(),function(n){var i=_.find(t.giftCardValueData(),function(t){return t.giftCerValueId()==n.giftCerValueId});i.sorting(n.sorting)});n=ko.toJS(t.giftCardValueData());i=ko.toJSON(n);t.jsonGiftCardValueData(i);t.customDiscountData().forEach(function(n){var t=moment(n.startTime()).format(moment_time_format_HHmmss),i=moment(n.endTime()).format(moment_time_format_HHmmss);n.startTime(t);n.endTime(i)});r=ko.toJS(t.customDiscountData());u=ko.toJSON(r);t.jsonCustomDiscountData(u)};t.dataGridGiftCardValue=ko.observable({dataSource:t.dataGridGiftCardValueData,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){dataGrid=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.rowIndex+1)}},{dataField:"valueName",caption:"Name",width:"100",alignment:"left"},{dataField:"getAmount",caption:"Get",alignment:"center",width:"100"},{dataField:"payAmount",caption:"Pay",alignment:"center",width:"100"},{dataField:"discountAmount",caption:"$",alignment:"center",width:"100"},{dataField:"discountPercent",caption:"%",alignment:"center",width:"100"},{dataField:"getAsPay",caption:"Custom",alignment:"center",width:"80"},{dataField:"active",caption:"Active"}],onCellPrepared:function(n){var t=n.value,i="";isEmpty(t)||(i=t==!0&&typeof t=="boolean"?"<span><i class='fa fa-check text-success'><\/i><\/span>":t==!1&&typeof t=="boolean"?"<span><i class='fa fa-close text-danger'><\/i><\/span>":n.columnIndex==4&&t!="0.00"?"$"+t:n.columnIndex==5&&t!="0"?t+"%":t.value,n.cellElement.html(i))},onRowClick:function(n){var u,f,r,i;t.activeTab()=="giftcard-value"&&(u=n.data,f=ko.mapping.toJSON(u),ko.mapping.fromJSON(f,{},t.setupGiftCardValue),t.setupGiftCardValue.getAsPay()?(r=ko.utils.arrayFilter(t.customDiscountData(),function(n){return n.giftCerCustomDiscountId()==t.setupGiftCardValue.valueId()}),r.length>0&&(i=_.first(r),t.discountActive(i.active()),t.refGiftCardValueId(i.refGiftCardValueId()),t.giftCerCustomDiscountId(i.giftCerCustomDiscountId()),t.discountValueName(i.discountValueName()),t.discountName(i.discountName()),t.discountDesc(i.discountDesc()),t.min(i.min()),t.max(i.max()),t.isCustomDiscountAmount(i.isCustomDiscountAmount()),t.isCustomDiscountPercent(i.isCustomDiscountPercent()),t.amountOff(i.amountOff()),t.percentOff(i.percentOff()),t.allDate(i.allDate()),t.startDate(i.startDate()),t.endDate(i.endDate()),t.allTime(i.allTime()),t.startTime(i.startTime()),t.endTime(i.endTime()),t.clickCustomDiscountGroup(),t.txtAdd("Update"),$(cModalShowGuideLineGiftCardValue).modal("hide"))):(t.giftCerValueId(t.setupGiftCardValue.valueId()),t.giftCerValueName(t.setupGiftCardValue.valueName()),t.getAmount(t.setupGiftCardValue.getAmount()),t.payAmount(t.setupGiftCardValue.payAmount()),t.discountAmount(t.setupGiftCardValue.discountAmount()),t.discountPercent(t.setupGiftCardValue.discountPercent()),t.getAsPay(t.setupGiftCardValue.getAsPay()),t.activateOnly(t.setupGiftCardValue.activateOnly()),t.isDiscountAmount(t.setupGiftCardValue.isDiscountAmount()),t.isDiscountPercent(t.setupGiftCardValue.isDiscountPercent()),t.sorting(t.setupGiftCardValue.sorting()),t.giftCerActive(t.setupGiftCardValue.active()),t.lastGetAmount(t.setupGiftCardValue.getAmount()),t.clickNormalDiscountGroup(),t.txtAdd("Update"),$(cModalShowGuideLineGiftCardValue).modal("hide")))},onToolbarPreparing:function(){},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$(cGuideLineGiftCardValue+" .dx-scrollable").dxScrollable({showScrollbar:"always"})}});t.clickStepUploadImage=function(){switch(t.activeTab()){case"image-descripttion":t.clickBackGifCard();break;case"giftcard-value":t.activeTab("image-descripttion");$(cfrmTabCreateGiftCardValue).removeClass("active");$(cfrmStep3GiftCard).removeClass("active");$(cfrmTabCreateCustomDiscount).removeClass("active");t.clickBackGifCard();break;case"complete-step":t.activeTab("image-descripttion");$(cfrmTabCompleteGiftCard).removeClass("active");$(cfrmStep4GiftCard).removeClass("active");t.clickBackGifCard()}};t.clickStepConfigImage=function(){switch(t.activeTab()){case"upload-image":t.clickNextGiftCard();break;case"giftcard-value":t.clickBackGifCard();break;case"complete-step":t.activeTab("giftcard-value");$(cfrmTabCompleteGiftCard).removeClass("active");$(cfrmStep4GiftCard).removeClass("active");t.clickBackGifCard()}};t.clickStepGiftCardValue=function(){t.clearValue();t.clearCustom();switch(t.activeTab()){case"upload-image":t.activeTab("image-descripttion");$(cfrmTabUploadGiftCardImage).removeClass("active");$(cfrmStep1GiftCard).removeClass("active");t.clickNextGiftCard();break;case"image-descripttion":t.clickNextGiftCard();break;case"complete-step":t.clickBackGifCard()}};t.clickStepComplete=function(){clearCardSelected();switch(t.activeTab()){case"upload-image":t.activeTab("giftcard-value");$(cfrmTabUploadGiftCardImage).removeClass("active");$(cfrmStep1GiftCard).removeClass("active");t.clickNextGiftCard();break;case"image-descripttion":t.activeTab("giftcard-value");$(cfrmTabImageDescription).removeClass("active");$(cfrmStep2GiftCard).removeClass("active");t.clickNextGiftCard();break;case"giftcard-value":t.clickNextGiftCard()}};t.clickNextGiftCard=function(){var o,n,r,u,f;switch(t.activeTab()){case"upload-image":if(t.giftCardImageData([]),$(".imageuploadify-container").length>0)for(i=0;i<$(".imageuploadify-container").length;i++){var h=$(".imageuploadify-container").eq(i),c=h.find("img").attr("src"),e=!1;i==0&&(e=!0);o=new DataGiftCardImageViewModel({giftCerImagesId:"giftcardimage"+i,active:!0,isDefault:e,giftCerImagesName:c,sorting:i});t.giftCardImageData.push(o)}t.activeTab("image-descripttion");$(cfrmTabUploadGiftCardImage).removeClass("active");$(cfrmTabImageDescription).addClass("active");$(cfrmStep1GiftCard).removeClass("active");$(cfrmStep2GiftCard).addClass("active");break;case"image-descripttion":for(n=[],i=0;i<$(cfrmTabImageDescription+" .card-giftcard").length;i++){var l=$(cfrmTabImageDescription+" .card-giftcard"),a=l.eq(i).find("img").attr("id"),s=_.findIndex(t.giftCardImageData(),function(n){return n.giftCerImagesId()==a});t.giftCardImageData()[s].sorting(i);n[i]=t.giftCardImageData()[s]}r=!1;_.forEach(n,function(n){n.active()==!0&&(r=!0)});r?(t.giftCardImageData(n),t.activeTab("giftcard-value"),$(cfrmTabImageDescription).removeClass("active"),$(cfrmTabCreateGiftCardValue).addClass("active"),$(cfrmStep2GiftCard).removeClass("active"),$(cfrmStep3GiftCard).addClass("active")):swal("Oops...",cError_GiftCerImage_IsActive,cSwal_Icon_Error);break;case"giftcard-value":selectNextActivity(function(n){n=="addGiftCardValue"?(t.giftCerValueName(""),t.getAmount(0),t.payAmount(0),t.isDiscountAmount(!1),t.isDiscountPercent(!1),t.discountAmount(0),t.discountPercent(0),t.clickNormalDiscountGroup()):n=="addCustomDiscount"?(t.discountName(""),t.discountDesc(""),t.min("0.00"),t.max("0.00"),t.allDate(!0),t.startDate(moment(new Date).format("L")),t.endDate(moment(new Date).format("L")),t.allTime(!0),t.startTime(moment(time_start_24h,moment_time_format_hhmmss)),t.endTime(moment(time_end_24h,moment_time_format_hhmmss)),t.isCustomDiscountAmount(!1),t.isCustomDiscountPercent(!1),t.amountOff("0.00"),t.percentOff("0"),t.discountActive(!0),t.clickCustomDiscountGroup()):(t.activeTab("complete-step"),$(cfrmTabCreateGiftCardValue).removeClass("active"),$(cfrmTabCompleteGiftCard).addClass("active"),$(cfrmStep3GiftCard).removeClass("active"),$(cfrmStep4GiftCard).addClass("active"),clearCardSelected())});u=t.giftCardValueData().length;f=t.customDiscountData().length;f>0&&(u-=1);u>0&&f>0&&(t.activeTab("complete-step"),$(cfrmTabCreateGiftCardValue).removeClass("active"),$(cfrmTabCompleteGiftCard).addClass("active"),$(cfrmStep3GiftCard).removeClass("active"),$(cfrmStep4GiftCard).addClass("active"),clearCardSelected())}};t.clickBackGifCard=function(){switch(t.activeTab()){case"complete-step":t.activeTab("giftcard-value");$(cfrmTabCreateGiftCardValue).addClass("active");$(cfrmTabCompleteGiftCard).removeClass("active");$(cfrmStep3GiftCard).addClass("active");$(cfrmStep4GiftCard).removeClass("active");break;case"giftcard-value":t.activeTab("image-descripttion");$(cfrmTabCreateGiftCardValue).removeClass("active");$(cfrmTabImageDescription).addClass("active");$(cfrmStep3GiftCard).removeClass("active");$(cfrmStep2GiftCard).addClass("active");$(cfrmTabCreateCustomDiscount).removeClass("active");break;case"image-descripttion":t.activeTab("upload-image");$(cfrmTabImageDescription).removeClass("active");$(cfrmTabUploadGiftCardImage).addClass("active");$(cfrmStep2GiftCard).removeClass("active");$(cfrmStep1GiftCard).addClass("active")}};t.checkRangCustomDiscount=function(){u()};t.checkEmptyData=function(){return t.giftCardImageData().length>0||t.giftCardValueData().length>0||t.customDiscountData().length>0?!0:!1}}function AddGiftCard(n){function r(){var i,n;t.getAmount()>0&&(t.enableSubmitGiftCardValue(!0),t.isDiscountAmount()?(t.discountAmount()<0&&t.discountAmount(0),n=t.getAmount()-t.discountAmount(),n<0?t.payAmount(0):t.payAmount(n)):(t.discountPercent()<0&&t.discountPercent(0),i=t.getAmount()*t.discountPercent()/100,n=t.getAmount()-i,n<0?t.payAmount(0):t.payAmount(n)))}function u(){t.enableSubmitCustomDiscount(!0);var i=_.orderBy(n.customDiscountStorage(),function(n){return n.min()}),r=_.filter(i,function(n){return _.inRange(parseFloat(t.min()),parseFloat(n.min()),parseFloat(n.max())+.01)}),u=_.filter(i,function(n){return _.inRange(parseFloat(t.max()),parseFloat(n.min()),parseFloat(n.max())+.01)}),o=_.findIndex(r,function(n){return n.giftCerCustomDiscountId()!=t.giftCerCustomDiscountId()}),s=_.findIndex(u,function(n){return n.giftCerCustomDiscountId()!=t.giftCerCustomDiscountId()});if(r.length>0&&o>=0)t.enableSubmitCustomDiscount(!1),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+r[o].discountName()+'" ',!1);else if(u.length>0&&s>=0)t.enableSubmitCustomDiscount(!1),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+u[s].discountName()+'" ',!1);else if(Number(t.min())<Number(t.max())){var f=_.filter(i,function(n){return _.inRange(n.min(),t.min(),t.max()+1)}),e=_.filter(i,function(n){return _.inRange(n.max(),t.min(),t.max()+1)}),h=_.findIndex(f,function(n){return n.giftCerCustomDiscountId()!=t.giftCerCustomDiscountId()}),c=_.findIndex(e,function(n){return n.giftCerCustomDiscountId()!=t.giftCerCustomDiscountId()});f.length>0&&h>=0?(t.enableSubmitCustomDiscount(!1),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+f[h].discountName()+'" ',!1)):e.length>0&&c>=0&&(t.enableSubmitCustomDiscount(!1),alerMessage(cError_GiftCerCustomDiscount_InRange+' "'+e[c].discountName()+'" ',!1))}}var n=n,t=this;t.activeTab=ko.observable("upload-image");t.giftCardImageData=ko.observableArray([]);t.giftCardValueData=ko.observableArray([]);t.editGiftCardImageData=ko.observableArray([]);t.customDiscountData=ko.observableArray([]);t.jsonGiftCardImageData=ko.observable("");t.jsonSortingGiftCardData=ko.observable("");t.discountValueName=ko.observable("Custom");t.giftCerValueId=ko.observable(null);t.active=ko.observable(!0);t.giftCerValueName=ko.observable("");t.getAmount=ko.observable(0).extend({numeric:2});t.blurGetAmount=function(n,i){var u=$(i.target).val();u=$.isNumeric(u)?rountTwo(u):0;u<0&&(u=0);u>1e4&&(u=1e4);t.getAmount(u);t.payAmount(u);r()};t.payAmount=ko.observable(0).extend({numeric:2});t.isDiscountAmount=ko.observable(!0);t.isDiscountPercent=ko.observable(!1);t.discountAmount=ko.observable(0).extend({numeric:2});t.blurDiscountAmount=function(n,i){var u=$(i.target).val();u=$.isNumeric(u)?rountTwo(u):0;u<0&&(u=0);u>1e4&&(u=1e4);t.discountAmount(u);u>t.getAmount()&&t.discountAmount(t.getAmount());r()};t.discountPercent=ko.observable(0).extend({numeric:2});t.blurDiscountPercent=function(n,i){var u=$(i.target).val();u=$.isNumeric(u)?rountTwo(u):0;u<0&&(u=0);u>100&&(u=0);t.discountPercent(u);r()};t.getAsPay=ko.observable(!1);t.activateOnly=ko.observable(!0);t.lastGetAmount=ko.observable(0).extend({numeric:2});t.refGiftCardValueId=ko.observable("");t.active=ko.observable(!0);t.giftCerCustomDiscountId=ko.observable(null);t.discountName=ko.observable("");t.discountDesc=ko.observable("");t.min=ko.observable(0).extend({numeric:2});t.blurMin=function(n,i){var r=$(i.target).val();r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);r>1e4&&(r=1e4);t.min(r);u()};t.max=ko.observable(0).extend({numeric:2});t.blurMax=function(n,i){var r=$(i.target).val();r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);r>1e4&&(r=1e4);t.max(r);u()};t.isCustomDiscountAmount=ko.observable(!0);t.isCustomDiscountPercent=ko.observable(!1);t.amountOff=ko.observable(0).extend({numeric:2});t.blurAmountOff=function(n,i){var r=$(i.target).val();r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);r>1e4&&(r=1e4);t.amountOff(r);r>t.min()&&t.amountOff(0)};t.percentOff=ko.observable(0).extend({numeric:2});t.blurPercentOff=function(n,i){var r=$(i.target).val();r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);r>100&&(r=0);t.percentOff(r)};t.allDate=ko.observable(!0);t.startDate=ko.observable(moment(new Date).format("L"));t.endDate=ko.observable(moment(new Date).format("L"));t.allTime=ko.observable(!0);t.startTime=ko.observable(moment(time_start_24h,moment_time_format_hhmmss));t.endTime=ko.observable(moment(time_end_24h,moment_time_format_hhmmss));t.startTimeString=ko.observable(moment(time_start_24h).format(moment_time_format_HHmmss));t.endTimeString=ko.observable(moment(time_end_24h).format(moment_time_format_HHmmss));t.haveDiscountData=ko.observable(!1);t.editGiftCardImageId=ko.observable("");t.editGiftCardImageName=ko.observable("");t.editGiftCardImageSrc=ko.observable("");t.editGiftCardImageOrder=ko.observable(0);t.deleteGiftCardImageId=ko.observable("");t.lockEdit=ko.observable(!1);t.chkGiftCardValueSearch=ko.observable(!1);t.chkCustomDiscountSearch=ko.observable(!1);t.enableSubmitGiftCardValue=ko.observable(!0);t.enableSubmitCustomDiscount=ko.observable(!0);t.showGiftCardValueDetail=ko.observable(!1);t.showCustomDiscountDetail=ko.observable(!1);t.enableEditCustomDiscountDetail=ko.observable(!1);t.showDiscount=ko.observable(0);t.slickMove=ko.observable(!1);t.showAddorEdit=function(n){return n==null||n==""?"Add":"Edit"};t.calShowDiscount=function(){t.isDiscountAmount()?t.showDiscount("$"+t.discountAmount()):t.isDiscountPercent()?t.showDiscount(t.discountPercent()+"%"):t.showDiscount("0.00")};t.btnActive=ko.observable({offText:"NO",onText:"YES",value:t.active,width:switchActiveWidth55px,onValueChanged:function(n){n.value==!0?t.active(!0):t.active(!1)}});t.clickNextAddGiftCardImage=function(){var n;switch(t.activeTab()){case"upload-image":if(t.giftCardImageData([]),$(".imageuploadify-container").length>0){for(i=0;i<$(".imageuploadify-container").length;i++){var u=$(".imageuploadify-container").eq(i),f=u.find("img").attr("src"),e=new DataGiftCardImageViewModel({giftCerImagesId:"giftcardimage"+i,active:!0,isDefault:!1,giftCerImagesName:f,sorting:i});t.giftCardImageData.push(e)}t.activeTab("image-descripttion");$(cfrmTabNewGiftCardImage).removeClass("active");$(cfrmTabNewImageDescription).addClass("active");$(cfrmStep1GiftCardImage).removeClass("active");$(cfrmStep2GiftCardImage).addClass("active")}else swal(cSwal_Alert_Error,cError_GiftCerImage_Empty,cSwal_Icon_Error);break;case"image-descripttion":for(n=[],i=0;i<$(cfrmTabNewImageDescription+" .card-giftcard").length;i++){var o=$(cfrmTabNewImageDescription+" .card-giftcard"),s=o.eq(i).find("img").attr("id"),r=_.findIndex(t.giftCardImageData(),function(n){return n.giftCerImagesId()==s});t.giftCardImageData()[r].sorting(i);n[i]=t.giftCardImageData()[r]}t.giftCardImageData(n);t.activeTab("complete-step");$(cfrmTabNewImageDescription).removeClass("active");$(cfrmTabCompleteNewGiftCard).addClass("active");$(cfrmStep2GiftCardImage).removeClass("active");$(cfrmStep3GiftCardImage).addClass("active")}};t.clickBackAddGiftCardImage=function(){switch(t.activeTab()){case"complete-step":t.activeTab("image-descripttion");$(cfrmTabCompleteNewGiftCard).removeClass("active");$(cfrmTabNewImageDescription).addClass("active");$(cfrmStep3GiftCardImage).removeClass("active");$(cfrmStep2GiftCardImage).addClass("active");break;case"image-descripttion":t.activeTab("upload-image");$(cfrmTabNewImageDescription).removeClass("active");$(cfrmTabNewGiftCardImage).addClass("active");$(cfrmStep2GiftCardImage).removeClass("active");$(cfrmStep1GiftCardImage).addClass("active")}};t.clickImageActive=function(n){t.lockEdit(!0);n.active()&&!n.isDefault()?n.active(!1):n.active(!0)};t.clickImageDefault=function(i){if(i.active())if(t.lockEdit(!0),i.isDefault())i.isDefault(!1);else{var r=_.findIndex(n.giftCardImageStorage(),function(n){return n.isDefault()==!0});r>=0&&n.giftCardImageStorage()[r].isDefault(!1);i.isDefault(!0)}};t.clickSubmitGiftCardImage=function(){var n=ko.toJS(t.giftCardImageData()),i=ko.toJSON(n);t.jsonGiftCardImageData(i);swalConfirmSubmitGifCard(cfrmNewGiftCardImage,cMessage_SubmitGiftCardImage)};t.isEmptyImageData=function(){return t.giftCardImageData().length>0?!1:!0};t.computePayAmount=function(){return r(),!0};t.clickDiscountAmount=function(){return t.isDiscountAmount(!0),t.isDiscountPercent(!1),t.discountPercent(0),removeClassValidationError(cfrmTxtDiscountAmount),removeClassValidationError(cfrmTxtDiscountPercent),t.computePayAmount()};t.clickDiscountPercent=function(){return t.isDiscountPercent(!0),t.isDiscountAmount(!1),t.discountAmount(0),removeClassValidationError(cfrmTxtDiscountAmount),removeClassValidationError(cfrmTxtDiscountPercent),t.computePayAmount()};t.btnCustomDiscountActive=ko.observable({offText:"NO",onText:"YES",value:t.active,width:switchActiveWidth55px,onValueChanged:function(n){n.value==!0?t.active(!0):t.active(!1)}});t.clickCustomDiscountAmount=function(){return t.isCustomDiscountAmount(!0),t.isCustomDiscountPercent(!1),t.percentOff(0),removeClassValidationError(cfrmTxtCustomDiscountAmount),removeClassValidationError(cfrmTxtCustomDiscountPercent),!0};t.clickCustomDiscountPercent=function(){return t.isCustomDiscountPercent(!0),t.isCustomDiscountAmount(!1),t.amountOff(0),removeClassValidationError(cfrmTxtCustomDiscountAmount),removeClassValidationError(cfrmTxtCustomDiscountPercent),!0};t.computeMinEndDate=ko.pureComputed(function(){return t.startDate()==null||isEmpty(t.startDate())?n.giftCardShopDate():moment(t.startDate()).isAfter(n.giftCardShopDate())?t.startDate():n.giftCardShopDate()});t.dxCustomDiscountStartDate=ko.observable({acceptCustomValue:!1,width:"auto",pickerType:"calendar",type:"date",min:n.giftCardShopDate,value:t.startDate,disabled:t.allDate,onValueChanged:function(n){(n.value===""||n.value===null||n.value===undefined)&&n.component.option("isValid",!1);t.startDate(moment(new Date(n.value)).format("MM/DD/YYYY"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});t.dxCustomDiscountEndDate=ko.observable({acceptCustomValue:!1,width:"auto",min:t.computeMinEndDate,pickerType:"calendar",type:"date",value:t.endDate,disabled:t.allDate,onValueChanged:function(n){(n.value===""||n.value===null||n.value===undefined)&&n.component.option("isValid",!1);t.endDate(moment(new Date(n.value)).format("MM/DD/YYYY"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});t.dxCustomDiscountStartTime=ko.observable({max:t.endTime,pickerType:"list",type:"time",value:t.startTime,disabled:t.allTime,onValueChanged:function(n){n.value===""||n.value===null||n.value===undefined?(n.component.option("isValid",!1),t.startTimeString("")):(t.startTime(moment(n.value,moment_time_format_hhmmss)),t.startTimeString(moment(n.value).format(moment_time_format_HHmmss)))},onChange:function(n){n.component._options.validationError!=null}});t.dxCustomDiscountEndTime=ko.observable({min:t.startTime,pickerType:"list",type:"time",value:t.endTime,disabled:t.allTime,onValueChanged:function(n){n.value===""||n.value===null||n.value===undefined?(n.component.option("isValid",!1),t.endTimeString("")):(t.endTime(moment(n.value,moment_time_format_hhmmss)),t.endTimeString(moment(n.value).format(moment_time_format_HHmmss)))},onChange:function(n){n.component._options.validationError!=null}});t.clearGiftCardValue=function(){var n=this;n.giftCerValueId(null);n.active(!0);n.giftCerValueName("");n.getAmount(0);n.payAmount(0);n.isDiscountAmount(!0);n.isDiscountPercent(!1);n.discountAmount(0);n.discountPercent(0);n.getAsPay(!1);n.activateOnly(!0);n.lastGetAmount(0);n.enableSubmitGiftCardValue(!0)};t.clearCustomDiscount=function(){var n=this;n.active(!0);n.giftCerCustomDiscountId(null);n.discountName("");n.discountDesc("");n.min(0);n.max(0);n.isCustomDiscountAmount(!0);n.isCustomDiscountPercent(!1);n.amountOff(0);n.percentOff(0);n.allDate(!0);n.startDate(moment(new Date).format("L"));n.endDate(moment(new Date).format("L"));n.allTime(!0);n.startTime(moment(time_start_24h,moment_time_format_hhmmss));n.endTime(moment(time_end_24h,moment_time_format_hhmmss));n.startTimeString(moment(n.startTime()).format(moment_time_format_HHmmss));n.endTimeString(moment(n.endTime()).format(moment_time_format_HHmmss));n.enableSubmitCustomDiscount(!0)};t.setupCustomDiscount=new SetupCustomDiscountValue;t.clickSubmitAllGiftCardImage=function(){var i=ko.toJS(n.giftCardImageStorage()),r=!1,u,f;_.forEach(i,function(n){n.active==!0&&(r=!0)});r?(u=ko.toJSON(i),t.jsonGiftCardImageData(u),f="#"+cfrmEditAllGiftCardImage,$(f).submit()):swal("Oops...",cError_GiftCerImage_IsActive,cSwal_Icon_Error)};t.clickSubmitEditSortingGiftCardValue=function(){var i,r,u;t.slickMove(!1);i=ko.toJS(n.giftCardValueSorting());r=ko.toJSON(i);t.jsonSortingGiftCardData(r);u="#"+cfrmEditSortingGiftCardValue;$(u).submit()};t.clickAddGiftCardValue=function(){$(cfrmGiftCardSlick).find("div .card-selected").removeClass("card-selected");t.showGiftCardValueDetail(!1);t.showCustomDiscountDetail(!1);t.clearGiftCardValue();$(cModalShowAddNewGiftCardValue).modal({keyboard:!1,backdrop:"static",show:!0})};t.clickEditGiftCardValue=function(){$(cModalShowAddNewGiftCardValue).modal({keyboard:!1,backdrop:"static",show:!0})};t.selectCustomDiscount=function(n,i){var f;$(cfrmRowDetailCustomDiscount).find(".panel-selected").removeClass("panel-selected");$(i.currentTarget).addClass("panel-selected");t.enableEditCustomDiscountDetail(!0);f=ko.mapping.toJSON(n);ko.mapping.fromJSON(f,{},t.setupCustomDiscount);var e=moment(time_start_24h,moment_time_format_hhmmss),o=moment(time_end_24h,moment_time_format_hhmmss),r=t.setupCustomDiscount.startTime(),u=t.setupCustomDiscount.endTime();r===""||r===null||r===undefined||(e=moment(r,moment_time_format_hhmmss));u===""||u===null||u===undefined||(o=moment(u,moment_time_format_hhmmss));t.active(t.setupCustomDiscount.active());t.giftCerCustomDiscountId(t.setupCustomDiscount.giftCerCustomDiscountId());t.discountName(t.setupCustomDiscount.discountName());t.discountDesc(t.setupCustomDiscount.discountDesc());t.min(t.setupCustomDiscount.min());t.max(t.setupCustomDiscount.max());t.isCustomDiscountAmount(t.setupCustomDiscount.isCustomDiscountAmount());t.isCustomDiscountPercent(t.setupCustomDiscount.isCustomDiscountPercent());t.amountOff(t.setupCustomDiscount.amountOff());t.percentOff(t.setupCustomDiscount.percentOff());t.allDate(t.setupCustomDiscount.allDate());t.startDate(t.setupCustomDiscount.startDate());t.endDate(t.setupCustomDiscount.endDate());t.allTime(t.setupCustomDiscount.allTime());t.startTime(e);t.endTime(o)};t.clickAddCustomDiscount=function(){$(cfrmGiftCardSlick).find("div .card-selected").removeClass("card-selected");t.showGiftCardValueDetail(!1);t.showCustomDiscountDetail(!1);$(cfrmRowDetailCustomDiscount).find(".panel-selected").removeClass("panel-selected");t.clearCustomDiscount();t.enableEditCustomDiscountDetail(!1);$(cModalShowAddNewCustomDiscount).modal({keyboard:!1,backdrop:"static",show:!0})};t.clickEditCustomDiscount=function(){$(cModalShowAddNewCustomDiscount).modal({keyboard:!1,backdrop:"static",show:!0})};t.clickDeleteGiftCardImage=function(n){t.deleteGiftCardImageId(n.giftCerImagesId());swalConfirmSubmitGifCard(cfrmDeleteGiftCardImage,cMessage_DeleteImage)};t.checkRangCustomDiscount=function(){u()}}function SetupGiftCardValue(){self.giftCerValueId=ko.observable("");self.active=ko.observable(!0);self.giftCerValueName=ko.observable("");self.getAmount=ko.observable(0).extend({numeric:2});self.payAmount=ko.observable(0).extend({numeric:2});self.discountAmount=ko.observable(0).extend({numeric:2});self.discountPercent=ko.observable(0).extend({numeric:0});self.isDiscountAmount=ko.observable(!0);self.isDiscountPercent=ko.observable(!1);self.getAsPay=ko.observable(!1);self.sorting=ko.observable(0);self.activateOnly=ko.observable(!0)}function SetupCustomDiscountValue(){self.active=ko.observable(!0);self.giftCerCustomDiscountId=ko.observable(null);self.discountName=ko.observable("");self.discountDesc=ko.observable("");self.min=ko.observable(0).extend({numeric:2});self.max=ko.observable(1).extend({numeric:2});self.isCustomDiscountAmount=ko.observable(!0);self.isCustomDiscountPercent=ko.observable(!1);self.amountOff=ko.observable(0).extend({numeric:2});self.percentOff=ko.observable(0).extend({numeric:2});self.allDate=ko.observable(!0);self.startDate=ko.observable(moment(new Date).format("L"));self.endDate=ko.observable(moment(new Date).format("L"));self.allTime=ko.observable(!0);self.startTime=ko.observable(moment(time_start_24h,moment_time_format_hhmmss));self.endTime=ko.observable(moment(time_end_24h,moment_time_format_hhmmss))}function checkShopUpdate(n,t){var r=moment(filterGlobalConfig(n,gcShopCloseStartDate)).format(moment_date_format_mmddyyyy),u=moment(filterGlobalConfig(n,gcShopCloseEndDate)).format(moment_date_format_mmddyyyy),i=ko.observableArray([{currentdata:filterGlobalConfig(n,gcShopName),newdata:t.shopName()==null?"":t.shopName().trim()},{currentdata:filterGlobalConfig(n,gcShopCode),newdata:t.shopCode()==null?"":t.shopCode().trim()},{currentdata:filterGlobalConfig(n,gcShopStreet),newdata:t.shopStreet()==null?"":t.shopStreet().trim()},{currentdata:filterGlobalConfig(n,gcShopPostal),newdata:t.shopZipCode()==null?"":t.shopZipCode().trim()},{currentdata:filterGlobalConfig(n,gcAnnounceHeader),newdata:t.shopHeader()==null?"":t.shopHeader().trim()},{currentdata:filterGlobalConfig(n,gcAnnounceBadge),newdata:t.shopBadge()},{currentdata:filterGlobalConfig(n,gcAnnounceActive),newdata:t.shopActive()},{currentdata:filterGlobalConfig(n,gcAnnounceImage),newdata:t.shopAnnounceImage()},{currentdata:filterGlobalConfig(n,"broad-custom-image"),newdata:t.shopAnnounceCustomImage()},{currentdata:filterGlobalConfig(n,"broad-custom-active"),newdata:t.shopAnnounceCustomActive()},{currentdata:filterGlobalConfig(n,gcOrderLimit),newdata:t.orderLimit()==null?"":t.orderLimit().trim()},{currentdata:filterGlobalConfig(n,gcTimePickupStart),newdata:t.timeStartPickup()},{currentdata:filterGlobalConfig(n,gcTimePickupEnd),newdata:t.timeEndPickup()},{currentdata:filterGlobalConfig(n,gcTimeDeliveryStart),newdata:t.timeStartDelivery()},{currentdata:filterGlobalConfig(n,gcTimeDeliveryEnd),newdata:t.timeEndDelivery()},{currentdata:filterGlobalConfig(n,gcShopMapLat),newdata:t.shopLatitude()},{currentdata:filterGlobalConfig(n,gcShopMapLng),newdata:t.shopLongitude()},{currentdata:filterGlobalConfig(n,gcShopMapCode),newdata:t.shopMapCode()},{currentdata:filterGlobalConfig(n,gcShopDeliveryTax),newdata:t.shopDeliveryTax()},{currentdata:filterGlobalConfig(n,gcPayByCash),newdata:t.payByCash()},{currentdata:filterGlobalConfig(n,gcPayByCredit),newdata:t.payByCredit()},{currentdata:filterGlobalConfig(n,gcShopPeriodTime),newdata:t.shopPeriodTime()},{currentdata:filterGlobalConfig(n,gcShopLogo),newdata:t.shopLogo()},{currentdata:filterGlobalConfig(n,"shop-background"),newdata:t.shopBackground()},{currentdata:filterGlobalConfig(n,gcCalTax),newdata:t.calTax()},{currentdata:filterGlobalConfig(n,gcShippingType),newdata:t.shippingType()},{currentdata:filterGlobalConfig(n,gcTipsDesc),newdata:t.tipsDesc()==null?"":t.tipsDesc().trim()},{currentdata:filterGlobalConfig(n,"tip-auto"),newdata:t.tipsAuto()==null?"":t.tipsAuto().trim()},{currentdata:filterGlobalConfig(n,gcThemeColor),newdata:t.themeColor()},{currentdata:filterGlobalConfig(n,gcTipsDescForStore),newdata:t.tipsDescForStore()==null?"":t.tipsDescForStore().trim()},{currentdata:filterGlobalConfig(n,gcTipsDescForCredit),newdata:t.tipsDescForCredit()==null?"":t.tipsDescForCredit().trim()},{currentdata:filterGlobalConfig(n,gcCustomButtonPayAtStore),newdata:t.customButtonPayAtStore()==null?"":t.customButtonPayAtStore().trim()},{currentdata:filterGlobalConfig(n,gcCustomButtonCredit),newdata:t.customButtonCredit()==null?"":t.customButtonCredit().trim()},{currentdata:filterGlobalConfig(n,gcCustomSpecialInstructions),newdata:t.customSpecialInstructions()==null?"":t.customSpecialInstructions().trim()},{currentdata:filterGlobalConfig(n,gcOrderLimit),newdata:t.orderLimit()==null?"":t.orderLimit().trim()},{currentdata:parseFloat(filterGlobalConfig(n,gcCalminumumOrder)),newdata:t.minimumOrder()},{currentdata:getPhoneFormatUs(filterGlobalConfig(n,gcShopPhone)),newdata:t.shopPhone()},{currentdata:filterGlobalConfig(n,gcSpecialInstructions),newdata:t.specialInstructions()}]);return checkDataUpdate(i)}function checkDataUpdate(n){var t=!1;return ko.utils.arrayForEach(n(),function(n){if(n.currentdata!=n.newdata)return t=!0}),t}var cropper=null,image=document.getElementById("image_crop_box");$("#modalSetUpFoodUploadImage").on("hidden.bs.modal",function(){vmViewIndex.menu.checkDataMenu()!="undefined"&&($("body").addClass("modal-open").css({"padding-right":"17px"}),vmViewIndex.menu.dataSetupFoodModal.image()==""&&vmViewIndex.menu.dataSetupFoodModal.tempId(""));$(".display-uploader").val("");vmViewIndex.menu.cropActive(!1);cropper!=null&&(cropper.destroy(),cropper=null)});$("#cropImage").click(function(){if(addSpinButton("modalSetUpFoodUploadImage"),vmViewIndex.disableButtonCloseModal(!0),vmViewIndex.disablePointer("default"),vmViewIndex.menu.cropActive()==!0)canvas=cropper.getCroppedCanvas({width:800,height:800}),canvas.toBlob(function(n){url=URL.createObjectURL(n);var t=new FileReader;t.readAsDataURL(n);t.onloadend=function(){const n=t.result;convertBase64toFile(n)}});else if(vmViewIndex.menu.checkDataMenu()!="undefined"){var n=$("#image_crop_box").attr("src");$("img",vmViewIndex.menu.elementImageId()).attr("src",n);$("img",vmViewIndex.menu.elementImageId()).attr("width","115");$("img",vmViewIndex.menu.elementImageId()).attr("height","115");vmViewIndex.menu.dataSetupFoodModal.image(n);$("#modalSetUpFoodUploadImage").modal("hide");removeSpinButton("modalSetUpFoodUploadImage");vmViewIndex.disableButtonCloseModal(!1);vmViewIndex.disablePointer("pointer")}else vmViewIndex.menu.typeUploadImage()=="dropImage"?vmViewIndex.menu.uploadDropImage(vmViewIndex.menu.tempImageId()):vmViewIndex.menu.typeUploadImage()=="clickImage"&&vmViewIndex.menu.submitChangeImage(vmViewIndex.menu.elementChangeImage(),vmViewIndex.menu.tempImageId(),!1)});