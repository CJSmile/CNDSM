function initGiftCardImageDragging(n){$(n).sortable({cursor:"move",forcePlaceholderSize:!1,opacity:.4,placeholder:"highlight",start:function(n,t){t.item.toggleClass("highlight")},stop:function(n,t){t.item.toggleClass("highlight")}});$(n).disableSelection()}function initGiftCardImageDragDrop(n){var t;$(n).sortable({cursor:"move",forcePlaceholderSize:!1,opacity:.4,start:function(n,i){i.item.toggleClass("highlight");t=i.item.index()},update:function(){},change:function(n,t){t.placeholder.toggleClass("slick-placeholder")},stop:function(n,r){var u,f;if(r.item.toggleClass("highlight"),u=r.item.index(),vmViewIndex.giftCard.addGiftCard.lockEdit(!0),t<u){for(f=vmViewIndex.giftCard.giftCardImageStorage()[t],i=t;i<u;i++)vmViewIndex.giftCard.giftCardImageStorage()[i]=vmViewIndex.giftCard.giftCardImageStorage()[i+1],vmViewIndex.giftCard.giftCardImageStorage()[i].sorting(i+1);vmViewIndex.giftCard.giftCardImageStorage()[u]=f;vmViewIndex.giftCard.giftCardImageStorage()[u].sorting(u+1)}else if(t>u){for(f=vmViewIndex.giftCard.giftCardImageStorage()[t],i=t;i>u;i--)vmViewIndex.giftCard.giftCardImageStorage()[i]=vmViewIndex.giftCard.giftCardImageStorage()[i-1],vmViewIndex.giftCard.giftCardImageStorage()[i].sorting(i+1);vmViewIndex.giftCard.giftCardImageStorage()[u]=f;vmViewIndex.giftCard.giftCardImageStorage()[u].sorting(u+1)}}});$(n).disableSelection()}function selectNextActivity(n){var t=vmViewIndex.giftCard.showGuideLine.giftCardValueData().length,i=vmViewIndex.giftCard.showGuideLine.customDiscountData().length;return i>0&&(t-=1),t==0?swal({title:cMessage_GiftCardValue_Empty,type:"question",showConfirmButton:!1,showCancelButton:!1,html:'<div class="row"><div class="col-12"><div class="form-group"><button id="btnAddGiftCardValue" class="btn btn-primary btn-swal-activity">Add new giftcard value<\/button><\/div><\/div><\/div><div class="row"><div class="col-12"><div class="form-group"><button id="btnNextProcess" class="btn theme default-button btn-swal-activity">Next Process<\/button><\/div><\/div><\/div>',onOpen:function(){$("#btnAddGiftCardValue").click(function(){typeof n=="function"&&n.call(this,"addGiftCardValue");swal.close()});$("#btnAddCustomDiscount").click(function(){typeof n=="function"&&n.call(this,"addCustomDiscount");swal.close()});$("#btnNextProcess").click(function(){typeof n=="function"&&n.call(this,"nextProcess");swal.close()})}}).then(function(){},function(){}):i==0&&swal({title:"Your custom price is empty?",type:"question",showConfirmButton:!1,showCancelButton:!1,html:'<div class="row"><div class="col-12"><div class="form-group"><button id="btnAddCustomDiscount" class="btn btn-primary btn-swal-activity">Add custom price<\/button><\/div><\/div><\/div><div class="row"><div class="col-12"><div class="form-group"><button id="btnNextProcess" class="btn theme default-button btn-swal-activity">Next Process<\/button><\/div><\/div><\/div>',onOpen:function(){$("#btnAddGiftCardValue").click(function(){typeof n=="function"&&n.call(this,"addGiftCardValue");swal.close()});$("#btnAddCustomDiscount").click(function(){typeof n=="function"&&n.call(this,"addCustomDiscount");swal.close()});$("#btnNextProcess").click(function(){typeof n=="function"&&n.call(this,"nextProcess");swal.close()})}}).then(function(){},function(){}),!0}function swalMessage(n,t){swal({type:n.msgType,title:n.msgTitle,showConfirmButton:!0}).then(function(){typeof t=="function"&&t.call(this)},function(){})}function alerMessage(n,t){var i=new ObjAlert("",n,t);i.getAlert()}function swalConfirmSubmitGifCard(n,t){swal({title:t,type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirm!",cancelButtonText:"Cancel",confirmButtonClass:"btn btn-primary",cancelButtonClass:"btn btn-danger",buttonsStyling:!0,showLoaderOnConfirm:!0,allowEscapeKey:!1,preConfirm:function(){n=="frmGiftCard"&&vmViewIndex.giftCard.showGuideLine.prepareGiftCardData();var t=new ObjUrl(n),i=t.getUrlSubmitForm(),r=$(getIdTag(n)).serialize();return new Promise(function(){$.ajax({url:i,async:ajax_async,cache:ajax_cache,type:ajax_type_post,data:r,timeout:ajax_timeout}).done(function(t){t.status?(afterSubmitGiftCard(n,t),completeConfirm(n,t)):n=="frmDeleteGiftCardImage"?swal("Oops...",cError_DeleteImage_ForeignKey,cSwal_Icon_Error):swal("Oops...",cError_Fail_TimeOut,cSwal_Icon_Error)}).fail(function(){swal("Oops...",cError_Fail_TimeOut,cSwal_Icon_Error);redirectMain()})})},allowOutsideClick:!1})}function completeConfirm(n,t){setInvisible(getClassTag("open-navigation"));$(window).scrollTop(0);swal("Confirm Success!",t.message,cSwal_Icon_Success).then(function(){n=="frmGiftCard"&&location.reload()},function(){})}function afterSubmitGiftCard(n,t){switch(n){case cfrmNewGiftCardImage:$(cModalAddGiftCardImage).modal("hide");clearNewGiftCardImage();SetNewGiftCardImageAdd(JSON.parse(t.obj));break;case cfrmDeleteGiftCardImage:SetDeleteGiftCardImage(t.obj)}}function clearNewGiftCardImage(){$(cfrmTabNewGiftCardImage).find(".imageuploadify-container").remove();vmViewIndex.giftCard.addGiftCard.activeTab("upload-image");$(cfrmStep1GiftCardImage).addClass("active");$(cfrmTabNewGiftCardImage).addClass("active");$(cfrmStep2GiftCardImage).removeClass("active");$(cfrmTabNewImageDescription).removeClass("active");$(cfrmStep3GiftCardImage).removeClass("active");$(cfrmTabCompleteNewGiftCard).removeClass("active")}function onClickGiftCardForDetail(n,t){$(cfrmGiftCardSlick).find("div .card-selected").removeClass("card-selected");$(t.currentTarget).addClass("card-selected");var i=vmViewIndex.giftCard.addGiftCard;i.giftCerValueId(n.giftCerValueId);i.giftCerValueName(n.giftCerValueName);i.getAmount(n.getAmount);i.payAmount(n.payAmount);i.discountAmount(n.discountAmount);i.discountPercent(n.discountPercent);i.getAsPay(n.getAsPay);i.activateOnly(n.activateOnly);n.isDiscountAmount==!1&&n.isDiscountPercent==!1?i.isDiscountAmount(!0):i.isDiscountAmount(n.isDiscountAmount);i.isDiscountPercent(n.isDiscountPercent);i.active(n.active);i.lastGetAmount(n.getAmount);i.calShowDiscount();n.getAsPay?($(cfrmRowDetailCustomDiscount).find(".panel-selected").removeClass("panel-selected"),i.clearCustomDiscount(),i.showGiftCardValueDetail(!1),i.showCustomDiscountDetail(!0)):(i.showGiftCardValueDetail(!0),i.showCustomDiscountDetail(!1))}function onClickGiftCardGuideLineForDetail(n,t){$(cfrmGiftCardGuidelineSlick).find("div .card-selected").removeClass("card-selected");$(t.currentTarget).addClass("card-selected");var i=vmViewIndex.giftCard.showGuideLine;i.giftCerValueId(n.giftCerValueId);i.giftCerValueName(n.giftCerValueName);i.getAmount(n.getAmount);i.payAmount(n.payAmount);i.discountAmount(n.discountAmount);i.discountPercent(n.discountPercent);i.getAsPay(n.getAsPay);i.activateOnly(n.activateOnly);i.isDiscountAmount(n.isDiscountAmount);i.isDiscountPercent(n.isDiscountPercent);i.giftCerActive(n.active);i.lastGetAmount(n.getAmount);i.calShowDiscount();n.getAsPay?($(cfrmRowGuidelineDetailCustomDiscount).find(".panel-selected").removeClass("panel-selected"),i.clearCustom(),i.showGiftCardValueDetail(!1),i.showCustomDiscountDetail(!0)):(i.showGiftCardValueDetail(!0),i.showCustomDiscountDetail(!1))}function clearCardSelected(){var n=vmViewIndex.giftCard.showGuideLine;$(cfrmGiftCardGuidelineSlick).find("div .card-selected").removeClass("card-selected");n.showGiftCardValueDetail(!1);n.showCustomDiscountDetail(!1)}$(cfrmTabGiftCardImage).on("click",function(){$(cfrmDivGiftCardImage).show();$(cfrmDivGiftCardValue).hide()});$(cfrmTabGiftCardValue).on("click",function(){$(cfrmDivGiftCardImage).hide();$(cfrmDivGiftCardValue).show()});$(cfrmUploadGiftCardImage).imageuploadify();$(cfrmUploadNewGiftCardImage).imageuploadify();